import{e,t,l as a,A as n,U as r,B as o,T as i,h as s,ab as u,v as l,i as c,o as f,ac as d,ad as h,ae as m,af as p,ag as b,a4 as g,G as v,ah as y,ai as w,aj as k,ak as C,D as L,al as D,am as M,an as V,ao as A,ap as B,P as S,f as H,aq as N,ar as G,as as x,at as T,au as E,C as P,n as F,av as R,a9 as O,aw as I,x as _,ax as j,aa as q,ay as Y,az as K,Q as z,w as U,R as Q,V as W,a as J,J as X,K as Z,aA as ee,aB as te,aC as ae,aD as ne,aE as re,aF as oe,aG as ie,a0 as se,aH as ue,aI as le,aJ as ce,aK as fe,aL as de,aM as he,aN as me,aO as pe,aP as be,aQ as ge,aR as ve,aS as ye,aT as we,aU as ke,aV as Ce,aW as Le,aX as De,aY as Me,aZ as Ve,j as Ae}from"./calfSystem-cb871cc0.js"
import{i as $e}from"./isArray-2b606546.js"
import{n as Be}from"./numberIsNaN-3061f097.js"
import{r as Se,a as He}from"./roundToString-957a8024.js"
import{c as Ne}from"./createInput-91fe6fc0.js"
import{i as Ge}from"./insertTextBeforeEnd-f41f334f.js"
import"./testRange-9d580c3f.js"
import{t as xe}from"./testQuant-f4c2b309.js"
import{c as Te}from"./createLabel-d3b06769.js"
import"./createUl-7522713d.js"
import"./isChecked-0ef3785c.js"
import{b as Ee}from"./simpleCheckbox-8c37c36e.js"
import{c as Pe}from"./createTable-5db037a2.js"
import{c as Fe}from"./createButton-6f584fe4.js"
import{c as Re}from"./createStyle-1b01b972.js"
import{a as Oe}from"./all-56fa180f.js"
import{a as Ie}from"./allthen-fa22d516.js"
import"./rnd-590875bb.js"
import{f as _e}from"./fetchdata-e2536429.js"
import{e as je}from"./eventHandler5-23eb9a24.js"
import{h as qe}from"./hasClasses-dd01a13f.js"
import"./isSelected-1eae6699.js"
import{g as Ye}from"./getMembrList-5844bf69.js"
import{d as Ke,g as ze}from"./getGroupStats-760a1864.js"
import"./groupViewStats-b5a72545.js"
import{g as Ue}from"./getMercStats-7a3573c9.js"
import{b as Qe}from"./bitwiseAnd-4f606774.js"
import{r as We}from"./reduceBuffArray-60b520c4.js"
import{g as Je,a as Xe}from"./getTitanString-cc718765.js"
import{d as Ze,q as et}from"./quickbuffSuccess-10801e64.js"
import{a as tt}from"./huntingBuffs-e3408a38.js"
let at,nt,rt,ot,it,st,ut,lt,ct
function ft(e){return e}function dt(o){if(function(t){return e.showBuffInfo&&t.some(ft)}(o))return function(){if(at)t(at,!1)
else{at=a({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const e=n("actionContainer")
r(at,e.children[2])}return at}()
at&&t(at,!0)}function ht(e,a){nt?t(nt,!1):function(e){nt=e.children[3],nt.className="fshBlue",o("CA ",nt),rt=i(),s(nt,rt),Ge(nt," active")}(e),o(a.level,rt)}function mt(e,a){a?ht(e,a):nt&&t(nt,!0)}function pt(e,a){ot?t(ot,!1):function(e){ot=e.children[4],ot.className="fshRed",o("Doubler ",ot),it=i(),s(ot,it),Ge(ot," active")}(e),o(a.level,it)}function bt(e,a){a?pt(e,a):ot&&t(ot,!0)}function gt(e,a,n){st?t(st,!1):function(e){st=e.children[2],o("Damage bonus: ",st),ut=i(),s(st,ut),Ge(st,"%")}(e),o(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return Se(a,2).toString()}return"0"}(a,Number(n)),ut)}function vt(e,a,n){a?gt(e,a,n):st&&t(st,!0)}function yt(e,t){o(u(e),t)}function wt(e,a){lt?t(lt,!1):function(e){lt=e.children[1],o("Kill Streak: ",lt),ct=i(),s(lt,ct)}(e),yt(a,ct)}function kt(e,a,n,r){a||n?wt(e,r):lt&&t(lt,!0)}function Ct(e,t){return t.name===e}function Lt(e){const{buffs:t}=GameData.player()
if(t)return t.find(l(Ct,e))}const Dt=["red","orange","yellow"]
let Mt,Vt
function At(e){et(e)&&GameData.fetch(h)}function $t(){Lt("Summon Shield Imp")||Ze([d()],[55]).then(At)}const Bt=["imp-0","imp-1","imp-1"]
function St(e,a){Mt?t(Mt,!1):function(e){Mt=e.children[0],o("Shield Imps Remaining: ",Mt),Vt=i(),s(Mt,Vt),c(Mt,"&nbsp;")
const t=i({className:"xSmallLink",textContent:"Recast"})
s(Mt,t),f(t,$t)}(e)
const n=function(e){return e?Number(e.stack):0}(a)
Mt.className=function(e){return Bt[e]||"fshGreen"}(n),o(n,Vt)}function Ht(e,a,n){a||n?St(e,a):Mt&&t(Mt,!0)}function Nt(e){return 0===e.type}function Gt(e){return i({textContent:e})}let xt,Tt,Et,Pt,Ft,Rt,Ot,It,_t,jt
function qt(e,a){xt?t(xt,!1):function(e,t){xt=e.children[5],o("Teleport Cooldown: ",xt),Tt=Gt(t.toString()),s(xt,Tt)}(e,a)}function Yt(){const e=Math.max(Math.ceil((Et-Date.now())/1e3),0)
o(e,Tt),e>0&&setTimeout(Yt,500)}function Kt(e,a){a?qt(e,a):xt&&t(xt,!0)}function zt(){Pt=Lt("Death Dealer"),Ft=Lt("Doubler"),Rt=Lt("Counter Attack"),Ot=Lt("Summon Shield Imp"),It=function(){const e=GameData.player().teleportCooldown
return e>1&&e}(),_t=function(){const{dynamic:e}=GameData.realm()
return $e(e)&&e.some(Nt)}(),jt=GameData.player().killStreak}function Ut(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",Dt[e.text()]||"#ad8043")}(),zt()
const e=dt([Pt,Ft,Rt,Ot,It,_t])
e&&(Ht(e,Ot,Pt),kt(e,Pt,_t,jt),vt(e,Pt,jt),mt(e,Rt),bt(e,Ft),Kt(e,It))}function Qt(e,t){var a
a=t.player.teleportCooldown,Tt&&(Et=Date.now()+1e3*a,Yt())}function Wt(){Ut(),$.subscribe(`${m} ${p}`,Ut),$.subscribe(b,Qt)}const Jt=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let Xt,Zt=[]
function ea(e){54!==e.id&&26!==e.id||(Xt.player.buffs[e.id]=parseInt(e.level,10))}function ta(e){-1===Jt.indexOf(e.name)&&(Xt.player.enhancements[e.name]=e.value)}function aa(e,t){Xt={},Xt.combat=t.response.data,Xt.combat.inventory_id&&(Xt.combat.drop=Xt.combat.item.id),Xt.player={},Xt.player.buffs={},Xt.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(ea)}(t),function(e){e.player.enhancements&&e.player.enhancements.forEach(ta)}(t),Xt.time=t.time,Zt.push(Xt),k("fsh_combatLog",Zt)}function na(e,t){0===t.response.response&&aa(0,t)}function ra(e){e&&(Zt=e),$.subscribe(w,na)}function oa(){v("keepLogs")&&y("fsh_combatLog").then(ra)}function ia(t){return e.doNotKillList.includes(t.trim())}function sa(e){e.classList.toggle("fshBlue",ia(L(e)))}function ua(){const e=n("actionList")
C("creature",e).forEach(sa)}function la(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(ia(e))return n("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const ca={2:function(e){return function(t,a,n,r){la(n.passback)||e(t,a,n,r)}}}
function fa(e){return function(t,a,n,r){const o=ca[t];(function(e){return e&&D(e)})(o)&&function(e){return M(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function da(){$.subscribe(V,ua),ua(),function(){const e=GameData.doAction
GameData.doAction=fa(e)}()}function ha(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function ma(e,t,a){return Te({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${e}`,dataset:{tipped:t},htmlFor:a})}function pa(e){const t=a({className:"fshToggle"}),n=Ne({checked:e.prefVal,id:e.checkId,type:"checkbox"})
s(t,n)
const r=ma(e.onClass,e.onTip,e.checkId)
s(t,r)
const o=ma(e.offClass,e.offTip,e.checkId)
return s(t,o),s(e.worldName,t),n}let ba,ga,va,ya,wa,ka,Ca,La,Da
function Ma(e){return e?e.toString():"?"}function Va(e){const t=a({className:"fshFsty"})
s(t,function(){const e=a({textContent:"Min Lvl: "})
return ga=Gt(Ma(GameData.realm().minlevel)),s(e,ga),e}()),s(t,function(){const e=a({textContent:"Your Lvl: "})
return va=Gt(Ma(GameData.player().level)),s(e,va),e}()),s(e,t)}function Aa(e,t,a){const n=Fe({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${e}`,dataset:{tipped:t}})
return s(a,n),n}function $a(){var t
Va(t=ba),ya=Aa("fshFormGroup","Quick Create Attack Group",t),wa=Aa("fshQuickBuff","Open Quick Buff Popup",t),ka=Aa("fshRealmMap","Open Realm Map",t),Ca=Aa("fshTempleOne","Search map in Ultimate FSG",t),function(e){if(v("showSpeakerOnWorld")){const t=v("playNewMessageSound")
La=pa({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(ba),function(t){const a=e.huntingMode
Da=pa({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:t})}(ba)}const Ba=[[e=>e===La,function(){g("playNewMessageSound",!v("playNewMessageSound"))}],[e=>e===Da,function(){e.huntingMode=!e.huntingMode,g("huntingMode",e.huntingMode)}]],Sa=[[e=>e===ya,function(e){N(e),GameData.doAction(12,401,{},0)}],[e=>e===wa,function(){G(d())}],[e=>e===ka,function(){window.open(`${x+T}map`,"fsMap")}],[e=>e===Ca,function(){const e=GameData.realm()
window.open(`${E}realms${T}view&realm_id=${e.id}`,"mapUfsg")}]]
function Ha(){ba||(ba=a({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),$a(),f(ba,je(Sa)),H(ba,"change",je(Ba)),S(ba,n("worldCoord")))}function Na(e,t){ga&&t.b.minlevel&&(ha(),o(t.b.minlevel,ga))}function Ga(e,t){va&&o(t.b,va)}function xa(){Ha(),$.subscribe(A,Na),$.subscribe(B,Ga)}function Ta(e){return!e||!e.response||!e.response.data}let Ea,Pa,Fa,Ra,Oa,Ia,_a,ja,qa,Ya,Ka,za,Ua,Qa,Wa,Ja,Xa,Za,en,tn,an,nn,rn,on,sn,un,ln,cn,fn,dn,hn,mn,pn,bn,gn
function vn(e){return e.player_name}function yn(e){!function(e){Ra=e.defenders.map(vn)}(e),Ea?P("",Ea):Ea=a({className:"body"}),function(e){Pa=a({className:"fshFloatLeft fshRelicLeftDiv"}),s(Ea,Pa),e.is_owner&&s(Pa,Ke(Ra)),Fa=Fe({className:"custombutton",textContent:"Fetch Stats"}),s(Pa,Fa)}(e)
const t=n("dialog-relic")
s(t,Ea)}const wn=[e=>"lastUpdate"!==e,e=>!Ra.includes(e),e=>Oa[e].last_login,e=>Number(Oa[e].last_login)<Ia,e=>Number(Oa[e].last_login)>_a,e=>Oa[e].level<400||Oa[e].level>421,e=>Oa[e].level<441||Oa[e].level>450]
function kn(e,t){return t(e)}function Cn(e){return wn.every(l(kn,e))}function Ln(e){return`<a href="${O}${Oa[e].id}">${e}</a>`}function Dn(e){Oa=e,Ia=I-120,_a=I-604800
const t=R(Oa).filter(Cn).map(Ln)
c(Ea,'<div class="fshFloatLeft fshRelicLowDiv">'+`<table class="relicT"><thead><tr><th>${t.length.toString()}`+" Offline guild members not at relic:</th></tr></thead>"+`<tbody><tr><td>${t.join(" ")}</td></tr></tbody>`+"</table></div>")}function Mn(e){F(Fa)
const t=v("hideRelicOffline")
e.is_owner&&!t&&Ye(!0).then(Dn),c(Pa,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),gn=n("ProcessingStatus")
const r=a({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
s(Ea,r),ja=n("relicCount"),qa=n("LDPercentage"),Ya=n("LDCloaked"),Ka=n("attackValue"),za=n("attackValueBuffed"),Ua=n("defenseValue"),Qa=n("defenseValueBuffed"),Wa=n("armorValue"),Ja=n("armorValueBuffed"),Xa=n("damageValue"),Za=n("damageValueBuffed"),en=n("hpValue"),tn=n("hpValueBuffed"),an=n("defendersCloaked"),nn=n("defendersProcessed")
const o=a({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
s(Ea,o),rn=n("DC225"),on=n("DC175"),sn=n("GroupAttack"),un=n("GroupAttackBuffed"),ln=n("GroupDefense"),cn=n("GroupDefenseBuffed"),fn=n("GroupArmor"),dn=n("GroupArmorBuffed"),hn=n("GroupDamage"),mn=n("GroupDamageBuffed"),pn=n("GroupHP"),bn=n("GroupHPBuffed")}let Vn
function An(e){const t=_(e),a=j('#pCC img[src*="/relics/"]',t).length
var n
o(a,ja),Vn=1===(n=a)?1.5:Se(1-n/10,2),o(`${String(100*Vn)}%`,qa)}function $n(e,t){return e>10*t||e<t?e:10*t}const Bn=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Sn(e,t,a){e[a[0]]=Number(t[a[1]])}const Hn=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function Nn(e,t,a){e[a[0]]=t[a[1]]||0}function Gn(e){const t=We(e._skills),a={}
return function(e,t){Bn.forEach(l(Sn,e,t))}(a,e),function(e,t){Hn.forEach(l(Nn,e,t))}(a,t),a.superEliteSlayerMultiplier=Se(.002*a.superEliteSlayerLevel,2),Be(a.armorValue)&&function(e){e.attackValue=$n(e.attackBonus,e.levelValue),e.defenseValue=$n(e.defenseBonus,e.levelValue),e.armorValue=$n(e.armorBonus,e.levelValue),e.damageValue=$n(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}let xn,Tn,En,Pn,Fn,Rn,On,In,_n,jn,qn,Yn,Kn
function zn(e){return Math.round(e*Vn)}function Un(){yt(xn,Ka),yt(En,Ua),yt(Pn,Wa),yt(Fn,Xa),yt(On,en),o(In,an),_n+=1,o(_n,nn)}function Qn(e){const t=function(e){return Math.ceil(qn.attack*(.0025*q(e["Nightmare Visage"],0)))}(e)
qn.attack-=t,function(){const e=Math.ceil(qn.attack*jn.flinchLevel*.001)
yt(qn.attack-e,un)}()
const a=function(e){return Math.ceil(qn.defense*(1+.001*q(e.Constitution,0)))}(e)
yt(a+t,cn),function(e){yt(qn.armor+Math.floor(qn.armor*q(e.Sanctuary,0)*.001),dn)}(e)
const n=function(e,t){return Math.ceil(t*q(e.Fortitude,0)*.001)}(e,a)
!function(e){yt(qn.hp+e,bn)}(n),function(e,t){const a=Math.ceil((qn.hp+t)*q(e["Chi Strike"],0)*.001),n=Math.ceil(qn.damage*jn.terrorizeLevel*.001)
yt(qn.damage+a-n,mn)}(e,n)}function Wn(){o("Processing attacking group stats ... ",gn),Yn&&(qn.attack-=Yn.attack,qn.defense-=Yn.defense,qn.armor-=Yn.armor,qn.damage-=Yn.damage,qn.hp-=Yn.hp),yt(qn.attack,sn),yt(qn.defense,ln),yt(qn.armor,fn),yt(qn.damage,hn),yt(qn.hp,pn)
const e=We(GameData.player().buffs)
Qn(e),function(e){const t=Math.ceil(Tn*q(e.Flinch,0)*.001)
yt(Tn-t,za)}(e),function(e){const t=Math.ceil(Rn*q(e.Terrorize,0)*.001)
yt(Rn-t,Za)}(e),o("Done.",gn)}function Jn(){o("Processing defending guild stats ... ",gn),xn+=zn(jn.attackValue),En+=zn(jn.defenseValue),Pn+=zn(jn.armorValue),Fn+=zn(jn.damageValue),On+=zn(jn.hpValue),Un()
const e=Math.ceil(xn*(.0025*jn.nightmareVisageLevel))
!function(e){Tn=xn-e,yt(Tn,za)}(e)
const t=Math.ceil(En*(1+.001*jn.constitutionLevel))
!function(e,t){const a=t+e
yt(a,Qa),yt(Math.ceil(.55*a),rn),yt(Math.ceil(.65*a),on)}(e,t),yt(Pn+Math.floor(Pn*jn.sanctuaryLevel*.001),Ja)
const a=On+function(e){return Math.ceil(e*jn.fortitudeLevel*.001)}(t)
yt(a,tn),function(e){Rn=Fn+Math.ceil(e*jn.chiStrikeLevel*.001),yt(Rn)}(a),0!==jn.cloakLevel&&o("Yes",Ya),GameData.player().hasGroup&&qn?Wn():o("Done.",gn)}function Xn(e){const t=Gn(e)
xn+=Math.round(t.attackValue*Y),En+=Math.round(t.defenseValue*Y),Pn+=Math.round(t.armorValue*Y),Fn+=Math.round(t.damageValue*Y),On+=Math.round(t.hpValue*Y),0!==t.cloakLevel&&(In+=1),Un()}function Zn(e){jn=Gn(e)}function er(e){qn=e}function tr(e){Yn=e}function ar(e){o(e.message,gn)}function nr(e){const t=_(e),a=Q('#pCC a[href*="confirmDisband"]',t)
if(!a)return
const n=function(e){const t=e.previousElementSibling.href,a=[ze(t).then(er)]
return function(e){return-1!==e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(e)&&a.push(Ue().then(tr)),a}(a)
return Oe(n)}function rr(e,t){return 0===t?W(e).then(Zn):W(e).then(Xn).catch(ar)}function or(){let e=[U({cmd:"guild",subcmd:"view",guild_id:Kn.controlled_by.guild_id}).then(An)]
return GameData.player().hasGroup&&e.push(U({cmd:"guild",subcmd:"groups"}).then(nr)),e=e.concat(Ra.map(rr)),e}function ir(){Mn(Kn),xn=0,En=0,Pn=0,Fn=0,On=0,In=0,_n=0
const e=or()
Ie(e,Jn)}function sr(e,t){Ta(t)||(Kn=t.response.data,Kn.defenders.length>0&&(yn(Kn),z(Fa,"click",ir)))}function ur(){$.subscribe(K,sr)}const lr=[]
function cr(e){return Ta(e)||lr.push(e),e}function fr(e,t){return e===Number(t.response.data.id)}function dr(e,t){e(t)}function hr(e,t){const a=lr.find(l(fr,e))
return a?function(e){return new Promise(t=>{J(3,dr,[t,e])})}(a):_e({a:1,id:e,passback:t}).then(cr)}let mr,pr,br,gr,vr,yr
function wr(e,t){return X(Z(t,e))}function kr(){var e
mr=GameData.player().level,e=n("statbar-character-tooltip-stats"),br=wr(e,re),pr=wr(e,ee),vr=wr(e,te),gr=wr(e,ae),yr=wr(e,ne)}function Cr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function Lr(e,t,a){return function(e){return"<table><tr><td>"+`<img src="${oe}creatures/${e.image_id}.png" `+'height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>'}(e)+function(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${mr}</span>)</td></tr>`}(e,a)+function(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${pr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${br}</span>)</td></tr>`}(e)+function(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${gr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${vr}</span>)</td></tr>`}(e)+function(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${yr}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}(e,t)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(Cr).join("")}(e)+function(e){return'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td>'+`</tr><tr><td colspan="4">${e.description}</td></tr>`+'<tr><td colspan="4" height="5"></td></tr></table></td></tr>'+`<tr><td class="fshCenter"><b>${e.name}</b></td></tr>`+"</table>"}(e)}function Dr(t){if(!Ta(t))return function(t){const a=Math.ceil(t.hp*e.hpVariable+t.armor*e.generalVariable)
let n="fshYellow"
return kr(),mr>t.level&&(n="fshRed"),Lr(t,a,n)}(t.response.data)}const Mr=["verb","view","tip-static"]
function Vr(e,t){const a=Dr(t)
e.set("content.text",a)}function Ar(e,t,a){return hr(GameData.actions()[e].data.id,e).then(l(Vr,a)),"Loading..."}function $r(e,t){se("NewMap","CreatureInfo")
const a=ue((n=t).parentNode.children).indexOf(n)
var n,r,o
e.classList.add("fshTip"),r=e,o=l(Ar,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:o},hide:{effect:!1}})}function Br(t){if(!e.showCreatureInfo)return
const{target:a}=t,n=a.parentNode.parentNode.parentNode;(function(e,t){return qe(Mr,e)&&!ie("fshTip",e)&&ie("creature",t)})(a,n)&&$r(a,n)}function Sr(){H(n("actionList"),"mouseover",Br)}function Hr(){return le({subcmd:"scouttower"})}function Nr(e,t){const a=e.insertCell(-1)
return[a.colSpan]=t,t[2]&&(a.className="header"),s(a,t[1]),a}function Gr(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(l(Nr,e))}(n,t),n}function xr(e,t){Gr(e,t[0],t[1])}function Tr(e,t){t.forEach(l(xr,e))}let Er,Pr,Fr,Rr,Or,Ir,_r,jr,qr,Yr,Kr,zr,Ur,Qr,Wr,Jr,Xr,Zr,eo,to,ao,no,ro,oo,io,so,uo,lo
function co(){Pr=Gt("Current"),Fr=Gt("Kills"),Rr=Gt("Member"),Or=Gt("% of Total"),Ir=Gt("Status"),_r=Gt("Titan HP"),jr=Gt("Total"),qr=Gt("Your Guild")}function fo(){for(;Xr.rows.length>7;)Xr.deleteRow(7)}function ho(){const e=i()
return s(e,Yr),Ge(e,"/"),s(e,Kr),e}function mo(e){const t=i()
return s(t,e),Ge(t,"%"),t}function po(){eo=null,Zr&&!Zr.classList.contains("fshHide")&&(t(Zr,!0),o("",Yr),o("",Kr),o("",zr),o("",Ur),o("",Qr),P("",Wr),P("",Jr),fo())}function bo(e){return 0===e.type&&(eo=e.base_creature_id,!0)}function go(){if(Zr)t(Zr,!1)
else{const e=n("actionContainer")
Zr=a({className:"fshActionBox titanInfo"}),Yr=i(),Kr=i(),zr=i(),Ur=i(),Qr=i(),Wr=i(),Jr=i(),Xr=Pe({className:"fshCenter"}),co(),Tr(Xr,[[[[2,_r,!0],[4,qr,!0]]],[[[2,ho()],[4,zr]]],[[[2,Pr,!0],[4,mo(Ur)]],!0],[[[2,jr,!0],[4,mo(Qr)]],!0],[[[2,Ir,!0],[4,Wr]],!0],[[[6,Jr]]],[[[2,Rr,!0],[2,Fr,!0],[2,Or,!0]]]]),s(Zr,Xr),s(e,Zr)}}function vo(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(de+1e3*e)
return`${ce(t.getHours())}:${ce(t.getMinutes())} ${ce(t.getDate())}/${fe[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function yo(e){o(e.current_hp,Yr),o(e.max_hp,Kr),o(e.kills,zr),o(function(e){return He(Je(e.max_hp-e.current_hp,e.kills),2)}(e),Ur),o(function(e){return He(100*e.kills/e.max_hp,2)}(e),Qr),P(function(e){return Xe(e.kills,e.max_hp,e.current_hp)}(e),Wr),P(vo(e.cooldown),Jr)}function wo(e,t){return[[[2,Gt(t.player.name)],[2,Gt(t.kills.toString())],[2,Gt(`${He(100*t.kills/e.kills,2)}%`)]]]}function ko(e){return e.realm&&e.creature.base_id===eo&&e.realm===Er}function Co(e){const t=e.find(ko)
t&&(yo(t),function(e){if(fo(),!e.contributors)return
const t=e.contributors.map(l(wo,e))
Tr(Xr,t)}(t))}function Lo(t){return e.showTitanInfo&&$e(t)&&t.some(bo)}function Do(e,t){(function(e){return e.s&&$e(e.r)})(t)&&(Co(t.r),Lo(GameData.realm().dynamic)?to=window.setTimeout(e,3e4):po())}function Mo(){Hr().then(l(Do,Mo))}function Vo(e){to&&(window.clearTimeout(to),to=null),Lo(e)?(go(),Mo()):po()}function Ao(e){var t
e.dynamic&&(t=e.name,Er=t,Vo(e.dynamic))}function $o(e,t){(function(e){return e.realm&&e.realm.name})(t)&&Ao(t.realm)}function Bo(){window.initialGameData&&$o(0,window.initialGameData),$.subscribe(`${he} ${me}`,$o)}function So(e){const t=e.response.response,a=e.response.msg
let n
if(0!==t){const e=a.indexOf("<")
n=-1!==e?a.substring(0,e):a}else n=`You purchased ${e.response.data.name} for ${u(e.response.data.cost)} gold.`
c(uo,`${n}<br>`)}function Ho(){GameData.doAction(14,3,{id:ao.id,item_id:ao.itemId},0),ro.close()}function No(){const e=xe(io.value)
if(!e)return
const t=[]
for(let a=1;a<e;a+=1)t.push(_e({a:14,d:0,id:ao.id,item_id:ao.itemId}).then(So))
Ie(t,Ho)}function Go(){oo?o("",uo):(oo=a({className:"fshClear",textContent:"Select how many to quick-buy:"}),io=Ne({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),s(oo,io),so=Fe({textContent:"Quick-buy"}),f(so,No),s(oo,so),uo=a(),s(oo,uo),s(no,oo))}function xo(e,t){ao=t,no=no||n("shopDialogConfirm"),no&&(ro=ro||$(no).data("hcsWorldDialogShopConfirm"),ro&&Go())}function To(){$.subscribe(pe,xo)}function Eo(e){lo[e.name]?lo[e.name].seen&&(lo[e.name].seen+=1):(lo[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,lo[e.name]))}function Po(e,t,a){return t?e(t,a):a}function Fo(e,t){const a=e||{}
return a.min=Po(Math.min,a.min,t),a.max=Po(Math.max,a.max,t),a}const Ro=["attack","armor","damage","defense","hp"]
function Oo(e,t,a){const n=Fo(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function Io(e,t){e[t.name]=Fo(e[t.name],Number(t.value))}function _o(e){lo||(lo={}),Eo(e),function(e,t){Ro.forEach(l(Oo,e,t))}(e,lo[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(l(Io,t.enhancements)))}(e,lo[e.name]),k("fsh_monsterLog",lo)}function jo(e){lo=e||{}}const qo=[]
function Yo(t){var a
Ta(t)||(se("NewMap","MonsterLog"),a=t.response.data,e.showMonsterLog&&_o(a))}function Ko(e,t){return e.id===t.id}function zo(e,t){6!==e.type||function(e){if(qo.find(l(Ko,e.data)))return!0
qo.push(e.data)}(e)||hr(e.data.id,t).then(Yo)}function Uo(){e.showMonsterLog&&GameData.actions().forEach(zo)}function Qo(){y("fsh_monsterLog").then(jo),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",Uo),Uo()}function Wo(e){return le(be({subcmd:"groups"},e))}function Jo(e){return function(e){return Wo({subcmd2:"viewstats",group_id:e})}(e)}function Xo(){return Wo({subcmd2:"view"})}function Zo(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const ei=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>`Player 1 hits${Zo(e)}`],[e=>e.playerHits>1,e=>`Player > 1 hits${Zo(e)}`]]
function ti(e,t){return t[0](e)}function ai(e){e.playerHits=function(e){return"-"===e.numberOfCreatureHitsTillDead?e.numberOfHitsRequired:function(e){return"-"===e.numberOfHitsRequired||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}(e)?"-":e.numberOfHitsRequired}(e),e.creatureHits=function(e){return"-"===e.numberOfHitsRequired?e.numberOfCreatureHitsTillDead:function(e){return"-"===e.numberOfCreatureHitsTillDead||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}(e)?"-":e.numberOfCreatureHitsTillDead}(e),e.fightStatus=function(e){const t=ei.find(l(ti,e))
return t?t[1](e):"Unknown"}(e)}function ni(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function ri(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),ni(e)}function oi(e){const t=function(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${Math.floor(e.creature.defense*e.player.darkCurseLevel*.002)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-e.creature.defense*e.player.darkCurseLevel*.002
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}function ii(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function si(e){ii(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function ui(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&si(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){ii(e),function(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==e.lowestCALevelToStillHit&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}(e),function(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==e.lowestCALevelToStillKill&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(e)}(e)}function li(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e)
const t=function(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}(e)
if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}function ci(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function fi(e){e.overallDefenseValue=ci(e)+Math.floor(ci(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(ci(e)*e.player.constitutionLevel*.001)}<br>`)}(e),function(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function di(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>`+`CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}let hi,mi,pi,bi,gi,vi,yi,wi,ki,Ci
function Li(){return ia(mi)?"Remove from do not kill list":"Add to the do not kill list"}function Di(){o(Li(),pi)}function Mi(){const t=e.doNotKillList.indexOf(mi);-1===t?e.doNotKillList.push(mi):e.doNotKillList.splice(t,1),Di(),g("doNotKillList",e.doNotKillList.join()),ua()}function Vi(){pi?Di():function(){pi=Fe({className:"fshBl",textContent:Li(),type:"button"})
const e=a({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
s(e,pi),s(hi,e),f(pi,Mi)}()}function Ai(e,t){!function(e){if(!hi){const t=Z("body",e)
1===t.length&&([hi]=t)}}(t),hi&&(mi=e.trim(),Vi())}function $i(){vi||(gi||(gi=a(),s(bi,gi),s(bi,a({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),vi=a(),s(gi,vi))}function Bi(e){$i(),P(e,vi)}function Si(e){yi||($i(),yi=a(),s(gi,yi)),P(e,yi)}function Hi(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Ni(t,a,n){const r={}
r.callback=n,r.player=Gn(a),function(t){t.combatEvaluatorBias=e.combatEvaluatorBias,t.attackVariable=1.1053,t.generalVariable=e.generalVariable,t.hpVariable=e.hpVariable}(r),r.creature=Hi(t.response.data,r.player.superEliteSlayerMultiplier),function(e){di(e),oi(e),li(e),fi(e),ri(e),ai(e),ui(e)}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${function(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(e){return e.callback.groupExists?"Group ":""}(e)}Combat Evaluation</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`Will I hit it? </td><td align="left">${function(e){return e.hitByHowMuch>0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">`+`Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`# Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right">`+`<span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`Will I be hit? </td><td align="left">${function(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">`+`Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`# Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right">`+`<span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`# Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333">`+`# Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3">'+`<span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}(e)}</tbody></table>`}(r),n.groupExists?Si(r.evaluatorHTML):Bi(r.evaluatorHTML)}function Gi(e){return e.members[0].name===d()}function xi(e){if($e(e.r))return e.r.find(Gi).id}function Ti(e,t,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Ni(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Ei(e,t,a){a&&Jo(a).then(l(Ti,e,t))}function Pi(e,t){e.player.hasGroup&&function(e,t){Xo().then(xi).then(l(Ei,e,t))}(e,t),Ni(e,t,{groupExists:!1})}function Fi(e,t){bi||(bi=n("dialog-viewcreature")),bi&&(Bi(""),Si(""),function(e){return e.response&&e.response.data}(t)&&(Ai(t.response.data.name,bi),ve(!0).then(l(Pi,t))))}function Ri(){$.subscribe(ge,Fi)}function Oi(){const t=[,[e.buffs,e.buffsName],[e.buffs2,e.buffs2Name],[e.buffs3,e.buffs3Name]][e.enabledHuntingMode]
$e(t)&&([wi,ki]=t)}function Ii(t){"enabledHuntingMode"===t.target.name&&(e.enabledHuntingMode=t.target.value,g("enabledHuntingMode",e.enabledHuntingMode),Oi(),GameData.fetch(h))}function _i(e){const t=Z("verbs",e)
1===t.length&&F(t[0])}function ji(){if(!Ci)return
const e=n("actionList")
C("player",e).forEach(_i)}const qi={hideSubLvlCreature:function(){e.hideSubLvlCreature=!e.hideSubLvlCreature,g("hideSubLvlCreature",e.hideSubLvlCreature),GameData.fetch(ye)},hidePlayerActions:function(){Ci=!Ci,g("hidePlayerActions",Ci),GameData.fetch(ye)},showCreatureInfo:function(){e.showCreatureInfo=!e.showCreatureInfo,g("showCreatureInfo",e.showCreatureInfo)},showHuntingBuffs:function(){e.showBuffs=!e.showBuffs,g("showHuntingBuffs",e.showBuffs),GameData.fetch(h)},showMonsterLog:function(){e.showMonsterLog=!e.showMonsterLog,g("showMonsterLog",e.showMonsterLog)},showTitanInfo:function(){e.showTitanInfo=!e.showTitanInfo,g("showTitanInfo",e.showTitanInfo),Vo(GameData.realm().dynamic)},showBuffInfo:function(){e.showBuffInfo=!e.showBuffInfo,g("showBuffInfo",e.showBuffInfo),Ut()}}
function Yi(e){const t=qi[e.target.name]
D(t)&&(e.target.blur(),t(e))}function Ki(){const e=a({className:"fshCenter fshFten"}),t=a({id:"fshWorldPrefs",innerHTML:`${Ee("showCreatureInfo")}&nbsp;&nbsp;${Ee("showMonsterLog")}&nbsp;&nbsp;${Ee("showTitanInfo")}&nbsp;&nbsp;${Ee("showBuffInfo")}<br>${Ee("hideSubLvlCreature")}&nbsp;&nbsp;${Ee("hidePlayerActions")}&nbsp;&nbsp;${tt()}`})
f(t,Yi),H(t,"change",Ii),s(e,t)
const r=a()
s(e,r)
const o=n("worldContainerBelow").children[0]
return S(e,o),r}function zi(e,t){return e[t.name]=!0,e}function Ui(e,t,a){return e[a.trim()]||t.push(a),t}function Qi(e){P("",e)}function Wi(e,t){const a=t.b.reduce(zi,{}),n=wi.reduce(l(Ui,a),[])
n.length>0?function(e,t){P(`You are missing some ${ki} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):Qi(e)}function Ji(t,a,n){wi&&function(t,a,n){e.showBuffs?Wi(t,n):Qi(t)}(t,0,n)}const Xi=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function Zi(){var t
e.combatEvaluatorBias=v("combatEvaluatorBias"),e.generalVariable=(t=e.combatEvaluatorBias,Xi[t]?Xi[t].generalVariable:1.1053),e.hpVariable=function(e){return Xi[e]?Xi[e].hpVariable:1.1}(e.combatEvaluatorBias)}function es(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function ts(e){const t=we(e)
return function(e){return!e||!e.actions||0===e.actions.length}(t)?e:(t.actions=t.actions.filter(l(es,function(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}(t))),JSON.stringify(t))}function as(t,a){e.hideSubLvlCreature&&function(e){return e.data&&e.data.d&&Qe(e.data.d,ye)}(a)&&(t.dataFilter=ts)}function ns(t){e[t[0]]=ke(t[1])}function rs(t){e[t]=ke(t)}function os(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(ns),["doNotKillList"].forEach(rs)}function is(t){e[t[0]]=v(t[1])}function ss(t){e[t]=v(t)}function us(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(is),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(ss)}function ls(){Zi(),os(),us()
const t=Ki()
$.ajaxPrefilter("JSON",as),e.hideSubLvlCreature&&GameData.fetch(ye),function(t){Oi()
const a=l(Ji,t)
$.subscribe(m,a),e.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(t),Ci=v("hidePlayerActions"),$.subscribe(V,ji),ji()}function cs(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const fs=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function ds(e,t){var a
v(e)&&(a=t+1,$.subscribe(V,l(cs,a)),cs(t+1))}function hs(){fs.forEach(ds)}function ms(){v("enableCreatureColoring")&&s(document.body,Re("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))}function ps(e,t){"ACT_REPAIR"===t&&GameData.fetch(Me+h+Ve+ye)}function bs(){$.subscribe(De,ps)}function gs(){$("#messageCenter").worldMessageCenter({offset:"0 60"})}function vs(){N("#mapTooltip")}function ys(e){N(e.target)}function ws(){f(n("buffList"),ys)}export default function(){Ae()&&n("worldPage")&&window.GameData&&Ce([ls,Le,Ri,hs,ms,da,Qo,bs,oa,Bo,To,ur,gs,vs,xa,Wt,ws,Sr])}
//# sourceMappingURL=injectWorld-48e36b31.js.map
