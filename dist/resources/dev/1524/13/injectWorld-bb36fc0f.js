import{e,t,l as a,A as n,V as r,B as o,U as i,h as s,ac as u,v as l,i as c,o as f,ad as d,ae as h,R as m,af as p,ag as b,ah as g,a5 as v,G as y,ai as w,aj as k,ak as C,al as L,D,am as M,an as V,ao as A,N as S,ap as B,aq as H,ar as N,as as G,P as x,f as T,at as E,au as P,av as F,aw as R,ax as O,C as I,n as _,ay as j,aa as q,az as Y,x as K,aA as z,ab as U,aB as W,aC as Q,Q as J,w as X,S as Z,W as ee,a as te,J as ae,K as ne,aD as re,aE as oe,aF as ie,aG as se,aH as ue,aI as le,aJ as ce,a1 as fe,aK as de,aL as he,aM as me,aN as pe,aO as be,aP as ge,aQ as ve,aR as ye,aS as we,aT as ke,aU as Ce,aV as Le,aW as De,aX as Me,aY as Ve,aZ as Ae,a_ as Se,j as Be}from"./calfSystem-01eb06ed.js"
import{n as He}from"./numberIsNaN-5d7b8ccd.js"
import{r as $e}from"./round-0f71090a.js"
import{r as Ne}from"./roundToString-c0cdd0e8.js"
import{c as Ge}from"./createInput-7fd54c66.js"
import{i as xe}from"./insertTextBeforeEnd-7d27fb10.js"
import"./testRange-ced4a145.js"
import{t as Te}from"./testQuant-852eb37e.js"
import{c as Ee}from"./createLabel-94fe4ec2.js"
import"./createUl-c1a39af0.js"
import"./isChecked-4667e9c3.js"
import{b as Pe}from"./simpleCheckbox-d5402db3.js"
import{c as Fe}from"./createTable-1806515f.js"
import{c as Re}from"./createButton-33c18cfd.js"
import{c as Oe}from"./createStyle-0e8eb3f7.js"
import{a as Ie}from"./all-6b303efd.js"
import{a as _e}from"./allthen-385cdb7e.js"
import"./rnd-a99d963a.js"
import{f as je}from"./fetchdata-d661f9e6.js"
import{e as qe}from"./eventHandler5-32a6db3c.js"
import{h as Ye}from"./hasClasses-8857f04e.js"
import"./isSelected-20065735.js"
import{g as Ke}from"./getMembrList-38374103.js"
import{d as ze,g as Ue}from"./getGroupStats-eae8ae02.js"
import"./groupViewStats-118f3795.js"
import{g as We}from"./getMercStats-7c29381b.js"
import{b as Qe}from"./bitwiseAnd-cf455597.js"
import{r as Je}from"./reduceBuffArray-536906d9.js"
import{g as Xe,a as Ze}from"./getTitanString-b91b3843.js"
import{d as et,q as tt}from"./quickbuffSuccess-11684457.js"
import{a as at}from"./huntingBuffs-48380701.js"
let nt,rt,ot,it,st,ut,lt,ct,ft
function dt(e){return e}function ht(o){if(function(t){return e.showBuffInfo&&t.some(dt)}(o))return function(){if(nt)t(nt,!1)
else{nt=a({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const e=n("actionContainer")
r(nt,e.children[2])}return nt}()
nt&&t(nt,!0)}function mt(e,a){rt?t(rt,!1):function(e){rt=e.children[3],rt.className="fshBlue",o("CA ",rt),ot=i(),s(rt,ot),xe(rt," active")}(e),o(a.level,ot)}function pt(e,a){a?mt(e,a):rt&&t(rt,!0)}function bt(e,a){it?t(it,!1):function(e){it=e.children[4],it.className="fshRed",o("Doubler ",it),st=i(),s(it,st),xe(it," active")}(e),o(a.level,st)}function gt(e,a){a?bt(e,a):it&&t(it,!0)}function vt(e,a,n){ut?t(ut,!1):function(e){ut=e.children[2],o("Damage bonus: ",ut),lt=i(),s(ut,lt),xe(ut,"%")}(e),o(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return $e(a,2).toString()}return"0"}(a,Number(n)),lt)}function yt(e,a,n){a?vt(e,a,n):ut&&t(ut,!0)}function wt(e,t){o(u(e),t)}function kt(e,a){ct?t(ct,!1):function(e){ct=e.children[1],o("Kill Streak: ",ct),ft=i(),s(ct,ft)}(e),wt(a,ft)}function Ct(e,a,n,r){a||n?kt(e,r):ct&&t(ct,!0)}function Lt(e,t){return t.name===e}function Dt(e){const{buffs:t}=GameData.player()
if(t)return t.find(l(Lt,e))}const Mt=["red","orange","yellow"]
let Vt,At
function St(e){tt(e)&&GameData.fetch(h)}function Bt(){Dt("Summon Shield Imp")||et([d()],[55]).then(St)}const Ht=["imp-0","imp-1","imp-1"]
function $t(e,a){Vt?t(Vt,!1):function(e){Vt=e.children[0],o("Shield Imps Remaining: ",Vt),At=i(),s(Vt,At),c(Vt,"&nbsp;")
const t=i({className:"xSmallLink",textContent:"Recast"})
s(Vt,t),f(t,Bt)}(e)
const n=function(e){return e?Number(e.stack):0}(a)
Vt.className=function(e){return Ht[e]||"fshGreen"}(n),o(n,At)}function Nt(e,a,n){a||n?$t(e,a):Vt&&t(Vt,!0)}function Gt(e){return 0===e.type}function xt(e){return i({textContent:e})}let Tt,Et,Pt,Ft,Rt,Ot,It,_t,jt,qt
function Yt(e,a){Tt?t(Tt,!1):function(e,t){Tt=e.children[5],o("Teleport Cooldown: ",Tt),Et=xt(t.toString()),s(Tt,Et)}(e,a)}function Kt(){const e=Math.max(Math.ceil((Pt-Date.now())/1e3),0)
o(e,Et),e>0&&setTimeout(Kt,500)}function zt(e,a){a?Yt(e,a):Tt&&t(Tt,!0)}function Ut(){Ft=Dt("Death Dealer"),Rt=Dt("Doubler"),Ot=Dt("Counter Attack"),It=Dt("Summon Shield Imp"),_t=function(){const e=GameData.player().teleportCooldown
return e>1&&e}(),jt=function(){const{dynamic:e}=GameData.realm()
return m(e)&&e.some(Gt)}(),qt=GameData.player().killStreak}function Wt(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",Mt[e.text()]||"#ad8043")}(),Ut()
const e=ht([Ft,Rt,Ot,It,_t,jt])
e&&(Nt(e,It,Ft),Ct(e,Ft,jt,qt),yt(e,Ft,qt),pt(e,Ot),gt(e,Rt),zt(e,_t))}function Qt(e,t){var a
a=t.player.teleportCooldown,Et&&(Pt=Date.now()+1e3*a,Kt())}const Jt=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let Xt,Zt=[]
function ea(e){54!==e.id&&26!==e.id||(Xt.player.buffs[e.id]=parseInt(e.level,10))}function ta(e){-1===Jt.indexOf(e.name)&&(Xt.player.enhancements[e.name]=e.value)}function aa(e,t){Xt={},Xt.combat=t.response.data,Xt.combat.inventory_id&&(Xt.combat.drop=Xt.combat.item.id),Xt.player={},Xt.player.buffs={},Xt.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(ea)}(t),function(e){e.player.enhancements&&e.player.enhancements.forEach(ta)}(t),Xt.time=t.time,Zt.push(Xt),C("fsh_combatLog",Zt)}function na(e,t){0===t.response.response&&aa(0,t)}function ra(e){e&&(Zt=e),$.subscribe(k,na)}function oa(t){return e.doNotKillList.includes(t.trim())}function ia(e){e.classList.toggle("fshBlue",oa(D(e)))}function sa(){const e=n("actionList")
L("creature",e).forEach(ia)}function ua(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(oa(e))return n("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const la={2:function(e){return function(t,a,n,r){ua(n.passback)||e(t,a,n,r)}}}
function ca(e){return function(t,a,n,r){const o=la[t];(function(e){return e&&M(e)})(o)&&function(e){return V(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function fa(e){e.remove()}function da(e,t){!function(e){(function(e){return e.response&&e.response.msg&&e.response.msg.startsWith("Creature did not exist at that location")})(e)&&GameData.fetch(B+H)}(t),S(".creature-4 > .quickCombat > .verbs").forEach(fa)}function ha(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function ma(e,t,a){return Ee({className:"fshCurveEle fshCurveLbl fshPoint tip-static "+e,dataset:{tipped:t},htmlFor:a})}function pa(e){const t=a({className:"fshToggle"}),n=Ge({checked:e.prefVal,id:e.checkId,type:"checkbox"})
s(t,n)
const r=ma(e.onClass,e.onTip,e.checkId)
s(t,r)
const o=ma(e.offClass,e.offTip,e.checkId)
return s(t,o),s(e.worldName,t),n}let ba,ga,va,ya,wa,ka,Ca,La,Da
function Ma(e){return e?e.toString():"?"}function Va(e){const t=a({className:"fshFsty"})
s(t,function(){const e=a({textContent:"Min Lvl: "})
return ga=xt(Ma(GameData.realm().minlevel)),s(e,ga),e}()),s(t,function(){const e=a({textContent:"Your Lvl: "})
return va=xt(Ma(GameData.player().level)),s(e,va),e}()),s(e,t)}function Aa(e,t,a){const n=Re({className:"fshCurveEle fshCurveBtn fshPoint tip-static "+e,dataset:{tipped:t}})
return s(a,n),n}function Sa(){var t
Va(t=ba),ya=Aa("fshFormGroup","Quick Create Attack Group",t),wa=Aa("fshQuickBuff","Open Quick Buff Popup",t),ka=Aa("fshRealmMap","Open Realm Map",t),Ca=Aa("fshTempleOne","Search map in Ultimate FSG",t),function(e){if(y("showSpeakerOnWorld")){const t=y("playNewMessageSound")
La=pa({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(ba),function(t){const a=e.huntingMode
Da=pa({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:t})}(ba)}const Ba=[[e=>e===La,function(){v("playNewMessageSound",!y("playNewMessageSound"))}],[e=>e===Da,function(){e.huntingMode=!e.huntingMode,v("huntingMode",e.huntingMode)}]],Ha=[[e=>e===ya,function(e){E(e),GameData.doAction(12,401,{},0)}],[e=>e===wa,function(){P(d())}],[e=>e===ka,function(){window.open(F+R+"map","fsMap")}],[e=>e===Ca,function(){const e=GameData.realm()
window.open(`${O}realms${R}view&realm_id=${e.id}`,"mapUfsg")}]]
function $a(){ba||(ba=a({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),Sa(),f(ba,qe(Ha)),T(ba,"change",qe(Ba)),x(ba,n("worldCoord")))}function Na(e,t){ga&&t.b.minlevel&&(ha(),o(t.b.minlevel,ga))}function Ga(e,t){va&&o(t.b,va)}function xa(e){return!e||!e.response||!e.response.data}let Ta,Ea,Pa,Fa,Ra,Oa,Ia,_a,ja,qa,Ya,Ka,za,Ua,Wa,Qa,Ja,Xa,Za,en,tn,an,nn,rn,on,sn,un,ln,cn,fn,dn,hn,mn,pn,bn
function gn(e){return e.player_name}function vn(e){!function(e){Fa=e.defenders.map(gn)}(e),Ta?I("",Ta):Ta=a({className:"body"}),function(e){Ea=a({className:"fshFloatLeft fshRelicLeftDiv"}),s(Ta,Ea),e.is_owner&&s(Ea,ze(Fa)),Pa=Re({className:"custombutton",textContent:"Fetch Stats"}),s(Ea,Pa)}(e)
const t=n("dialog-relic")
s(t,Ta)}const yn=[e=>"lastUpdate"!==e,e=>!Fa.includes(e),e=>Ra[e].last_login,e=>Number(Ra[e].last_login)<Oa,e=>Number(Ra[e].last_login)>Ia,e=>Ra[e].level<400||Ra[e].level>421,e=>Ra[e].level<441||Ra[e].level>450]
function wn(e,t){return t(e)}function kn(e){return yn.every(l(wn,e))}function Cn(e){return`<a href="${q}${Ra[e].id}">${e}</a>`}function Ln(e){Ra=e,Oa=Y-120,Ia=Y-604800
const t=j(Ra).filter(kn).map(Cn)
c(Ta,'<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>'+t.length.toString()+" Offline guild members not at relic:</th></tr></thead>"+`<tbody><tr><td>${t.join(" ")}</td></tr></tbody></table></div>`)}function Dn(e){_(Pa)
const t=y("hideRelicOffline")
e.is_owner&&!t&&Ke(!0).then(Ln),c(Ea,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),bn=n("ProcessingStatus")
const r=a({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
s(Ta,r),_a=n("relicCount"),ja=n("LDPercentage"),qa=n("LDCloaked"),Ya=n("attackValue"),Ka=n("attackValueBuffed"),za=n("defenseValue"),Ua=n("defenseValueBuffed"),Wa=n("armorValue"),Qa=n("armorValueBuffed"),Ja=n("damageValue"),Xa=n("damageValueBuffed"),Za=n("hpValue"),en=n("hpValueBuffed"),tn=n("defendersCloaked"),an=n("defendersProcessed")
const o=a({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
s(Ta,o),nn=n("DC225"),rn=n("DC175"),on=n("GroupAttack"),sn=n("GroupAttackBuffed"),un=n("GroupDefense"),ln=n("GroupDefenseBuffed"),cn=n("GroupArmor"),fn=n("GroupArmorBuffed"),dn=n("GroupDamage"),hn=n("GroupDamageBuffed"),mn=n("GroupHP"),pn=n("GroupHPBuffed")}let Mn
function Vn(e){const t=K(e),a=z('#pCC img[src*="/relics/"]',t).length
var n
o(a,_a),Mn=1===(n=a)?1.5:$e(1-n/10,2),o(String(100*Mn)+"%",ja)}function An(e,t){return e>10*t||e<t?e:10*t}const Sn=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Bn(e,t,a){e[a[0]]=Number(t[a[1]])}const Hn=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function $n(e,t,a){e[a[0]]=t[a[1]]||0}function Nn(e){const t=Je(e._skills),a={}
return function(e,t){Sn.forEach(l(Bn,e,t))}(a,e),function(e,t){Hn.forEach(l($n,e,t))}(a,t),a.superEliteSlayerMultiplier=$e(.002*a.superEliteSlayerLevel,2),He(a.armorValue)&&function(e){e.attackValue=An(e.attackBonus,e.levelValue),e.defenseValue=An(e.defenseBonus,e.levelValue),e.armorValue=An(e.armorBonus,e.levelValue),e.damageValue=An(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}let Gn,xn,Tn,En,Pn,Fn,Rn,On,In,_n,jn,qn,Yn
function Kn(e){return Math.round(e*Mn)}function zn(){wt(Gn,Ya),wt(Tn,za),wt(En,Wa),wt(Pn,Ja),wt(Rn,Za),o(On,tn),In+=1,o(In,an)}function Un(e){const t=function(e){return Math.ceil(jn.attack*(.0025*U(e["Nightmare Visage"],0)))}(e)
jn.attack-=t,function(){const e=Math.ceil(jn.attack*_n.flinchLevel*.001)
wt(jn.attack-e,sn)}()
const a=function(e){return Math.ceil(jn.defense*(1+.001*U(e.Constitution,0)))}(e)
wt(a+t,ln),function(e){wt(jn.armor+Math.floor(jn.armor*U(e.Sanctuary,0)*.001),fn)}(e)
const n=function(e,t){return Math.ceil(t*U(e.Fortitude,0)*.001)}(e,a)
!function(e){wt(jn.hp+e,pn)}(n),function(e,t){const a=Math.ceil((jn.hp+t)*U(e["Chi Strike"],0)*.001),n=Math.ceil(jn.damage*_n.terrorizeLevel*.001)
wt(jn.damage+a-n,hn)}(e,n)}function Wn(){o("Processing attacking group stats ... ",bn),qn&&(jn.attack-=qn.attack,jn.defense-=qn.defense,jn.armor-=qn.armor,jn.damage-=qn.damage,jn.hp-=qn.hp),wt(jn.attack,on),wt(jn.defense,un),wt(jn.armor,cn),wt(jn.damage,dn),wt(jn.hp,mn)
const e=Je(GameData.player().buffs)
Un(e),function(e){const t=Math.ceil(xn*U(e.Flinch,0)*.001)
wt(xn-t,Ka)}(e),function(e){const t=Math.ceil(Fn*U(e.Terrorize,0)*.001)
wt(Fn-t,Xa)}(e),o("Done.",bn)}function Qn(){o("Processing defending guild stats ... ",bn),Gn+=Kn(_n.attackValue),Tn+=Kn(_n.defenseValue),En+=Kn(_n.armorValue),Pn+=Kn(_n.damageValue),Rn+=Kn(_n.hpValue),zn()
const e=Math.ceil(Gn*(.0025*_n.nightmareVisageLevel))
!function(e){xn=Gn-e,wt(xn,Ka)}(e)
const t=Math.ceil(Tn*(1+.001*_n.constitutionLevel))
!function(e,t){const a=t+e
wt(a,Ua),wt(Math.ceil(.55*a),nn),wt(Math.ceil(.65*a),rn)}(e,t),wt(En+Math.floor(En*_n.sanctuaryLevel*.001),Qa)
const a=Rn+function(e){return Math.ceil(e*_n.fortitudeLevel*.001)}(t)
wt(a,en),function(e){Fn=Pn+Math.ceil(e*_n.chiStrikeLevel*.001),wt(Fn)}(a),0!==_n.cloakLevel&&o("Yes",qa),GameData.player().hasGroup&&jn?Wn():o("Done.",bn)}function Jn(e){const t=Nn(e)
Gn+=Math.round(t.attackValue*W),Tn+=Math.round(t.defenseValue*W),En+=Math.round(t.armorValue*W),Pn+=Math.round(t.damageValue*W),Rn+=Math.round(t.hpValue*W),0!==t.cloakLevel&&(On+=1),zn()}function Xn(e){_n=Nn(e)}function Zn(e){jn=e}function er(e){qn=e}function tr(e){o(e.message,bn)}function ar(e){const t=K(e),a=Z('#pCC a[href*="confirmDisband"]',t)
if(!a)return
const n=function(e){const t=e.previousElementSibling.href,a=[Ue(t).then(Zn)]
return function(e){return-1!==e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(e)&&a.push(We().then(er)),a}(a)
return Ie(n)}function nr(e,t){return 0===t?ee(e).then(Xn):ee(e).then(Jn).catch(tr)}function rr(){let e=[X({cmd:"guild",subcmd:"view",guild_id:Yn.controlled_by.guild_id}).then(Vn)]
return GameData.player().hasGroup&&e.push(X({cmd:"guild",subcmd:"groups"}).then(ar)),e=e.concat(Fa.map(nr)),e}function or(){Dn(Yn),Gn=0,Tn=0,En=0,Pn=0,Rn=0,On=0,In=0
const e=rr()
_e(e,Qn)}function ir(e,t){xa(t)||(Yn=t.response.data,Yn.defenders.length>0&&(vn(Yn),J(Pa,"click",or)))}const sr=[]
function ur(e){return xa(e)||sr.push(e),e}function lr(e,t){return e===Number(t.response.data.id)}function cr(e,t){e(t)}function fr(e,t){const a=sr.find(l(lr,e))
return a?function(e){return new Promise(t=>{te(3,cr,[t,e])})}(a):je({a:1,id:e,passback:t}).then(ur)}let dr,hr,mr,pr,br,gr
function vr(e,t){return ae(ne(t,e))}function yr(){var e
dr=GameData.player().level,e=n("statbar-character-tooltip-stats"),mr=vr(e,ue),hr=vr(e,re),br=vr(e,oe),pr=vr(e,ie),gr=vr(e,se)}function wr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function kr(e,t,a){return function(e){return`<table><tr><td><img src="${le}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(e)+function(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${dr}</span>)</td></tr>`}(e,a)+function(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${hr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${mr}</span>)</td></tr>`}(e)+function(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${pr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${br}</span>)</td></tr>`}(e)+function(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${gr}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}(e,t)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(wr).join("")}(e)+function(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}(e)}function Cr(t){if(!xa(t))return function(t){const a=Math.ceil(t.hp*e.hpVariable+t.armor*e.generalVariable)
let n="fshYellow"
return yr(),dr>t.level&&(n="fshRed"),kr(t,a,n)}(t.response.data)}const Lr=["verb","view","tip-static"]
function Dr(e,t){const a=Cr(t)
e.set("content.text",a)}function Mr(e,t,a){return fr(GameData.actions()[e].data.id,e).then(l(Dr,a)),"Loading..."}function Vr(e,t){fe("NewMap","CreatureInfo")
const a=de((n=t).parentNode.children).indexOf(n)
var n,r,o
e.classList.add("fshTip"),r=e,o=l(Mr,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:o},hide:{effect:!1}})}function Ar(t){if(!e.showCreatureInfo)return
const{target:a}=t,n=a.parentNode.parentNode.parentNode;(function(e,t){return Ye(Lr,e)&&!ce("fshTip",e)&&ce("creature",t)})(a,n)&&Vr(a,n)}function Sr(){return he({subcmd:"scouttower"})}function Br(e,t){const a=e.insertCell(-1)
return[a.colSpan]=t,t[2]&&(a.className="header"),s(a,t[1]),a}function Hr(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(l(Br,e))}(n,t),n}function $r(e,t){Hr(e,t[0],t[1])}function Nr(e,t){t.forEach(l($r,e))}let Gr,xr,Tr,Er,Pr,Fr,Rr,Or,Ir,_r,jr,qr,Yr,Kr,zr,Ur,Wr,Qr,Jr,Xr,Zr,eo,to,ao,no,ro,oo,io
function so(){xr=xt("Current"),Tr=xt("Kills"),Er=xt("Member"),Pr=xt("% of Total"),Fr=xt("Status"),Rr=xt("Titan HP"),Or=xt("Total"),Ir=xt("Your Guild")}function uo(){for(;Wr.rows.length>7;)Wr.deleteRow(7)}function lo(){const e=i()
return s(e,_r),xe(e,"/"),s(e,jr),e}function co(e){const t=i()
return s(t,e),xe(t,"%"),t}function fo(){Jr=null,Qr&&!Qr.classList.contains("fshHide")&&(t(Qr,!0),o("",_r),o("",jr),o("",qr),o("",Yr),o("",Kr),I("",zr),I("",Ur),uo())}function ho(e){return 0===e.type&&(Jr=e.base_creature_id,!0)}function mo(){if(Qr)t(Qr,!1)
else{const e=n("actionContainer")
Qr=a({className:"fshActionBox titanInfo"}),_r=i(),jr=i(),qr=i(),Yr=i(),Kr=i(),zr=i(),Ur=i(),Wr=Fe({className:"fshCenter"}),so(),Nr(Wr,[[[[2,Rr,!0],[4,Ir,!0]]],[[[2,lo()],[4,qr]]],[[[2,xr,!0],[4,co(Yr)]],!0],[[[2,Or,!0],[4,co(Kr)]],!0],[[[2,Fr,!0],[4,zr]],!0],[[[6,Ur]]],[[[2,Er,!0],[2,Tr,!0],[2,Pr,!0]]]]),s(Qr,Wr),s(e,Qr)}}function po(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(be+1e3*e)
return`${me(t.getHours())}:${me(t.getMinutes())} ${me(t.getDate())}/${pe[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function bo(e){o(e.current_hp,_r),o(e.max_hp,jr),o(e.kills,qr),o(function(e){return Ne(Xe(e.max_hp-e.current_hp,e.kills),2)}(e),Yr),o(function(e){return Ne(100*e.kills/e.max_hp,2)}(e),Kr),I(function(e){return Ze(e.kills,e.max_hp,e.current_hp)}(e),zr),I(po(e.cooldown),Ur)}function go(e,t){return[[[2,xt(t.player.name)],[2,xt(t.kills.toString())],[2,xt(Ne(100*t.kills/e.kills,2)+"%")]]]}function vo(e){return e.realm&&e.creature.base_id===Jr&&e.realm===Gr}function yo(e){const t=e.find(vo)
t&&(bo(t),function(e){if(uo(),!e.contributors)return
const t=e.contributors.map(l(go,e))
Nr(Wr,t)}(t))}function wo(t){return e.showTitanInfo&&m(t)&&t.some(ho)}function ko(e,t){(function(e){return e.s&&m(e.r)})(t)&&(yo(t.r),wo(GameData.realm().dynamic)?Xr=window.setTimeout(e,3e4):fo())}function Co(){Sr().then(l(ko,Co))}function Lo(e){Xr&&(window.clearTimeout(Xr),Xr=null),wo(e)?(mo(),Co()):fo()}function Do(e){var t
e.dynamic&&(t=e.name,Gr=t,Lo(e.dynamic))}function Mo(e,t){(function(e){return e.realm&&e.realm.name})(t)&&Do(t.realm)}function Vo(e){const t=e.response.response,a=e.response.msg
let n
if(0!==t){const e=a.indexOf("<")
n=-1!==e?a.substring(0,e):a}else n=`You purchased ${e.response.data.name} for ${u(e.response.data.cost)} gold.`
c(oo,n+"<br>")}function Ao(){GameData.doAction(14,3,{id:Zr.id,item_id:Zr.itemId},0),to.close()}function So(){const e=Te(no.value)
if(!e)return
const t=[]
for(let a=1;a<e;a+=1)t.push(je({a:14,d:0,id:Zr.id,item_id:Zr.itemId}).then(Vo))
_e(t,Ao)}function Bo(){ao?o("",oo):(ao=a({className:"fshClear",textContent:"Select how many to quick-buy:"}),no=Ge({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),s(ao,no),ro=Re({textContent:"Quick-buy"}),f(ro,So),s(ao,ro),oo=a(),s(ao,oo),s(eo,ao))}function Ho(e,t){Zr=t,eo=eo||n("shopDialogConfirm"),eo&&(to=to||$(eo).data("hcsWorldDialogShopConfirm"),to&&Bo())}function $o(e){io[e.name]?io[e.name].seen&&(io[e.name].seen+=1):(io[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,io[e.name]))}function No(e,t,a){return t?e(t,a):a}function Go(e,t){const a=e||{}
return a.min=No(Math.min,a.min,t),a.max=No(Math.max,a.max,t),a}const xo=["attack","armor","damage","defense","hp"]
function To(e,t,a){const n=Go(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function Eo(e,t){e[t.name]=Go(e[t.name],Number(t.value))}function Po(e){io||(io={}),$o(e),function(e,t){xo.forEach(l(To,e,t))}(e,io[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(l(Eo,t.enhancements)))}(e,io[e.name]),C("fsh_monsterLog",io)}function Fo(e){io=e||{}}const Ro=[]
function Oo(t){var a
xa(t)||(fe("NewMap","MonsterLog"),a=t.response.data,e.showMonsterLog&&Po(a))}function Io(e,t){return e.id===t.id}function _o(e,t){6!==e.type||function(e){if(Ro.find(l(Io,e.data)))return!0
Ro.push(e.data)}(e)||fr(e.data.id,t).then(Oo)}function jo(){e.showMonsterLog&&GameData.actions().forEach(_o)}function qo(e){return he(we({subcmd:"groups"},e))}function Yo(e){return function(e){return qo({subcmd2:"viewstats",group_id:e})}(e)}function Ko(){return qo({subcmd2:"view"})}function zo(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const Uo=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>"Player 1 hits"+zo(e)],[e=>e.playerHits>1,e=>"Player > 1 hits"+zo(e)]]
function Wo(e,t){return t[0](e)}function Qo(e){e.playerHits=function(e){return"-"===e.numberOfCreatureHitsTillDead?e.numberOfHitsRequired:function(e){return"-"===e.numberOfHitsRequired||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}(e)?"-":e.numberOfHitsRequired}(e),e.creatureHits=function(e){return"-"===e.numberOfHitsRequired?e.numberOfCreatureHitsTillDead:function(e){return"-"===e.numberOfCreatureHitsTillDead||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}(e)?"-":e.numberOfCreatureHitsTillDead}(e),e.fightStatus=function(e){const t=Uo.find(l(Wo,e))
return t?t[1](e):"Unknown"}(e)}function Jo(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function Xo(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),Jo(e)}function Zo(e){const t=function(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${Math.floor(e.creature.defense*e.player.darkCurseLevel*.002)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-e.creature.defense*e.player.darkCurseLevel*.002
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}function ei(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function ti(e){ei(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function ai(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&ti(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){ei(e),function(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==e.lowestCALevelToStillHit&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}(e),function(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==e.lowestCALevelToStillKill&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(e)}(e)}function ni(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e)
const t=function(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}(e)
if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}function ri(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function oi(e){e.overallDefenseValue=ri(e)+Math.floor(ri(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(ri(e)*e.player.constitutionLevel*.001)}<br>`)}(e),function(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function ii(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}let si,ui,li,ci,fi,di,hi,mi,pi,bi
function gi(){return oa(ui)?"Remove from do not kill list":"Add to the do not kill list"}function vi(){o(gi(),li)}function yi(){const t=e.doNotKillList.indexOf(ui);-1===t?e.doNotKillList.push(ui):e.doNotKillList.splice(t,1),vi(),v("doNotKillList",e.doNotKillList.join()),sa()}function wi(){li?vi():function(){li=Re({className:"fshBl",textContent:gi(),type:"button"})
const e=a({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
s(e,li),s(si,e),f(li,yi)}()}function ki(e,t){!function(e){if(!si){const t=ne("body",e)
1===t.length&&([si]=t)}}(t),si&&(ui=e.trim(),wi())}function Ci(){di||(fi||(fi=a(),s(ci,fi),s(ci,a({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),di=a(),s(fi,di))}function Li(e){Ci(),I(e,di)}function Di(e){hi||(Ci(),hi=a(),s(fi,hi)),I(e,hi)}function Mi(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Vi(t,a,n){const r={}
r.callback=n,r.player=Nn(a),function(t){t.combatEvaluatorBias=e.combatEvaluatorBias,t.attackVariable=1.1053,t.generalVariable=e.generalVariable,t.hpVariable=e.hpVariable}(r),r.creature=Mi(t.response.data,r.player.superEliteSlayerMultiplier),function(e){ii(e),Zo(e),ni(e),oi(e),Xo(e),Qo(e),ai(e)}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${function(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(e){return e.callback.groupExists?"Group ":""}(e)}Combat Evaluation</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${function(e){return e.hitByHowMuch>0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${function(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}(e)}</tbody></table>`}(r),n.groupExists?Di(r.evaluatorHTML):Li(r.evaluatorHTML)}function Ai(e){return e.members[0].name===d()}function Si(e){if(m(e.r))return e.r.find(Ai).id}function Bi(e,t,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Vi(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Hi(e,t,a){a&&Yo(a).then(l(Bi,e,t))}function $i(e,t){e.player.hasGroup&&function(e,t){Ko().then(Si).then(l(Hi,e,t))}(e,t),Vi(e,t,{groupExists:!1})}function Ni(e,t){ci||(ci=n("dialog-viewcreature")),ci&&(Li(""),Di(""),function(e){return e.response&&e.response.data}(t)&&(ki(t.response.data.name,ci),Ce(!0).then(l($i,t))))}function Gi(){const t=[,[e.buffs,e.buffsName],[e.buffs2,e.buffs2Name],[e.buffs3,e.buffs3Name]][e.enabledHuntingMode]
m(t)&&([mi,pi]=t)}function xi(t){"enabledHuntingMode"===t.target.name&&(e.enabledHuntingMode=t.target.value,v("enabledHuntingMode",e.enabledHuntingMode),Gi(),GameData.fetch(h))}function Ti(e){const t=ne("verbs",e)
1===t.length&&_(t[0])}function Ei(){if(!bi)return
const e=n("actionList")
L("player",e).forEach(Ti)}const Pi={hideSubLvlCreature:function(){e.hideSubLvlCreature=!e.hideSubLvlCreature,v("hideSubLvlCreature",e.hideSubLvlCreature),GameData.fetch(H)},hidePlayerActions:function(){bi=!bi,v("hidePlayerActions",bi),GameData.fetch(H)},showCreatureInfo:function(){e.showCreatureInfo=!e.showCreatureInfo,v("showCreatureInfo",e.showCreatureInfo)},showHuntingBuffs:function(){e.showBuffs=!e.showBuffs,v("showHuntingBuffs",e.showBuffs),GameData.fetch(h)},showMonsterLog:function(){e.showMonsterLog=!e.showMonsterLog,v("showMonsterLog",e.showMonsterLog)},showTitanInfo:function(){e.showTitanInfo=!e.showTitanInfo,v("showTitanInfo",e.showTitanInfo),Lo(GameData.realm().dynamic)},showBuffInfo:function(){e.showBuffInfo=!e.showBuffInfo,v("showBuffInfo",e.showBuffInfo),Wt()}}
function Fi(e){const t=Pi[e.target.name]
M(t)&&(e.target.blur(),t(e))}function Ri(){const e=a({className:"fshCenter fshFten"}),t=a({id:"fshWorldPrefs",innerHTML:`${Pe("showCreatureInfo")}&nbsp;&nbsp;${Pe("showMonsterLog")}&nbsp;&nbsp;${Pe("showTitanInfo")}&nbsp;&nbsp;${Pe("showBuffInfo")}<br>${Pe("hideSubLvlCreature")}&nbsp;&nbsp;${Pe("hidePlayerActions")}&nbsp;&nbsp;${at()}`})
f(t,Fi),T(t,"change",xi),s(e,t)
const r=a()
s(e,r)
const o=n("worldContainerBelow").children[0]
return x(e,o),r}function Oi(e,t){return e[t.name]=!0,e}function Ii(e,t,a){return e[a.trim()]||t.push(a),t}function _i(e){I("",e)}function ji(e,t){const a=t.b.reduce(Oi,{}),n=mi.reduce(l(Ii,a),[])
n.length>0?function(e,t){I(`You are missing some ${pi} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):_i(e)}function qi(t,a,n){mi&&function(t,a,n){e.showBuffs?ji(t,n):_i(t)}(t,0,n)}const Yi=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function Ki(){var t
e.combatEvaluatorBias=y("combatEvaluatorBias"),e.generalVariable=(t=e.combatEvaluatorBias,Yi[t]?Yi[t].generalVariable:1.1053),e.hpVariable=function(e){return Yi[e]?Yi[e].hpVariable:1.1}(e.combatEvaluatorBias)}function zi(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function Ui(e){const t=Le(e)
return function(e){return!e||!e.actions||0===e.actions.length}(t)?e:(t.actions=t.actions.filter(l(zi,function(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}(t))),JSON.stringify(t))}function Wi(t,a){e.hideSubLvlCreature&&function(e){return e.data&&e.data.d&&Qe(e.data.d,H)}(a)&&(t.dataFilter=Ui)}function Qi(t){e[t[0]]=De(t[1])}function Ji(t){e[t]=De(t)}function Xi(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(Qi),["doNotKillList"].forEach(Ji)}function Zi(t){e[t[0]]=y(t[1])}function es(t){e[t]=y(t)}function ts(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(Zi),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(es)}function as(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const ns=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function rs(e,t){var a
y(e)&&(a=t+1,$.subscribe(A,l(as,a)),as(t+1))}function os(e,t){"ACT_REPAIR"===t&&GameData.fetch(Se+h+B+H)}function is(e){E(e.target)}const ss=[function(){Ki(),Xi(),ts()
const t=Ri()
$.ajaxPrefilter("JSON",Wi),e.hideSubLvlCreature&&GameData.fetch(H),function(t){Gi()
const a=l(qi,t)
$.subscribe(p,a),e.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(t),bi=y("hidePlayerActions"),$.subscribe(A,Ei),Ei()},Ve,function(){$.subscribe(ke,Ni)},function(){ns.forEach(rs)},function(){y("enableCreatureColoring")&&s(document.body,Oe("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(A,sa),sa(),function(){const e=GameData.doAction
GameData.doAction=ca(e)}()},function(){w("fsh_monsterLog").then(Fo),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",jo),jo()},function(){$.subscribe(Ae,os)},function(){y("keepLogs")&&w("fsh_combatLog").then(ra)},function(){window.initialGameData&&Mo(0,window.initialGameData),$.subscribe(`${ge} ${ve}`,Mo)},function(){$.subscribe(ye,Ho)},function(){$.subscribe(Q,ir)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){E("#mapTooltip")},function(){$a(),$.subscribe(N,Na),$.subscribe(G,Ga)},function(){Wt(),$.subscribe(`${p} ${b}`,Wt),$.subscribe(g,Qt)},function(){f(n("buffList"),is)},function(){T(n("actionList"),"mouseover",Ar)}]
function us(){Me(ss),$.subscribe(k,da)}export default function(){Be()&&n("worldPage")&&window.GameData&&us()}
//# sourceMappingURL=injectWorld-bb36fc0f.js.map
