import{c as e,k as t,x as a,y as n,f as r,s as o,i,o as s,ae as u,M as l,af as c,ag as f,ah as d,X as m,D as h,ai as p,A as b,aj as g,ak as v,al as y,I as w,am as k,an as C,ao as L,ap as D,e as M,aq as A,ar as V,as as S,at as H,z as B,au as N,a0 as G,R as x,u as T,ab as E,a1 as j,av as P,aw as F,L as R,t as O,N as I,ax as _,ay as q,az as Y,aA as z,a as K,F as U,aB as Q,aC as W,aD as J,aE as X,aF as Z,aG as ee,aH as te,T as ae,a3 as ne,aI as re,a7 as oe,aJ as ie,aK as se,aL as ue,n as le,aM as ce,aN as fe,aO as de,aP as me,aQ as he}from"./calfSystem-5545a3e6.js"
import{n as pe}from"./numberIsNaN-0d2994c6.js"
import{r as be}from"./round-aab1479f.js"
import{r as ge}from"./roundToString-199787f3.js"
import{p as ve}from"./playerName-546a1209.js"
import{c as ye}from"./createInput-836d9f1f.js"
import{i as we}from"./insertTextBeforeEnd-5a32dd2a.js"
import"./testRange-f08fd681.js"
import{t as ke}from"./testQuant-36a679f9.js"
import{a as Ce}from"./addCommas-757dfba4.js"
import{c as Le}from"./createLabel-062664fb.js"
import"./currentGuildId-2b105bba.js"
import"./intValue-02f9213d.js"
import{v as De}from"./valueText-3403f71f.js"
import"./fshOpen-04e3fd62.js"
import{o as Me}from"./openQuickBuffByName-790a8d74.js"
import"./createUl-4ac3809c.js"
import{g as Ae,s as Ve}from"./idb-ab1a88c6.js"
import{i as Se}from"./insertElementBefore-babbeb6f.js"
import"./isChecked-ae232d81.js"
import{b as He}from"./simpleCheckbox-16914843.js"
import{c as $e}from"./createTable-b1e7ce39.js"
import{p as Be}from"./padZ-d6df3a69.js"
import{c as Ne}from"./createButton-8ad42cc5.js"
import"./createLi-721e020f.js"
import{c as Ge}from"./createStyle-b74477ed.js"
import{c as xe}from"./createSpan-2a3ac8a5.js"
import{h as Te}from"./hideElement-f7434a50.js"
import{a as Ee}from"./all-d45d8a77.js"
import{a as je}from"./allthen-d56c46ae.js"
import{g as Pe}from"./getArrayByClassName-8790cbe5.js"
import"./rnd-f854f242.js"
import{f as Fe}from"./fetchdata-1d88ff25.js"
import"./indexAjaxJson-06c0d970.js"
import"./csvSplit-cc97bdc6.js"
import{s as Re}from"./shouldBeArray-6cd3cc6c.js"
import{e as Oe}from"./eventHandler5-ffda34ea.js"
import"./cmdExport-2a172ff1.js"
import{t as Ie}from"./toggleForce-c71db530.js"
import{h as _e}from"./hasClasses-844cde85.js"
import{i as qe}from"./insertElementAfter-a43cfe0f.js"
import{g as Ye}from"./getProfile-462e8b38.js"
import{m as ze}from"./myStats-f536bf5b.js"
import{g as Ke}from"./guild-1eee44a3.js"
import"./isSelected-59502831.js"
import{g as Ue}from"./getMembrList-964e1c8b.js"
import{d as Qe,g as We}from"./getGroupStats-7437e673.js"
import"./groupViewStats-6c958ecc.js"
import{g as Je}from"./getMercStats-778dd896.js"
import{b as Xe}from"./bitwiseAnd-f9f5f07e.js"
import{r as Ze}from"./reduceBuffArray-46549e25.js"
import{g as et,a as tt}from"./getTitanString-e54665a0.js"
import{d as at,q as nt}from"./quickbuffSuccess-5795a7dc.js"
import{a as rt}from"./huntingBuffs-aca3d2f6.js"
let ot,it,st,ut,lt,ct,ft,dt,mt
function ht(e){return e}function pt(n){if(function(t){return e.showBuffInfo&&t.some(ht)}(n))return function(){if(ot)Ie(ot,!1)
else{ot=t({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const e=a("actionContainer")
qe(ot,e.children[2])}return ot}()
ot&&Ie(ot,!0)}function bt(e,t){it?Ie(it,!1):function(e){it=e.children[3],it.className="fshBlue",n("CA ",it),st=xe(),r(it,st),we(it," active")}(e),n(t.level,st)}function gt(e,t){t?bt(e,t):it&&Ie(it,!0)}function vt(e,t){ut?Ie(ut,!1):function(e){ut=e.children[4],ut.className="fshRed",n("Doubler ",ut),lt=xe(),r(ut,lt),we(ut," active")}(e),n(t.level,lt)}function yt(e,t){t?vt(e,t):ut&&Ie(ut,!0)}function wt(e,t,a){ct?Ie(ct,!1):function(e){ct=e.children[2],n("Damage bonus: ",ct),ft=xe(),r(ct,ft),we(ct,"%")}(e),n(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return be(a,2).toString()}return"0"}(t,Number(a)),ft)}function kt(e,t,a){t?wt(e,t,a):ct&&Ie(ct,!0)}function Ct(e,t){n(Ce(e),t)}function Lt(e,t){dt?Ie(dt,!1):function(e){dt=e.children[1],n("Kill Streak: ",dt),mt=xe(),r(dt,mt)}(e),Ct(t,mt)}function Dt(e,t,a,n){t||a?Lt(e,n):dt&&Ie(dt,!0)}function Mt(e,t){return t.name===e}function At(e){const{buffs:t}=GameData.player()
if(t)return t.find(o(Mt,e))}const Vt=["red","orange","yellow"]
let St,Ht
function $t(e){nt(e)&&GameData.fetch(u)}function Bt(){At("Summon Shield Imp")||at([ve()],[55]).then($t)}const Nt=["imp-0","imp-1","imp-1"]
function Gt(e,t){St?Ie(St,!1):function(e){St=e.children[0],n("Shield Imps Remaining: ",St),Ht=xe(),r(St,Ht),i(St,"&nbsp;")
const t=xe({className:"xSmallLink",textContent:"Recast"})
r(St,t),s(t,Bt)}(e)
const a=function(e){return e?Number(e.stack):0}(t)
St.className=function(e){return Nt[e]||"fshGreen"}(a),n(a,Ht)}function xt(e,t,a){t||a?Gt(e,t):St&&Ie(St,!0)}function Tt(e){return 0===e.type}function Et(e){return xe({textContent:e})}let jt,Pt,Ft,Rt,Ot,It,_t,qt,Yt,zt
function Kt(e,t){jt?Ie(jt,!1):function(e,t){jt=e.children[5],n("Teleport Cooldown: ",jt),Pt=Et(t.toString()),r(jt,Pt)}(e,t)}function Ut(){const e=Math.max(Math.ceil((Ft-Date.now())/1e3),0)
n(e,Pt),e>0&&setTimeout(Ut,500)}function Qt(e,t){t?Kt(e,t):jt&&Ie(jt,!0)}function Wt(){Rt=At("Death Dealer"),Ot=At("Doubler"),It=At("Counter Attack"),_t=At("Summon Shield Imp"),qt=function(){const e=GameData.player().teleportCooldown
return e>1&&e}(),Yt=function(){const{dynamic:e}=GameData.realm()
return l(e)&&e.some(Tt)}(),zt=GameData.player().killStreak}function Jt(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",Vt[e.text()]||"#ad8043")}(),Wt()
const e=pt([Rt,Ot,It,_t,qt,Yt])
e&&(xt(e,_t,Rt),Dt(e,Rt,Yt,zt),kt(e,Rt,zt),gt(e,It),yt(e,Ot),Qt(e,qt))}function Xt(e,t){var a
a=t.player.teleportCooldown,Pt&&(Ft=Date.now()+1e3*a,Ut())}const Zt=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let ea,ta=[]
function aa(e){54!==e.id&&26!==e.id||(ea.player.buffs[e.id]=parseInt(e.level,10))}function na(e){-1===Zt.indexOf(e.name)&&(ea.player.enhancements[e.name]=e.value)}function ra(e,t){ea={},ea.combat=t.response.data,ea.combat.inventory_id&&(ea.combat.drop=ea.combat.item.id),ea.player={},ea.player.buffs={},ea.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(aa)}(t),function(e){e.player.enhancements&&e.player.enhancements.forEach(na)}(t),ea.time=t.time,ta.push(ea),Ve("fsh_combatLog",ta)}function oa(e,t){0===t.response.response&&ra(0,t)}function ia(e){e&&(ta=e),$.subscribe(p,oa)}function sa(t){return e.doNotKillList.includes(t.trim())}function ua(e){e.classList.toggle("fshBlue",sa(b(e)))}function la(){const e=a("actionList")
Pe("creature",e).forEach(ua)}function ca(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(sa(e))return a("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const fa={2:function(e){return function(t,a,n,r){ca(n.passback)||e(t,a,n,r)}}}
function da(e){return function(t,a,n,r){const o=fa[t];(function(e){return e&&g(e)})(o)&&function(e){return v(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function ma(e){e.remove()}function ha(e,t){!function(e){(function(e){return e.response&&e.response.msg&&e.response.msg.startsWith("Creature did not exist at that location")})(e)&&GameData.fetch(k+C)}(t),w(".creature-4 > .quickCombat > .verbs").forEach(ma)}function pa(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function ba(e,t,a){return Le({className:"fshCurveEle fshCurveLbl fshPoint tip-static "+e,dataset:{tipped:t},htmlFor:a})}function ga(e){const a=t({className:"fshToggle"}),n=ye({checked:e.prefVal,id:e.checkId,type:"checkbox"})
r(a,n)
const o=ba(e.onClass,e.onTip,e.checkId)
r(a,o)
const i=ba(e.offClass,e.offTip,e.checkId)
return r(a,i),r(e.worldName,a),n}let va,ya,wa,ka,Ca,La,Da,Ma,Aa
function Va(e){return e?e.toString():"?"}function Sa(e){const a=t({className:"fshFsty"})
r(a,function(){const e=t({textContent:"Min Lvl: "})
return ya=Et(Va(GameData.realm().minlevel)),r(e,ya),e}()),r(a,function(){const e=t({textContent:"Your Lvl: "})
return wa=Et(Va(GameData.player().level)),r(e,wa),e}()),r(e,a)}function Ha(e,t,a){const n=Ne({className:"fshCurveEle fshCurveBtn fshPoint tip-static "+e,dataset:{tipped:t}})
return r(a,n),n}function $a(){var t
Sa(t=va),ka=Ha("fshFormGroup","Quick Create Attack Group",t),Ca=Ha("fshQuickBuff","Open Quick Buff Popup",t),La=Ha("fshRealmMap","Open Realm Map",t),Da=Ha("fshTempleOne","Search map in Ultimate FSG",t),function(e){if(h("showSpeakerOnWorld")){const t=h("playNewMessageSound")
Ma=ga({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(va),function(t){const a=e.huntingMode
Aa=ga({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:t})}(va)}const Ba=[[e=>e===Ma,function(){m("playNewMessageSound",!h("playNewMessageSound"))}],[e=>e===Aa,function(){e.huntingMode=!e.huntingMode,m("huntingMode",e.huntingMode)}]],Na=[[e=>e===ka,function(e){A(e),GameData.doAction(12,401,{},0)}],[e=>e===Ca,function(){Me(ve())}],[e=>e===La,function(){window.open(V+S+"map","fsMap")}],[e=>e===Da,function(){const e=GameData.realm()
window.open(`${H}realms${S}view&realm_id=${e.id}`,"mapUfsg")}]]
function Ga(){va||(va=t({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),$a(),s(va,Oe(Na)),M(va,"change",Oe(Ba)),Se(va,a("worldCoord")))}function xa(e,t){ya&&t.b.minlevel&&(pa(),n(t.b.minlevel,ya))}function Ta(e,t){wa&&n(t.b,wa)}function Ea(e){return!e||!e.response||!e.response.data}let ja,Pa,Fa,Ra,Oa,Ia,_a,qa,Ya,za,Ka,Ua,Qa,Wa,Ja,Xa,Za,en,tn,an,nn,rn,on,sn,un,ln,cn,fn,dn,mn,hn,pn,bn,gn,vn
function yn(e){return e.player_name}function wn(e){!function(e){Ra=e.defenders.map(yn)}(e),ja?B("",ja):ja=t({className:"body"}),function(e){Pa=t({className:"fshFloatLeft fshRelicLeftDiv"}),r(ja,Pa),e.is_owner&&r(Pa,Qe(Ra)),Fa=Ne({className:"custombutton",textContent:"Fetch Stats"}),r(Pa,Fa)}(e)
const n=a("dialog-relic")
r(n,ja)}const kn=[e=>"lastUpdate"!==e,e=>!Ra.includes(e),e=>Oa[e].last_login,e=>Number(Oa[e].last_login)<Ia,e=>Number(Oa[e].last_login)>_a,e=>Oa[e].level<400||Oa[e].level>421,e=>Oa[e].level<441||Oa[e].level>450]
function Cn(e,t){return t(e)}function Ln(e){return kn.every(o(Cn,e))}function Dn(e){return`<a href="${G}${Oa[e].id}">${e}</a>`}function Mn(e){Oa=e,Ia=x-120,_a=x-604800
const t=N(Oa).filter(Ln).map(Dn)
i(ja,'<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>'+t.length.toString()+" Offline guild members not at relic:</th></tr></thead>"+`<tbody><tr><td>${t.join(" ")}</td></tr></tbody></table></div>`)}function An(e){Te(Fa)
const n=h("hideRelicOffline")
e.is_owner&&!n&&Ue(!0).then(Mn),i(Pa,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),vn=a("ProcessingStatus")
const o=t({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
r(ja,o),qa=a("relicCount"),Ya=a("LDPercentage"),za=a("LDCloaked"),Ka=a("attackValue"),Ua=a("attackValueBuffed"),Qa=a("defenseValue"),Wa=a("defenseValueBuffed"),Ja=a("armorValue"),Xa=a("armorValueBuffed"),Za=a("damageValue"),en=a("damageValueBuffed"),tn=a("hpValue"),an=a("hpValueBuffed"),nn=a("defendersCloaked"),rn=a("defendersProcessed")
const s=t({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
r(ja,s),on=a("DC225"),sn=a("DC175"),un=a("GroupAttack"),ln=a("GroupAttackBuffed"),cn=a("GroupDefense"),fn=a("GroupDefenseBuffed"),dn=a("GroupArmor"),mn=a("GroupArmorBuffed"),hn=a("GroupDamage"),pn=a("GroupDamageBuffed"),bn=a("GroupHP"),gn=a("GroupHPBuffed")}let Vn
function Sn(e){const t=T(e),a=E('#pCC img[src*="/relics/"]',t).length
var r
n(a,qa),Vn=1===(r=a)?1.5:be(1-r/10,2),n(String(100*Vn)+"%",Ya)}function Hn(e,t){return e>10*t||e<t?e:10*t}const $n=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Bn(e,t,a){e[a[0]]=Number(t[a[1]])}const Nn=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function Gn(e,t,a){e[a[0]]=t[a[1]]||0}function xn(e){const t=Ze(e._skills),a={}
return function(e,t){$n.forEach(o(Bn,e,t))}(a,e),function(e,t){Nn.forEach(o(Gn,e,t))}(a,t),a.superEliteSlayerMultiplier=be(.002*a.superEliteSlayerLevel,2),pe(a.armorValue)&&function(e){e.attackValue=Hn(e.attackBonus,e.levelValue),e.defenseValue=Hn(e.defenseBonus,e.levelValue),e.armorValue=Hn(e.armorBonus,e.levelValue),e.damageValue=Hn(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}let Tn,En,jn,Pn,Fn,Rn,On,In,_n,qn,Yn,zn,Kn,Un
function Qn(e){return Math.round(e*Vn)}function Wn(){Ct(Tn,Ka),Ct(jn,Qa),Ct(Pn,Ja),Ct(Fn,Za),Ct(On,tn),n(In,nn),_n+=1,n(_n,rn)}function Jn(e){const t=function(e){return Math.ceil(Yn.attack*(.0025*j(e["Nightmare Visage"],0)))}(e)
Yn.attack-=t,function(){const e=Math.ceil(Yn.attack*qn.flinchLevel*.001)
Ct(Yn.attack-e,ln)}()
const a=function(e){return Math.ceil(Yn.defense*(1+.001*j(e.Constitution,0)))}(e)
Ct(a+t,fn),function(e){Ct(Yn.armor+Math.floor(Yn.armor*j(e.Sanctuary,0)*.001),mn)}(e)
const n=function(e,t){return Math.ceil(t*j(e.Fortitude,0)*.001)}(e,a)
!function(e){Ct(Yn.hp+e,gn)}(n),function(e,t){const a=Math.ceil((Yn.hp+t)*j(e["Chi Strike"],0)*.001),n=Math.ceil(Yn.damage*qn.terrorizeLevel*.001)
Ct(Yn.damage+a-n,pn)}(e,n)}function Xn(){n("Processing attacking group stats ... ",vn),zn&&(Yn.attack-=zn.attack,Yn.defense-=zn.defense,Yn.armor-=zn.armor,Yn.damage-=zn.damage,Yn.hp-=zn.hp),Ct(Yn.attack,un),Ct(Yn.defense,cn),Ct(Yn.armor,dn),Ct(Yn.damage,hn),Ct(Yn.hp,bn)
const e=Ze(GameData.player().buffs)
Jn(e),function(e){const t=Math.ceil(En*j(e.Flinch,0)*.001)
Ct(En-t,Ua)}(e),function(e){const t=Math.ceil(Rn*j(e.Terrorize,0)*.001)
Ct(Rn-t,en)}(e),n("Done.",vn)}function Zn(){n("Processing defending guild stats ... ",vn),Tn+=Qn(qn.attackValue),jn+=Qn(qn.defenseValue),Pn+=Qn(qn.armorValue),Fn+=Qn(qn.damageValue),On+=Qn(qn.hpValue),Wn()
const e=Math.ceil(Tn*(.0025*qn.nightmareVisageLevel))
!function(e){En=Tn-e,Ct(En,Ua)}(e)
const t=Math.ceil(jn*(1+.001*qn.constitutionLevel))
!function(e,t){const a=t+e
Ct(a,Wa),Ct(Math.ceil(.55*a),on),Ct(Math.ceil(.65*a),sn)}(e,t),Ct(Pn+Math.floor(Pn*qn.sanctuaryLevel*.001),Xa)
const a=On+function(e){return Math.ceil(e*qn.fortitudeLevel*.001)}(t)
Ct(a,an),function(e){Rn=Fn+Math.ceil(e*qn.chiStrikeLevel*.001),Ct(Rn)}(a),0!==qn.cloakLevel&&n("Yes",za),GameData.player().hasGroup&&Yn?Xn():n("Done.",vn)}function er(e){const t=xn(e)
Tn+=Math.round(t.attackValue*P),jn+=Math.round(t.defenseValue*P),Pn+=Math.round(t.armorValue*P),Fn+=Math.round(t.damageValue*P),On+=Math.round(t.hpValue*P),0!==t.cloakLevel&&(In+=1),Wn()}function tr(e){qn=xn(e)}function ar(e){Yn=e}function nr(e){zn=e}function rr(e){n(e.message,vn)}function or(e){const t=T(e),a=I('#pCC a[href*="confirmDisband"]',t)
if(!a)return
const n=function(e){const t=e.previousElementSibling.href,a=[We(t).then(ar)]
return function(e){return-1!==e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(e)&&a.push(Je().then(nr)),a}(a)
return Ee(n)}function ir(e,t){return 0===t?Ye(e).then(tr):Ye(e).then(er).catch(rr)}function sr(){let e=[O({cmd:"guild",subcmd:"view",guild_id:Kn.controlled_by.guild_id}).then(Sn)]
return GameData.player().hasGroup&&e.push(O({cmd:"guild",subcmd:"groups"}).then(or)),e=e.concat(Ra.map(ir)),e}function ur(){An(Kn),Tn=0,jn=0,Pn=0,Fn=0,On=0,In=0,_n=0
const e=sr()
je(e,Zn)}function lr(e,t){Ea(t)||(Kn=t.response.data,Kn.defenders.length>0&&(wn(Kn),R(Fa,"click",ur)))}function cr(e){$("#statbar-gold").css("background-color",e)}function fr(){$("#HelperSendTotal").html(Ce(h("currentGoldSentTotal"))),Number(GameData.player().gold)>Un?cr("red"):cr("inherit")}function dr(){Un=h("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${h("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${Ce(Un)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${Ce(h("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",Y),fr(),$.subscribe(z,fr)}const mr=[]
function hr(e){return Ea(e)||mr.push(e),e}function pr(e,t){return e===Number(t.response.data.id)}function br(e,t){e(t)}function gr(e,t){const a=mr.find(o(pr,e))
return a?function(e){return new Promise(t=>{K(3,br,[t,e])})}(a):Fe({a:1,id:e,passback:t}).then(hr)}let vr,yr,wr,kr,Cr,Lr
function Dr(e,t){return De(U(t,e))}function Mr(){var e
vr=GameData.player().level,e=a("statbar-character-tooltip-stats"),wr=Dr(e,Z),yr=Dr(e,Q),Cr=Dr(e,W),kr=Dr(e,J),Lr=Dr(e,X)}function Ar(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function Vr(e,t,a){return function(e){return`<table><tr><td><img src="${ee}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(e)+function(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${vr}</span>)</td></tr>`}(e,a)+function(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${yr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${wr}</span>)</td></tr>`}(e)+function(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${kr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${Cr}</span>)</td></tr>`}(e)+function(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${Lr}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}(e,t)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(Ar).join("")}(e)+function(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}(e)}function Sr(t){if(!Ea(t))return function(t){const a=Math.ceil(t.hp*e.hpVariable+t.armor*e.generalVariable)
let n="fshYellow"
return Mr(),vr>t.level&&(n="fshRed"),Vr(t,a,n)}(t.response.data)}const Hr=["verb","view","tip-static"]
function $r(e,t){const a=Sr(t)
e.set("content.text",a)}function Br(e,t,a){return gr(GameData.actions()[e].data.id,e).then(o($r,a)),"Loading..."}function Nr(e,t){ae("NewMap","CreatureInfo")
const a=ne((n=t).parentNode.children).indexOf(n)
var n,r,i
e.classList.add("fshTip"),r=e,i=o(Br,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:i},hide:{effect:!1}})}function Gr(t){if(!e.showCreatureInfo)return
const{target:a}=t,n=a.parentNode.parentNode.parentNode;(function(e,t){return _e(Hr,e)&&!te("fshTip",e)&&te("creature",t)})(a,n)&&Nr(a,n)}function xr(){return Ke({subcmd:"scouttower"})}function Tr(e,t){const a=e.insertCell(-1)
return[a.colSpan]=t,t[2]&&(a.className="header"),r(a,t[1]),a}function Er(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(o(Tr,e))}(n,t),n}function jr(e,t){Er(e,t[0],t[1])}function Pr(e,t){t.forEach(o(jr,e))}let Fr,Rr,Or,Ir,_r,qr,Yr,zr,Kr,Ur,Qr,Wr,Jr,Xr,Zr,eo,to,ao,no,ro,oo,io,so,uo,lo,co,fo,mo
function ho(){Rr=Et("Current"),Or=Et("Kills"),Ir=Et("Member"),_r=Et("% of Total"),qr=Et("Status"),Yr=Et("Titan HP"),zr=Et("Total"),Kr=Et("Your Guild")}function po(){for(;to.rows.length>7;)to.deleteRow(7)}function bo(){const e=xe()
return r(e,Ur),we(e,"/"),r(e,Qr),e}function go(e){const t=xe()
return r(t,e),we(t,"%"),t}function vo(){no=null,ao&&!ao.classList.contains("fshHide")&&(Ie(ao,!0),n("",Ur),n("",Qr),n("",Wr),n("",Jr),n("",Xr),B("",Zr),B("",eo),po())}function yo(e){return 0===e.type&&(no=e.base_creature_id,!0)}function wo(){if(ao)Ie(ao,!1)
else{const e=a("actionContainer")
ao=t({className:"fshActionBox titanInfo"}),Ur=xe(),Qr=xe(),Wr=xe(),Jr=xe(),Xr=xe(),Zr=xe(),eo=xe(),to=$e({className:"fshCenter"}),ho(),Pr(to,[[[[2,Yr,!0],[4,Kr,!0]]],[[[2,bo()],[4,Wr]]],[[[2,Rr,!0],[4,go(Jr)]],!0],[[[2,zr,!0],[4,go(Xr)]],!0],[[[2,qr,!0],[4,Zr]],!0],[[[6,eo]]],[[[2,Ir,!0],[2,Or,!0],[2,_r,!0]]]]),r(ao,to),r(e,ao)}}function ko(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(oe+1e3*e)
return`${Be(t.getHours())}:${Be(t.getMinutes())} ${Be(t.getDate())}/${re[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function Co(e){n(e.current_hp,Ur),n(e.max_hp,Qr),n(e.kills,Wr),n(function(e){return ge(et(e.max_hp-e.current_hp,e.kills),2)}(e),Jr),n(function(e){return ge(100*e.kills/e.max_hp,2)}(e),Xr),B(function(e){return tt(e.kills,e.max_hp,e.current_hp)}(e),Zr),B(ko(e.cooldown),eo)}function Lo(e,t){return[[[2,Et(t.player.name)],[2,Et(t.kills.toString())],[2,Et(ge(100*t.kills/e.kills,2)+"%")]]]}function Do(e){return e.realm&&e.creature.base_id===no&&e.realm===Fr}function Mo(e){const t=e.find(Do)
t&&(Co(t),function(e){if(po(),!e.contributors)return
const t=e.contributors.map(o(Lo,e))
Pr(to,t)}(t))}function Ao(t){return e.showTitanInfo&&l(t)&&t.some(yo)}function Vo(e,t){(function(e){return e.s&&l(e.r)})(t)&&(Mo(t.r),Ao(GameData.realm().dynamic)?ro=window.setTimeout(e,3e4):vo())}function So(){xr().then(o(Vo,So))}function Ho(e){ro&&(window.clearTimeout(ro),ro=null),Ao(e)?(wo(),So()):vo()}function $o(e){var t
e.dynamic&&(t=e.name,Fr=t,Ho(e.dynamic))}function Bo(e,t){(function(e){return e.realm&&e.realm.name})(t)&&$o(t.realm)}function No(e){const t=e.response.response,a=e.response.msg
let n
if(0!==t){const e=a.indexOf("<")
n=-1!==e?a.substring(0,e):a}else n=`You purchased ${e.response.data.name} for ${Ce(e.response.data.cost)} gold.`
i(fo,n+"<br>")}function Go(){GameData.doAction(14,3,{id:oo.id,item_id:oo.itemId},0),so.close()}function xo(){const e=ke(lo.value)
if(!e)return
const t=[]
for(let a=1;a<e;a+=1)t.push(Fe({a:14,d:0,id:oo.id,item_id:oo.itemId}).then(No))
je(t,Go)}function To(){uo?n("",fo):(uo=t({className:"fshClear",textContent:"Select how many to quick-buy:"}),lo=ye({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),r(uo,lo),co=Ne({textContent:"Quick-buy"}),s(co,xo),r(uo,co),fo=t(),r(uo,fo),r(io,uo))}function Eo(e,t){oo=t,io=io||a("shopDialogConfirm"),io&&(so=so||$(io).data("hcsWorldDialogShopConfirm"),so&&To())}function jo(e){mo[e.name]?mo[e.name].seen&&(mo[e.name].seen+=1):(mo[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,mo[e.name]))}function Po(e,t,a){return t?e(t,a):a}function Fo(e,t){const a=e||{}
return a.min=Po(Math.min,a.min,t),a.max=Po(Math.max,a.max,t),a}const Ro=["attack","armor","damage","defense","hp"]
function Oo(e,t,a){const n=Fo(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function Io(e,t){e[t.name]=Fo(e[t.name],Number(t.value))}function _o(e){mo||(mo={}),jo(e),function(e,t){Ro.forEach(o(Oo,e,t))}(e,mo[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(o(Io,t.enhancements)))}(e,mo[e.name]),Ve("fsh_monsterLog",mo)}function qo(e){mo=e||{}}const Yo=[]
function zo(t){var a
Ea(t)||(ae("NewMap","MonsterLog"),a=t.response.data,e.showMonsterLog&&_o(a))}function Ko(e,t){return e.id===t.id}function Uo(e,t){6!==e.type||function(e){if(Yo.find(o(Ko,e.data)))return!0
Yo.push(e.data)}(e)||gr(e.data.id,t).then(zo)}function Qo(){e.showMonsterLog&&GameData.actions().forEach(Uo)}function Wo(e){return Ke(le({subcmd:"groups"},e))}function Jo(e){return function(e){return Wo({subcmd2:"viewstats",group_id:e})}(e)}function Xo(){return Wo({subcmd2:"view"})}function Zo(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const ei=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>"Player 1 hits"+Zo(e)],[e=>e.playerHits>1,e=>"Player > 1 hits"+Zo(e)]]
function ti(e,t){return t[0](e)}function ai(e){e.playerHits=function(e){return"-"===e.numberOfCreatureHitsTillDead?e.numberOfHitsRequired:function(e){return"-"===e.numberOfHitsRequired||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}(e)?"-":e.numberOfHitsRequired}(e),e.creatureHits=function(e){return"-"===e.numberOfHitsRequired?e.numberOfCreatureHitsTillDead:function(e){return"-"===e.numberOfCreatureHitsTillDead||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}(e)?"-":e.numberOfCreatureHitsTillDead}(e),e.fightStatus=function(e){const t=ei.find(o(ti,e))
return t?t[1](e):"Unknown"}(e)}function ni(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function ri(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),ni(e)}function oi(e){const t=function(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${Math.floor(e.creature.defense*e.player.darkCurseLevel*.002)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-e.creature.defense*e.player.darkCurseLevel*.002
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}function ii(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function si(e){ii(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function ui(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&si(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){ii(e),function(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==e.lowestCALevelToStillHit&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}(e),function(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==e.lowestCALevelToStillKill&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(e)}(e)}function li(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e)
const t=function(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}(e)
if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}function ci(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function fi(e){e.overallDefenseValue=ci(e)+Math.floor(ci(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(ci(e)*e.player.constitutionLevel*.001)}<br>`)}(e),function(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function di(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}let mi,hi,pi,bi,gi,vi,yi,wi,ki,Ci
function Li(){return sa(hi)?"Remove from do not kill list":"Add to the do not kill list"}function Di(){n(Li(),pi)}function Mi(){const t=e.doNotKillList.indexOf(hi);-1===t?e.doNotKillList.push(hi):e.doNotKillList.splice(t,1),Di(),m("doNotKillList",e.doNotKillList.join()),la()}function Ai(){pi?Di():function(){pi=Ne({className:"fshBl",textContent:Li(),type:"button"})
const e=t({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
r(e,pi),r(mi,e),s(pi,Mi)}()}function Vi(e,t){!function(e){if(!mi){const t=U("body",e)
1===t.length&&([mi]=t)}}(t),mi&&(hi=e.trim(),Ai())}function Si(){vi||(gi||(gi=t(),r(bi,gi),r(bi,t({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),vi=t(),r(gi,vi))}function Hi(e){Si(),B(e,vi)}function $i(e){yi||(Si(),yi=t(),r(gi,yi)),B(e,yi)}function Bi(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Ni(t,a,n){const r={}
r.callback=n,r.player=xn(a),function(t){t.combatEvaluatorBias=e.combatEvaluatorBias,t.attackVariable=1.1053,t.generalVariable=e.generalVariable,t.hpVariable=e.hpVariable}(r),r.creature=Bi(t.response.data,r.player.superEliteSlayerMultiplier),function(e){di(e),oi(e),li(e),fi(e),ri(e),ai(e),ui(e)}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${function(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(e){return e.callback.groupExists?"Group ":""}(e)}Combat Evaluation</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${function(e){return e.hitByHowMuch>0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${function(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}(e)}</tbody></table>`}(r),n.groupExists?$i(r.evaluatorHTML):Hi(r.evaluatorHTML)}function Gi(e){return e.members[0].name===ve()}function xi(e){if(l(e.r))return e.r.find(Gi).id}function Ti(e,t,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Ni(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Ei(e,t,a){a&&Jo(a).then(o(Ti,e,t))}function ji(e,t){e.player.hasGroup&&function(e,t){Xo().then(xi).then(o(Ei,e,t))}(e,t),Ni(e,t,{groupExists:!1})}function Pi(e,t){bi||(bi=a("dialog-viewcreature")),bi&&(Hi(""),$i(""),function(e){return e.response&&e.response.data}(t)&&(Vi(t.response.data.name,bi),ze(!0).then(o(ji,t))))}function Fi(){const t=[,[e.buffs,e.buffsName],[e.buffs2,e.buffs2Name],[e.buffs3,e.buffs3Name]][e.enabledHuntingMode]
l(t)&&([wi,ki]=t)}function Ri(t){"enabledHuntingMode"===t.target.name&&(e.enabledHuntingMode=t.target.value,m("enabledHuntingMode",e.enabledHuntingMode),Fi(),GameData.fetch(u))}function Oi(e){const t=U("verbs",e)
1===t.length&&Te(t[0])}function Ii(){if(!Ci)return
const e=a("actionList")
Pe("player",e).forEach(Oi)}const _i={hideSubLvlCreature:function(){e.hideSubLvlCreature=!e.hideSubLvlCreature,m("hideSubLvlCreature",e.hideSubLvlCreature),GameData.fetch(C)},hidePlayerActions:function(){Ci=!Ci,m("hidePlayerActions",Ci),GameData.fetch(C)},showCreatureInfo:function(){e.showCreatureInfo=!e.showCreatureInfo,m("showCreatureInfo",e.showCreatureInfo)},showHuntingBuffs:function(){e.showBuffs=!e.showBuffs,m("showHuntingBuffs",e.showBuffs),GameData.fetch(u)},showMonsterLog:function(){e.showMonsterLog=!e.showMonsterLog,m("showMonsterLog",e.showMonsterLog)},showTitanInfo:function(){e.showTitanInfo=!e.showTitanInfo,m("showTitanInfo",e.showTitanInfo),Ho(GameData.realm().dynamic)},showBuffInfo:function(){e.showBuffInfo=!e.showBuffInfo,m("showBuffInfo",e.showBuffInfo),Jt()}}
function qi(e){const t=_i[e.target.name]
g(t)&&(e.target.blur(),t(e))}function Yi(){const e=t({className:"fshCenter fshFten"}),n=t({id:"fshWorldPrefs",innerHTML:`${He("showCreatureInfo")}&nbsp;&nbsp;${He("showMonsterLog")}&nbsp;&nbsp;${He("showTitanInfo")}&nbsp;&nbsp;${He("showBuffInfo")}<br>${He("hideSubLvlCreature")}&nbsp;&nbsp;${He("hidePlayerActions")}&nbsp;&nbsp;${rt()}`})
s(n,qi),M(n,"change",Ri),r(e,n)
const o=t()
r(e,o)
const i=a("worldContainerBelow").children[0]
return Se(e,i),o}function zi(e,t){return e[t.name]=!0,e}function Ki(e,t,a){return e[a.trim()]||t.push(a),t}function Ui(e){B("",e)}function Qi(e,t){const a=t.b.reduce(zi,{}),n=wi.reduce(o(Ki,a),[])
n.length>0?function(e,t){B(`You are missing some ${ki} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):Ui(e)}function Wi(t,a,n){wi&&function(t,a,n){e.showBuffs?Qi(t,n):Ui(t)}(t,0,n)}const Ji=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function Xi(){var t
e.combatEvaluatorBias=h("combatEvaluatorBias"),e.generalVariable=(t=e.combatEvaluatorBias,Ji[t]?Ji[t].generalVariable:1.1053),e.hpVariable=function(e){return Ji[e]?Ji[e].hpVariable:1.1}(e.combatEvaluatorBias)}function Zi(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function es(e){const t=fe(e)
return function(e){return!e||!e.actions||0===e.actions.length}(t)?e:(t.actions=t.actions.filter(o(Zi,function(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}(t))),JSON.stringify(t))}function ts(t,a){e.hideSubLvlCreature&&function(e){return e.data&&e.data.d&&Xe(e.data.d,C)}(a)&&(t.dataFilter=es)}function as(t){e[t[0]]=Re(t[1])}function ns(t){e[t]=Re(t)}function rs(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(as),["doNotKillList"].forEach(ns)}function os(t){e[t[0]]=h(t[1])}function is(t){e[t]=h(t)}function ss(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(os),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(is)}function us(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const ls=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function cs(e,t){var a
h(e)&&(a=t+1,$.subscribe(y,o(us,a)),us(t+1))}function fs(e,t){"ACT_REPAIR"===t&&GameData.fetch(he+u+k+C)}function ds(e){A(e.target)}const ms=[function(){Xi(),rs(),ss()
const t=Yi()
$.ajaxPrefilter("JSON",ts),e.hideSubLvlCreature&&GameData.fetch(C),function(t){Fi()
const a=o(Wi,t)
$.subscribe(c,a),e.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(t),Ci=h("hidePlayerActions"),$.subscribe(y,Ii),Ii()},function(){_(),q&&dr()},function(){$.subscribe(ce,Pi)},function(){ls.forEach(cs)},function(){h("enableCreatureColoring")&&r(document.body,Ge("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(y,la),la(),function(){const e=GameData.doAction
GameData.doAction=da(e)}()},function(){Ae("fsh_monsterLog").then(qo),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",Qo),Qo()},function(){$.subscribe(me,fs)},function(){h("keepLogs")&&Ae("fsh_combatLog").then(ia)},function(){window.initialGameData&&Bo(0,window.initialGameData),$.subscribe(`${ie} ${se}`,Bo)},function(){$.subscribe(ue,Eo)},function(){$.subscribe(F,lr)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){A("#mapTooltip")},function(){Ga(),$.subscribe(L,xa),$.subscribe(D,Ta)},function(){Jt(),$.subscribe(`${c} ${f}`,Jt),$.subscribe(d,Xt)},function(){s(a("buffList"),ds)},function(){M(a("actionList"),"mouseover",Gr)}]
export default function(){de(ms),$.subscribe(p,ha)}
//# sourceMappingURL=newMap-55029ab1.js.map
