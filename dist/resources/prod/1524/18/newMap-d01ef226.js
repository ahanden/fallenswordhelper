import{c as e,k as t,x as a,y as n,f as r,s as o,i,o as s,ab as u,ac as l,ad as c,ae as f,W as d,D as m,af as h,A as p,ag as b,ah as g,ai as v,aj as y,ak as w,e as k,al as C,am as L,an as D,ao as M,z as A,ap as V,$ as S,Q as H,u as B,a7 as N,a0 as G,aq as x,ar as T,L as E,t as j,M as P,as as F,at as O,au as R,av as I,a as _,F as q,aw as Y,ax as z,ay as K,az as U,aA as Q,aB as W,aC as J,S as Z,aD as X,aE as ee,a2 as te,aF as ae,aG as ne,aH as re,n as oe,aI as ie,aJ as se,aK as ue,aL as le,aM as ce,aN as fe,aO as de}from"./calfSystem-8b6534a5.js"
import{i as me}from"./isArray-3a70d0a8.js"
import{n as he}from"./numberIsNaN-0a4ef3fd.js"
import{r as pe,a as be}from"./roundToString-ec4dfe54.js"
import{p as ge}from"./playerName-bb9c2b65.js"
import{c as ve}from"./createInput-a695d53e.js"
import{i as ye}from"./insertTextBeforeEnd-2b95801c.js"
import"./testRange-aac8f77d.js"
import{t as we}from"./testQuant-361a100e.js"
import{a as ke}from"./addCommas-02f70763.js"
import{c as Ce}from"./createLabel-884029b3.js"
import"./currentGuildId-4a8535f4.js"
import"./intValue-bb1f2246.js"
import{v as Le}from"./valueText-ed45d645.js"
import"./fshOpen-b5a7c2c8.js"
import{o as De}from"./openQuickBuffByName-ccc15ff1.js"
import"./createUl-56d1bad6.js"
import{g as Me,s as Ae}from"./idb-abce8d8d.js"
import{i as Ve}from"./insertElementBefore-91801123.js"
import"./isChecked-cb800ed0.js"
import{b as Se}from"./simpleCheckbox-c60a3930.js"
import{c as He}from"./createTable-e198f036.js"
import{p as $e}from"./padZ-1409dbd9.js"
import{c as Be}from"./createButton-04628709.js"
import"./createLi-696c646d.js"
import{c as Ne}from"./createStyle-046c3f77.js"
import{c as Ge}from"./createSpan-a256b285.js"
import{h as xe}from"./hideElement-551a92b9.js"
import{a as Te}from"./all-a74f4d72.js"
import{a as Ee}from"./allthen-fc452f77.js"
import{g as je}from"./getArrayByClassName-6b8fb696.js"
import"./rnd-8b9ec80b.js"
import{f as Pe}from"./fetchdata-bc9fe617.js"
import"./indexAjaxJson-b43ddbcc.js"
import"./csvSplit-69b90268.js"
import{s as Fe}from"./shouldBeArray-725a5113.js"
import{e as Oe}from"./eventHandler5-e5345edb.js"
import"./cmdExport-a4cd29b8.js"
import{t as Re}from"./toggleForce-c312b2b1.js"
import{h as Ie}from"./hasClasses-036d0f9b.js"
import{i as _e}from"./insertElementAfter-f214147b.js"
import{g as qe}from"./getProfile-7daaa2a5.js"
import{m as Ye}from"./myStats-eb7eae50.js"
import{g as ze}from"./guild-99cf1fdb.js"
import"./isSelected-b77eba77.js"
import{g as Ke}from"./getMembrList-fd92f287.js"
import{d as Ue,g as Qe}from"./getGroupStats-796bc466.js"
import"./groupViewStats-e821bbf3.js"
import{g as We}from"./getMercStats-04068d32.js"
import{b as Je}from"./bitwiseAnd-531b0062.js"
import{r as Ze}from"./reduceBuffArray-16ae7db9.js"
import{g as Xe,a as et}from"./getTitanString-91fbe81f.js"
import{d as tt,q as at}from"./quickbuffSuccess-1e12b765.js"
import{a as nt}from"./huntingBuffs-c836add8.js"
let rt,ot,it,st,ut,lt,ct,ft,dt
function mt(e){return e}function ht(n){if(function(t){return e.showBuffInfo&&t.some(mt)}(n))return function(){if(rt)Re(rt,!1)
else{rt=t({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const e=a("actionContainer")
_e(rt,e.children[2])}return rt}()
rt&&Re(rt,!0)}function pt(e,t){ot?Re(ot,!1):function(e){ot=e.children[3],ot.className="fshBlue",n("CA ",ot),it=Ge(),r(ot,it),ye(ot," active")}(e),n(t.level,it)}function bt(e,t){t?pt(e,t):ot&&Re(ot,!0)}function gt(e,t){st?Re(st,!1):function(e){st=e.children[4],st.className="fshRed",n("Doubler ",st),ut=Ge(),r(st,ut),ye(st," active")}(e),n(t.level,ut)}function vt(e,t){t?gt(e,t):st&&Re(st,!0)}function yt(e,t,a){lt?Re(lt,!1):function(e){lt=e.children[2],n("Damage bonus: ",lt),ct=Ge(),r(lt,ct),ye(lt,"%")}(e),n(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return pe(a,2).toString()}return"0"}(t,Number(a)),ct)}function wt(e,t,a){t?yt(e,t,a):lt&&Re(lt,!0)}function kt(e,t){n(ke(e),t)}function Ct(e,t){ft?Re(ft,!1):function(e){ft=e.children[1],n("Kill Streak: ",ft),dt=Ge(),r(ft,dt)}(e),kt(t,dt)}function Lt(e,t,a,n){t||a?Ct(e,n):ft&&Re(ft,!0)}function Dt(e,t){return t.name===e}function Mt(e){const{buffs:t}=GameData.player()
if(t)return t.find(o(Dt,e))}const At=["red","orange","yellow"]
let Vt,St
function Ht(e){at(e)&&GameData.fetch(u)}function $t(){Mt("Summon Shield Imp")||tt([ge()],[55]).then(Ht)}const Bt=["imp-0","imp-1","imp-1"]
function Nt(e,t){Vt?Re(Vt,!1):function(e){Vt=e.children[0],n("Shield Imps Remaining: ",Vt),St=Ge(),r(Vt,St),i(Vt,"&nbsp;")
const t=Ge({className:"xSmallLink",textContent:"Recast"})
r(Vt,t),s(t,$t)}(e)
const a=function(e){return e?Number(e.stack):0}(t)
Vt.className=function(e){return Bt[e]||"fshGreen"}(a),n(a,St)}function Gt(e,t,a){t||a?Nt(e,t):Vt&&Re(Vt,!0)}function xt(e){return 0===e.type}function Tt(e){return Ge({textContent:e})}let Et,jt,Pt,Ft,Ot,Rt,It,_t,qt,Yt
function zt(e,t){Et?Re(Et,!1):function(e,t){Et=e.children[5],n("Teleport Cooldown: ",Et),jt=Tt(t.toString()),r(Et,jt)}(e,t)}function Kt(){const e=Math.max(Math.ceil((Pt-Date.now())/1e3),0)
n(e,jt),e>0&&setTimeout(Kt,500)}function Ut(e,t){t?zt(e,t):Et&&Re(Et,!0)}function Qt(){Ft=Mt("Death Dealer"),Ot=Mt("Doubler"),Rt=Mt("Counter Attack"),It=Mt("Summon Shield Imp"),_t=function(){const e=GameData.player().teleportCooldown
return e>1&&e}(),qt=function(){const{dynamic:e}=GameData.realm()
return me(e)&&e.some(xt)}(),Yt=GameData.player().killStreak}function Wt(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",At[e.text()]||"#ad8043")}(),Qt()
const e=ht([Ft,Ot,Rt,It,_t,qt])
e&&(Gt(e,It,Ft),Lt(e,Ft,qt,Yt),wt(e,Ft,Yt),bt(e,Rt),vt(e,Ot),Ut(e,_t))}function Jt(e,t){var a
a=t.player.teleportCooldown,jt&&(Pt=Date.now()+1e3*a,Kt())}const Zt=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let Xt,ea=[]
function ta(e){54!==e.id&&26!==e.id||(Xt.player.buffs[e.id]=parseInt(e.level,10))}function aa(e){-1===Zt.indexOf(e.name)&&(Xt.player.enhancements[e.name]=e.value)}function na(e,t){Xt={},Xt.combat=t.response.data,Xt.combat.inventory_id&&(Xt.combat.drop=Xt.combat.item.id),Xt.player={},Xt.player.buffs={},Xt.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(ta)}(t),function(e){e.player.enhancements&&e.player.enhancements.forEach(aa)}(t),Xt.time=t.time,ea.push(Xt),Ae("fsh_combatLog",ea)}function ra(e,t){0===t.response.response&&na(0,t)}function oa(e){e&&(ea=e),$.subscribe(h,ra)}function ia(t){return e.doNotKillList.includes(t.trim())}function sa(e){e.classList.toggle("fshBlue",ia(p(e)))}function ua(){const e=a("actionList")
je("creature",e).forEach(sa)}function la(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(ia(e))return a("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const ca={2:function(e){return function(t,a,n,r){la(n.passback)||e(t,a,n,r)}}}
function fa(e){return function(t,a,n,r){const o=ca[t];(function(e){return e&&b(e)})(o)&&function(e){return g(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function da(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function ma(e,t,a){return Ce({className:"fshCurveEle fshCurveLbl fshPoint tip-static "+e,dataset:{tipped:t},htmlFor:a})}function ha(e){const a=t({className:"fshToggle"}),n=ve({checked:e.prefVal,id:e.checkId,type:"checkbox"})
r(a,n)
const o=ma(e.onClass,e.onTip,e.checkId)
r(a,o)
const i=ma(e.offClass,e.offTip,e.checkId)
return r(a,i),r(e.worldName,a),n}let pa,ba,ga,va,ya,wa,ka,Ca,La
function Da(e){return e?e.toString():"?"}function Ma(e){const a=t({className:"fshFsty"})
r(a,function(){const e=t({textContent:"Min Lvl: "})
return ba=Tt(Da(GameData.realm().minlevel)),r(e,ba),e}()),r(a,function(){const e=t({textContent:"Your Lvl: "})
return ga=Tt(Da(GameData.player().level)),r(e,ga),e}()),r(e,a)}function Aa(e,t,a){const n=Be({className:"fshCurveEle fshCurveBtn fshPoint tip-static "+e,dataset:{tipped:t}})
return r(a,n),n}function Va(){var t
Ma(t=pa),va=Aa("fshFormGroup","Quick Create Attack Group",t),ya=Aa("fshQuickBuff","Open Quick Buff Popup",t),wa=Aa("fshRealmMap","Open Realm Map",t),ka=Aa("fshTempleOne","Search map in Ultimate FSG",t),function(e){if(m("showSpeakerOnWorld")){const t=m("playNewMessageSound")
Ca=ha({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(pa),function(t){const a=e.huntingMode
La=ha({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:t})}(pa)}const Sa=[[e=>e===Ca,function(){d("playNewMessageSound",!m("playNewMessageSound"))}],[e=>e===La,function(){e.huntingMode=!e.huntingMode,d("huntingMode",e.huntingMode)}]],Ha=[[e=>e===va,function(e){C(e),GameData.doAction(12,401,{},0)}],[e=>e===ya,function(){De(ge())}],[e=>e===wa,function(){window.open(L+D+"map","fsMap")}],[e=>e===ka,function(){const e=GameData.realm()
window.open(`${M}realms${D}view&realm_id=${e.id}`,"mapUfsg")}]]
function $a(){pa||(pa=t({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),Va(),s(pa,Oe(Ha)),k(pa,"change",Oe(Sa)),Ve(pa,a("worldCoord")))}function Ba(e,t){ba&&t.b.minlevel&&(da(),n(t.b.minlevel,ba))}function Na(e,t){ga&&n(t.b,ga)}function Ga(e){return!e||!e.response||!e.response.data}let xa,Ta,Ea,ja,Pa,Fa,Oa,Ra,Ia,_a,qa,Ya,za,Ka,Ua,Qa,Wa,Ja,Za,Xa,en,tn,an,nn,rn,on,sn,un,ln,cn,fn,dn,mn,hn,pn
function bn(e){return e.player_name}function gn(e){!function(e){ja=e.defenders.map(bn)}(e),xa?A("",xa):xa=t({className:"body"}),function(e){Ta=t({className:"fshFloatLeft fshRelicLeftDiv"}),r(xa,Ta),e.is_owner&&r(Ta,Ue(ja)),Ea=Be({className:"custombutton",textContent:"Fetch Stats"}),r(Ta,Ea)}(e)
const n=a("dialog-relic")
r(n,xa)}const vn=[e=>"lastUpdate"!==e,e=>!ja.includes(e),e=>Pa[e].last_login,e=>Number(Pa[e].last_login)<Fa,e=>Number(Pa[e].last_login)>Oa,e=>Pa[e].level<400||Pa[e].level>421,e=>Pa[e].level<441||Pa[e].level>450]
function yn(e,t){return t(e)}function wn(e){return vn.every(o(yn,e))}function kn(e){return`<a href="${S}${Pa[e].id}">${e}</a>`}function Cn(e){Pa=e,Fa=H-120,Oa=H-604800
const t=V(Pa).filter(wn).map(kn)
i(xa,'<div class="fshFloatLeft fshRelicLowDiv"><table class="relicT"><thead><tr><th>'+t.length.toString()+" Offline guild members not at relic:</th></tr></thead>"+`<tbody><tr><td>${t.join(" ")}</td></tr></tbody></table></div>`)}function Ln(e){xe(Ea)
const n=m("hideRelicOffline")
e.is_owner&&!n&&Ke(!0).then(Cn),i(Ta,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),pn=a("ProcessingStatus")
const o=t({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
r(xa,o),Ra=a("relicCount"),Ia=a("LDPercentage"),_a=a("LDCloaked"),qa=a("attackValue"),Ya=a("attackValueBuffed"),za=a("defenseValue"),Ka=a("defenseValueBuffed"),Ua=a("armorValue"),Qa=a("armorValueBuffed"),Wa=a("damageValue"),Ja=a("damageValueBuffed"),Za=a("hpValue"),Xa=a("hpValueBuffed"),en=a("defendersCloaked"),tn=a("defendersProcessed")
const s=t({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
r(xa,s),an=a("DC225"),nn=a("DC175"),rn=a("GroupAttack"),on=a("GroupAttackBuffed"),sn=a("GroupDefense"),un=a("GroupDefenseBuffed"),ln=a("GroupArmor"),cn=a("GroupArmorBuffed"),fn=a("GroupDamage"),dn=a("GroupDamageBuffed"),mn=a("GroupHP"),hn=a("GroupHPBuffed")}let Dn
function Mn(e){const t=B(e),a=N('#pCC img[src*="/relics/"]',t).length
var r
n(a,Ra),Dn=1===(r=a)?1.5:pe(1-r/10,2),n(String(100*Dn)+"%",Ia)}function An(e,t){return e>10*t||e<t?e:10*t}const Vn=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Sn(e,t,a){e[a[0]]=Number(t[a[1]])}const Hn=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function $n(e,t,a){e[a[0]]=t[a[1]]||0}function Bn(e){const t=Ze(e._skills),a={}
return function(e,t){Vn.forEach(o(Sn,e,t))}(a,e),function(e,t){Hn.forEach(o($n,e,t))}(a,t),a.superEliteSlayerMultiplier=pe(.002*a.superEliteSlayerLevel,2),he(a.armorValue)&&function(e){e.attackValue=An(e.attackBonus,e.levelValue),e.defenseValue=An(e.defenseBonus,e.levelValue),e.armorValue=An(e.armorBonus,e.levelValue),e.damageValue=An(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}let Nn,Gn,xn,Tn,En,jn,Pn,Fn,On,Rn,In,_n,qn,Yn
function zn(e){return Math.round(e*Dn)}function Kn(){kt(Nn,qa),kt(xn,za),kt(Tn,Ua),kt(En,Wa),kt(Pn,Za),n(Fn,en),On+=1,n(On,tn)}function Un(e){const t=function(e){return Math.ceil(In.attack*(.0025*G(e["Nightmare Visage"],0)))}(e)
In.attack-=t,function(){const e=Math.ceil(In.attack*Rn.flinchLevel*.001)
kt(In.attack-e,on)}()
const a=function(e){return Math.ceil(In.defense*(1+.001*G(e.Constitution,0)))}(e)
kt(a+t,un),function(e){kt(In.armor+Math.floor(In.armor*G(e.Sanctuary,0)*.001),cn)}(e)
const n=function(e,t){return Math.ceil(t*G(e.Fortitude,0)*.001)}(e,a)
!function(e){kt(In.hp+e,hn)}(n),function(e,t){const a=Math.ceil((In.hp+t)*G(e["Chi Strike"],0)*.001),n=Math.ceil(In.damage*Rn.terrorizeLevel*.001)
kt(In.damage+a-n,dn)}(e,n)}function Qn(){n("Processing attacking group stats ... ",pn),_n&&(In.attack-=_n.attack,In.defense-=_n.defense,In.armor-=_n.armor,In.damage-=_n.damage,In.hp-=_n.hp),kt(In.attack,rn),kt(In.defense,sn),kt(In.armor,ln),kt(In.damage,fn),kt(In.hp,mn)
const e=Ze(GameData.player().buffs)
Un(e),function(e){const t=Math.ceil(Gn*G(e.Flinch,0)*.001)
kt(Gn-t,Ya)}(e),function(e){const t=Math.ceil(jn*G(e.Terrorize,0)*.001)
kt(jn-t,Ja)}(e),n("Done.",pn)}function Wn(){n("Processing defending guild stats ... ",pn),Nn+=zn(Rn.attackValue),xn+=zn(Rn.defenseValue),Tn+=zn(Rn.armorValue),En+=zn(Rn.damageValue),Pn+=zn(Rn.hpValue),Kn()
const e=Math.ceil(Nn*(.0025*Rn.nightmareVisageLevel))
!function(e){Gn=Nn-e,kt(Gn,Ya)}(e)
const t=Math.ceil(xn*(1+.001*Rn.constitutionLevel))
!function(e,t){const a=t+e
kt(a,Ka),kt(Math.ceil(.55*a),an),kt(Math.ceil(.65*a),nn)}(e,t),kt(Tn+Math.floor(Tn*Rn.sanctuaryLevel*.001),Qa)
const a=Pn+function(e){return Math.ceil(e*Rn.fortitudeLevel*.001)}(t)
kt(a,Xa),function(e){jn=En+Math.ceil(e*Rn.chiStrikeLevel*.001),kt(jn)}(a),0!==Rn.cloakLevel&&n("Yes",_a),GameData.player().hasGroup&&In?Qn():n("Done.",pn)}function Jn(e){const t=Bn(e)
Nn+=Math.round(t.attackValue*x),xn+=Math.round(t.defenseValue*x),Tn+=Math.round(t.armorValue*x),En+=Math.round(t.damageValue*x),Pn+=Math.round(t.hpValue*x),0!==t.cloakLevel&&(Fn+=1),Kn()}function Zn(e){Rn=Bn(e)}function Xn(e){In=e}function er(e){_n=e}function tr(e){n(e.message,pn)}function ar(e){const t=B(e),a=P('#pCC a[href*="confirmDisband"]',t)
if(!a)return
const n=function(e){const t=e.previousElementSibling.href,a=[Qe(t).then(Xn)]
return function(e){return-1!==e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(e)&&a.push(We().then(er)),a}(a)
return Te(n)}function nr(e,t){return 0===t?qe(e).then(Zn):qe(e).then(Jn).catch(tr)}function rr(){let e=[j({cmd:"guild",subcmd:"view",guild_id:qn.controlled_by.guild_id}).then(Mn)]
return GameData.player().hasGroup&&e.push(j({cmd:"guild",subcmd:"groups"}).then(ar)),e=e.concat(ja.map(nr)),e}function or(){Ln(qn),Nn=0,xn=0,Tn=0,En=0,Pn=0,Fn=0,On=0
const e=rr()
Ee(e,Wn)}function ir(e,t){Ga(t)||(qn=t.response.data,qn.defenders.length>0&&(gn(qn),E(Ea,"click",or)))}function sr(e){$("#statbar-gold").css("background-color",e)}function ur(){$("#HelperSendTotal").html(ke(m("currentGoldSentTotal"))),Number(GameData.player().gold)>Yn?sr("red"):sr("inherit")}function lr(){Yn=m("goldAmount"),$("#statbar-gold-tooltip-general").append(`<dt class="stat-gold-sendTo">Send To:</dt><dd id="HelperSendTo">${m("goldRecipient")}</dd><dt class="stat-gold-sendAmt">Amount:</dt><dd id="HelperSendAmt">${ke(Yn)}</dd><dt class="stat-gold-sendTo">Send?</dt><dd><input id="HelperSendGold" value="Send!" class="custombutton" type="submit"><input type="hidden" id="xc" value=""</dd><dt class="stat-gold-sendTotal">Total Sent:</dt><dd id="HelperSendTotal">${ke(m("currentGoldSentTotal"))}</dd>`),$("#HelperSendGold").on("click",R),ur(),$.subscribe(I,ur)}const cr=[]
function fr(e){return Ga(e)||cr.push(e),e}function dr(e,t){return e===Number(t.response.data.id)}function mr(e,t){e(t)}function hr(e,t){const a=cr.find(o(dr,e))
return a?function(e){return new Promise(t=>{_(3,mr,[t,e])})}(a):Pe({a:1,id:e,passback:t}).then(fr)}let pr,br,gr,vr,yr,wr
function kr(e,t){return Le(q(t,e))}function Cr(){var e
pr=GameData.player().level,e=a("statbar-character-tooltip-stats"),gr=kr(e,Q),br=kr(e,Y),yr=kr(e,z),vr=kr(e,K),wr=kr(e,U)}function Lr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function Dr(e,t,a){return function(e){return`<table><tr><td><img src="${W}creatures/${e.image_id}.png" height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>`}(e)+function(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${pr}</span>)</td></tr>`}(e,a)+function(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${br}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${gr}</span>)</td></tr>`}(e)+function(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${vr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${yr}</span>)</td></tr>`}(e)+function(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${wr}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}(e,t)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(Lr).join("")}(e)+function(e){return`<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td></tr><tr><td colspan="4">${e.description}</td></tr><tr><td colspan="4" height="5"></td></tr></table></td></tr><tr><td class="fshCenter"><b>${e.name}</b></td></tr></table>`}(e)}function Mr(t){if(!Ga(t))return function(t){const a=Math.ceil(t.hp*e.hpVariable+t.armor*e.generalVariable)
let n="fshYellow"
return Cr(),pr>t.level&&(n="fshRed"),Dr(t,a,n)}(t.response.data)}const Ar=["verb","view","tip-static"]
function Vr(e,t){const a=Mr(t)
e.set("content.text",a)}function Sr(e,t,a){return hr(GameData.actions()[e].data.id,e).then(o(Vr,a)),"Loading..."}function Hr(e,t){Z("NewMap","CreatureInfo")
const a=X((n=t).parentNode.children).indexOf(n)
var n,r,i
e.classList.add("fshTip"),r=e,i=o(Sr,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:i},hide:{effect:!1}})}function $r(t){if(!e.showCreatureInfo)return
const{target:a}=t,n=a.parentNode.parentNode.parentNode;(function(e,t){return Ie(Ar,e)&&!J("fshTip",e)&&J("creature",t)})(a,n)&&Hr(a,n)}function Br(){return ze({subcmd:"scouttower"})}function Nr(e,t){const a=e.insertCell(-1)
return[a.colSpan]=t,t[2]&&(a.className="header"),r(a,t[1]),a}function Gr(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(o(Nr,e))}(n,t),n}function xr(e,t){Gr(e,t[0],t[1])}function Tr(e,t){t.forEach(o(xr,e))}let Er,jr,Pr,Fr,Or,Rr,Ir,_r,qr,Yr,zr,Kr,Ur,Qr,Wr,Jr,Zr,Xr,eo,to,ao,no,ro,oo,io,so,uo,lo
function co(){jr=Tt("Current"),Pr=Tt("Kills"),Fr=Tt("Member"),Or=Tt("% of Total"),Rr=Tt("Status"),Ir=Tt("Titan HP"),_r=Tt("Total"),qr=Tt("Your Guild")}function fo(){for(;Zr.rows.length>7;)Zr.deleteRow(7)}function mo(){const e=Ge()
return r(e,Yr),ye(e,"/"),r(e,zr),e}function ho(e){const t=Ge()
return r(t,e),ye(t,"%"),t}function po(){eo=null,Xr&&!Xr.classList.contains("fshHide")&&(Re(Xr,!0),n("",Yr),n("",zr),n("",Kr),n("",Ur),n("",Qr),A("",Wr),A("",Jr),fo())}function bo(e){return 0===e.type&&(eo=e.base_creature_id,!0)}function go(){if(Xr)Re(Xr,!1)
else{const e=a("actionContainer")
Xr=t({className:"fshActionBox titanInfo"}),Yr=Ge(),zr=Ge(),Kr=Ge(),Ur=Ge(),Qr=Ge(),Wr=Ge(),Jr=Ge(),Zr=He({className:"fshCenter"}),co(),Tr(Zr,[[[[2,Ir,!0],[4,qr,!0]]],[[[2,mo()],[4,Kr]]],[[[2,jr,!0],[4,ho(Ur)]],!0],[[[2,_r,!0],[4,ho(Qr)]],!0],[[[2,Rr,!0],[4,Wr]],!0],[[[6,Jr]]],[[[2,Fr,!0],[2,Pr,!0],[2,Or,!0]]]]),r(Xr,Zr),r(e,Xr)}}function vo(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(te+1e3*e)
return`${$e(t.getHours())}:${$e(t.getMinutes())} ${$e(t.getDate())}/${ee[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function yo(e){n(e.current_hp,Yr),n(e.max_hp,zr),n(e.kills,Kr),n(function(e){return be(Xe(e.max_hp-e.current_hp,e.kills),2)}(e),Ur),n(function(e){return be(100*e.kills/e.max_hp,2)}(e),Qr),A(function(e){return et(e.kills,e.max_hp,e.current_hp)}(e),Wr),A(vo(e.cooldown),Jr)}function wo(e,t){return[[[2,Tt(t.player.name)],[2,Tt(t.kills.toString())],[2,Tt(be(100*t.kills/e.kills,2)+"%")]]]}function ko(e){return e.realm&&e.creature.base_id===eo&&e.realm===Er}function Co(e){const t=e.find(ko)
t&&(yo(t),function(e){if(fo(),!e.contributors)return
const t=e.contributors.map(o(wo,e))
Tr(Zr,t)}(t))}function Lo(t){return e.showTitanInfo&&me(t)&&t.some(bo)}function Do(e,t){(function(e){return e.s&&me(e.r)})(t)&&(Co(t.r),Lo(GameData.realm().dynamic)?to=window.setTimeout(e,3e4):po())}function Mo(){Br().then(o(Do,Mo))}function Ao(e){to&&(window.clearTimeout(to),to=null),Lo(e)?(go(),Mo()):po()}function Vo(e){var t
e.dynamic&&(t=e.name,Er=t,Ao(e.dynamic))}function So(e,t){(function(e){return e.realm&&e.realm.name})(t)&&Vo(t.realm)}function Ho(e){const t=e.response.response,a=e.response.msg
let n
if(0!==t){const e=a.indexOf("<")
n=-1!==e?a.substring(0,e):a}else n=`You purchased ${e.response.data.name} for ${ke(e.response.data.cost)} gold.`
i(uo,n+"<br>")}function $o(){GameData.doAction(14,3,{id:ao.id,item_id:ao.itemId},0),ro.close()}function Bo(){const e=we(io.value)
if(!e)return
const t=[]
for(let a=1;a<e;a+=1)t.push(Pe({a:14,d:0,id:ao.id,item_id:ao.itemId}).then(Ho))
Ee(t,$o)}function No(){oo?n("",uo):(oo=t({className:"fshClear",textContent:"Select how many to quick-buy:"}),io=ve({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),r(oo,io),so=Be({textContent:"Quick-buy"}),s(so,Bo),r(oo,so),uo=t(),r(oo,uo),r(no,oo))}function Go(e,t){ao=t,no=no||a("shopDialogConfirm"),no&&(ro=ro||$(no).data("hcsWorldDialogShopConfirm"),ro&&No())}function xo(e){lo[e.name]?lo[e.name].seen&&(lo[e.name].seen+=1):(lo[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,lo[e.name]))}function To(e,t,a){return t?e(t,a):a}function Eo(e,t){const a=e||{}
return a.min=To(Math.min,a.min,t),a.max=To(Math.max,a.max,t),a}const jo=["attack","armor","damage","defense","hp"]
function Po(e,t,a){const n=Eo(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function Fo(e,t){e[t.name]=Eo(e[t.name],Number(t.value))}function Oo(e){lo||(lo={}),xo(e),function(e,t){jo.forEach(o(Po,e,t))}(e,lo[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(o(Fo,t.enhancements)))}(e,lo[e.name]),Ae("fsh_monsterLog",lo)}function Ro(e){lo=e||{}}const Io=[]
function _o(t){var a
Ga(t)||(Z("NewMap","MonsterLog"),a=t.response.data,e.showMonsterLog&&Oo(a))}function qo(e,t){return e.id===t.id}function Yo(e,t){6!==e.type||function(e){if(Io.find(o(qo,e.data)))return!0
Io.push(e.data)}(e)||hr(e.data.id,t).then(_o)}function zo(){e.showMonsterLog&&GameData.actions().forEach(Yo)}function Ko(e){return ze(oe({subcmd:"groups"},e))}function Uo(e){return function(e){return Ko({subcmd2:"viewstats",group_id:e})}(e)}function Qo(){return Ko({subcmd2:"view"})}function Wo(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const Jo=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>"Player 1 hits"+Wo(e)],[e=>e.playerHits>1,e=>"Player > 1 hits"+Wo(e)]]
function Zo(e,t){return t[0](e)}function Xo(e){e.playerHits=function(e){return"-"===e.numberOfCreatureHitsTillDead?e.numberOfHitsRequired:function(e){return"-"===e.numberOfHitsRequired||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}(e)?"-":e.numberOfHitsRequired}(e),e.creatureHits=function(e){return"-"===e.numberOfHitsRequired?e.numberOfCreatureHitsTillDead:function(e){return"-"===e.numberOfCreatureHitsTillDead||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}(e)?"-":e.numberOfCreatureHitsTillDead}(e),e.fightStatus=function(e){const t=Jo.find(o(Zo,e))
return t?t[1](e):"Unknown"}(e)}function ei(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function ti(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),ei(e)}function ai(e){const t=function(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${Math.floor(e.creature.defense*e.player.darkCurseLevel*.002)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-e.creature.defense*e.player.darkCurseLevel*.002
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}function ni(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function ri(e){ni(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function oi(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&ri(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){ni(e),function(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==e.lowestCALevelToStillHit&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}(e),function(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==e.lowestCALevelToStillKill&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(e)}(e)}function ii(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e)
const t=function(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}(e)
if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}function si(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function ui(e){e.overallDefenseValue=si(e)+Math.floor(si(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(si(e)*e.player.constitutionLevel*.001)}<br>`)}(e),function(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function li(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}let ci,fi,di,mi,hi,pi,bi,gi,vi,yi
function wi(){return ia(fi)?"Remove from do not kill list":"Add to the do not kill list"}function ki(){n(wi(),di)}function Ci(){const t=e.doNotKillList.indexOf(fi);-1===t?e.doNotKillList.push(fi):e.doNotKillList.splice(t,1),ki(),d("doNotKillList",e.doNotKillList.join()),ua()}function Li(){di?ki():function(){di=Be({className:"fshBl",textContent:wi(),type:"button"})
const e=t({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
r(e,di),r(ci,e),s(di,Ci)}()}function Di(e,t){!function(e){if(!ci){const t=q("body",e)
1===t.length&&([ci]=t)}}(t),ci&&(fi=e.trim(),Li())}function Mi(){pi||(hi||(hi=t(),r(mi,hi),r(mi,t({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),pi=t(),r(hi,pi))}function Ai(e){Mi(),A(e,pi)}function Vi(e){bi||(Mi(),bi=t(),r(hi,bi)),A(e,bi)}function Si(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Hi(t,a,n){const r={}
r.callback=n,r.player=Bn(a),function(t){t.combatEvaluatorBias=e.combatEvaluatorBias,t.attackVariable=1.1053,t.generalVariable=e.generalVariable,t.hpVariable=e.hpVariable}(r),r.creature=Si(t.response.data,r.player.superEliteSlayerMultiplier),function(e){li(e),ai(e),ii(e),ui(e),ti(e),Xo(e),oi(e)}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${function(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(e){return e.callback.groupExists?"Group ":""}(e)}Combat Evaluation</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I hit it? </td><td align="left">${function(e){return e.hitByHowMuch>0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right"><span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Will I be hit? </td><td align="left">${function(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right"><span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333"># Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333"># Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}(e)}${function(e){return`<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3"><span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}(e)}</tbody></table>`}(r),n.groupExists?Vi(r.evaluatorHTML):Ai(r.evaluatorHTML)}function $i(e){return e.members[0].name===ge()}function Bi(e){if(me(e.r))return e.r.find($i).id}function Ni(e,t,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Hi(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Gi(e,t,a){a&&Uo(a).then(o(Ni,e,t))}function xi(e,t){e.player.hasGroup&&function(e,t){Qo().then(Bi).then(o(Gi,e,t))}(e,t),Hi(e,t,{groupExists:!1})}function Ti(e,t){mi||(mi=a("dialog-viewcreature")),mi&&(Ai(""),Vi(""),function(e){return e.response&&e.response.data}(t)&&(Di(t.response.data.name,mi),Ye(!0).then(o(xi,t))))}function Ei(){const t=[,[e.buffs,e.buffsName],[e.buffs2,e.buffs2Name],[e.buffs3,e.buffs3Name]][e.enabledHuntingMode]
me(t)&&([gi,vi]=t)}function ji(t){"enabledHuntingMode"===t.target.name&&(e.enabledHuntingMode=t.target.value,d("enabledHuntingMode",e.enabledHuntingMode),Ei(),GameData.fetch(u))}function Pi(e){const t=q("verbs",e)
1===t.length&&xe(t[0])}function Fi(){if(!yi)return
const e=a("actionList")
je("player",e).forEach(Pi)}const Oi={hideSubLvlCreature:function(){e.hideSubLvlCreature=!e.hideSubLvlCreature,d("hideSubLvlCreature",e.hideSubLvlCreature),GameData.fetch(se)},hidePlayerActions:function(){yi=!yi,d("hidePlayerActions",yi),GameData.fetch(se)},showCreatureInfo:function(){e.showCreatureInfo=!e.showCreatureInfo,d("showCreatureInfo",e.showCreatureInfo)},showHuntingBuffs:function(){e.showBuffs=!e.showBuffs,d("showHuntingBuffs",e.showBuffs),GameData.fetch(u)},showMonsterLog:function(){e.showMonsterLog=!e.showMonsterLog,d("showMonsterLog",e.showMonsterLog)},showTitanInfo:function(){e.showTitanInfo=!e.showTitanInfo,d("showTitanInfo",e.showTitanInfo),Ao(GameData.realm().dynamic)},showBuffInfo:function(){e.showBuffInfo=!e.showBuffInfo,d("showBuffInfo",e.showBuffInfo),Wt()}}
function Ri(e){const t=Oi[e.target.name]
b(t)&&(e.target.blur(),t(e))}function Ii(){const e=t({className:"fshCenter fshFten"}),n=t({id:"fshWorldPrefs",innerHTML:`${Se("showCreatureInfo")}&nbsp;&nbsp;${Se("showMonsterLog")}&nbsp;&nbsp;${Se("showTitanInfo")}&nbsp;&nbsp;${Se("showBuffInfo")}<br>${Se("hideSubLvlCreature")}&nbsp;&nbsp;${Se("hidePlayerActions")}&nbsp;&nbsp;${nt()}`})
s(n,Ri),k(n,"change",ji),r(e,n)
const o=t()
r(e,o)
const i=a("worldContainerBelow").children[0]
return Ve(e,i),o}function _i(e,t){return e[t.name]=!0,e}function qi(e,t,a){return e[a.trim()]||t.push(a),t}function Yi(e){A("",e)}function zi(e,t){const a=t.b.reduce(_i,{}),n=gi.reduce(o(qi,a),[])
n.length>0?function(e,t){A(`You are missing some ${vi} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):Yi(e)}function Ki(t,a,n){gi&&function(t,a,n){e.showBuffs?zi(t,n):Yi(t)}(t,0,n)}const Ui=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function Qi(){var t
e.combatEvaluatorBias=m("combatEvaluatorBias"),e.generalVariable=(t=e.combatEvaluatorBias,Ui[t]?Ui[t].generalVariable:1.1053),e.hpVariable=function(e){return Ui[e]?Ui[e].hpVariable:1.1}(e.combatEvaluatorBias)}function Wi(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function Ji(e){const t=ue(e)
return function(e){return!e||!e.actions||0===e.actions.length}(t)?e:(t.actions=t.actions.filter(o(Wi,function(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}(t))),JSON.stringify(t))}function Zi(t,a){e.hideSubLvlCreature&&function(e){return e.data&&e.data.d&&Je(e.data.d,se)}(a)&&(t.dataFilter=Ji)}function Xi(t){e[t[0]]=Fe(t[1])}function es(t){e[t]=Fe(t)}function ts(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(Xi),["doNotKillList"].forEach(es)}function as(t){e[t[0]]=m(t[1])}function ns(t){e[t]=m(t)}function rs(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(as),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(ns)}function os(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const is=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function ss(e,t){var a
m(e)&&(a=t+1,$.subscribe(v,o(os,a)),os(t+1))}function us(e,t){"ACT_REPAIR"===t&&GameData.fetch(fe+u+de+se)}function ls(e){C(e.target)}const cs=[function(){Qi(),ts(),rs()
const t=Ii()
$.ajaxPrefilter("JSON",Zi),e.hideSubLvlCreature&&GameData.fetch(se),function(t){Ei()
const a=o(Ki,t)
$.subscribe(l,a),e.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(t),yi=m("hidePlayerActions"),$.subscribe(v,Fi),Fi()},function(){F(),O&&lr()},function(){$.subscribe(ie,Ti)},function(){is.forEach(ss)},function(){m("enableCreatureColoring")&&r(document.body,Ne("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))},function(){$.subscribe(v,ua),ua(),function(){const e=GameData.doAction
GameData.doAction=fa(e)}()},function(){Me("fsh_monsterLog").then(Ro),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",zo),zo()},function(){$.subscribe(ce,us)},function(){m("keepLogs")&&Me("fsh_combatLog").then(oa)},function(){window.initialGameData&&So(0,window.initialGameData),$.subscribe(`${ae} ${ne}`,So)},function(){$.subscribe(re,Go)},function(){$.subscribe(T,ir)},function(){$("#messageCenter").worldMessageCenter({offset:"0 60"})},function(){C("#mapTooltip")},function(){$a(),$.subscribe(y,Ba),$.subscribe(w,Na)},function(){Wt(),$.subscribe(`${l} ${c}`,Wt),$.subscribe(f,Jt)},function(){s(a("buffList"),ls)},function(){k(a("actionList"),"mouseover",$r)}]
export default function(){le(cs)}
//# sourceMappingURL=newMap-d01ef226.js.map
