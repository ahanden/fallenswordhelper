import{a as y}from"./chunk-WYNF75DU.js";import{c as I}from"./chunk-4VXK4YWI.js";import"./chunk-Z4E3PWJG.js";import{a as G,b as V}from"./chunk-GZ26ANWK.js";import{a as q}from"./chunk-RKIPSCBY.js";import"./chunk-V6GVUJKR.js";import{a as S}from"./chunk-OE34Y2RT.js";import{a as P}from"./chunk-LHT35R35.js";import"./chunk-SYQA2O7R.js";import{a as W}from"./chunk-MD2EH2NG.js";import"./chunk-UQ7V6CON.js";import{a as _}from"./chunk-T75FYQWQ.js";import{a as j}from"./chunk-LN3B2I7M.js";import"./chunk-X7E2SA4E.js";import"./chunk-OXGD46RT.js";import"./chunk-HFFCEKOB.js";import{a as O}from"./chunk-ZMNIM3IU.js";import{a as M}from"./chunk-W2FA47U7.js";import"./chunk-QDNGOWRP.js";import"./chunk-4MFIQJXK.js";import{b as D,c as R}from"./chunk-I66ZLTG4.js";import"./chunk-PF6DJFMF.js";import"./chunk-5J6NAHWT.js";import{a as m}from"./chunk-CCLZNKSK.js";import"./chunk-ZM6HBKU4.js";import"./chunk-WLV3S4QF.js";import{a as l}from"./chunk-2R5YWF5Y.js";import{a as d}from"./chunk-KDWZJUZA.js";import"./chunk-W5GFA5ST.js";import{a as x}from"./chunk-AQVHZUV2.js";import"./chunk-4EQLU7T2.js";import"./chunk-NJOQ3NDV.js";import"./chunk-CGMJZDEW.js";import{a as u}from"./chunk-RYE3L7GQ.js";import{a as w}from"./chunk-J5XNY3JU.js";import"./chunk-IQW2ORO4.js";import"./chunk-OOBHF62J.js";import"./chunk-NJBFNVL7.js";import{a as k}from"./chunk-VBWDODYG.js";import{a as h}from"./chunk-QIL4FZV2.js";import"./chunk-IZXJJTGC.js";import{a as $}from"./chunk-R2CSY5SF.js";import{a as g}from"./chunk-L4652TKI.js";import{a as H}from"./chunk-2EFDXXYQ.js";import"./chunk-2XEVBCYQ.js";import"./chunk-UVOACIBU.js";import"./chunk-7L7VBHFN.js";import"./chunk-7P2FG6TX.js";import"./chunk-LXEIN7K6.js";import{a as F}from"./chunk-CRTXBDKV.js";import{a as i}from"./chunk-NB536QSB.js";import{a as n}from"./chunk-WIXXQZGK.js";import{a as N}from"./chunk-VAF5SHD2.js";import"./chunk-7OIIEMPN.js";import{a as b}from"./chunk-G6KH6V7U.js";import{a as c}from"./chunk-JTZMGYZZ.js";import"./chunk-IYLDI6QO.js";import"./chunk-ZSG7IXEN.js";import"./chunk-MC5PPM6O.js";import"./chunk-3HBYM6UL.js";import"./chunk-NYKMXDP7.js";import{a}from"./chunk-2PPLUYZS.js";import{a as A,b as p}from"./chunk-CJBVZNBW.js";import"./chunk-LBZNNC2Y.js";import"./chunk-6VTPYDCU.js";import"./chunk-L67WY5JB.js";import{ua as f}from"./chunk-M7EFODKE.js";import{a as E}from"./chunk-N5EIINNY.js";var U=(e,t,s)=>e&&N(t,s),z=(e,t,s)=>!e&&!t&&!s,K=(e,t)=>{t.is_in_st&&e.classList.add("isInST")},L={};function X(){let e=n("item-div");if(!e){e=u({id:"item-div",className:"itemDiv"});let t=n("item-list"),s=H(f,t);for(;s.length;)s[0].classList.add("fshBlock"),w(e,s[0]);d(e,t)}return e}function Y(e,t){t.children[0].lastElementChild.children[0].children[0].checked=!1;let s=i("fshHide",t),o=e==="folderid0",r=i(e,t);U(s,o,r)&&(t.classList.remove("fshHide"),t.classList.add("fshBlock")),z(s,o,r)&&(t.classList.remove("fshBlock"),M(t))}function Z(e){l("trade","doHideFolder"),g(f,X()).forEach(c(Y,e.target.id))}function ee(e){e.target.nodeName==="SPAN"&&e.target.id.indexOf("folderid")!==-1&&Z(e)}function te(e){return` &ensp;<span id="folderid${e[0]}" class="fshLink fshNoWrap" fid=${e[0]}>${e[1]}</span> `}function se(e){let t=y({id:"fshFolderSelect",innerHTML:`<td colspan=6><span id="folderid0" class="fshLink" fid=0>All</span> &ensp;<span id="folderid-1" class="fshLink" fid="-1">Main</span>${b(e).map(te).join("")}`});a(t,ee);let s=n("item-list").parentNode.parentNode;j(s,'<tr id="fshShowSTs"><td align="center" colspan=6><label><input type="checkbox" id="itemsInSt" checked> Select items in ST</label></td></tr>'),d(t,s)}function ne(e,t,s){e.classList.add(`folderid${s.folder_id}`),L.fshHasST&&K(e,s),t.classList.add(`itemid${s.item_id}`),t.classList.add(`itemtype${s.type}`),s.guild_tag!==-1&&t.classList.add("isGuildTagged")}function ie(e){let t=e.children[0]?.lastElementChild.children[0]?.children[0];if(!t)return;let s=L[t.value];s&&ne(e,t,s)}function oe(e){let t=p("betaOptIn");t&&D("trade.processTrade"),L=e.items,g(f,n("item-list")).forEach(ie),se(e.folders),t&&R("trade.processTrade")}async function v(){if(F())return;let e=await P();m(3,oe,[e])}function B(e,t){return x(G,V,e,t)}var re=e=>W(e).previousElementSibling.children[0].children[0].children[0],me=e=>re(e).remove();function ae(e,t,s){s.s?(me(e),e.classList.remove("fshSpinner")):e.replaceWith(t)}async function le(e,t){let s=await e;if(s.s){let o=u({className:"fshSpinner fshSpinner12 fshRelative",style:{height:"16px"}}),[r]=t;r.replaceWith(o);let C=await B(t[1],t[2]);return ae(o,r,C),C}return s}function ce(e){e.s?I("Items sent successfully!"):I(e.e.message)}var de=()=>h('[name="sendItemList[]"]:checked'),fe=()=>k('form[name="sendItemForm"] [name="target_username"]').value,pe=e=>de().map(t=>[t,e,[t.value]]),he=e=>e.reduce(le,Promise.resolve({s:1}));async function ue(e,t){l("trade","oneByOne");let s=O({className:"fshSpinner fshRelative",style:{marginLeft:"40px"}}),o=e.target;o.replaceWith(s);let r=await he(t);ce(r),s.replaceWith(o)}function ye(e){let t=pe(fe());t.length&&ue(e,t)}function T(){let e=k('form[name="sendItemForm"] input[value="Send"]'),t=q({className:"fshBl",id:"oneByOneBtn",textContent:"OneByOne",type:"button"});_(t,e),a(t,ye)}var ge=[e=>e==="itemid-1",(e,t)=>e==="itemid-2"&&i("itemtype12",t),(e,t)=>e==="itemid-3"&&i("isGuildTagged",t),i],ke=(e,t)=>ge.some(s=>s(e,t)),Se=()=>n("itemsInSt")?.checked,Ie=(e,t)=>e||!i("isInST",t),J=e=>e.children[0].lastElementChild.children[0].children[0],Q=(e,t)=>{t.checked=e},Le=e=>{Q(!1,e)},ve=e=>{Q(!0,e)},Be=e=>` &ensp;<span id="itemid${e[1]}" class="fshCheckAll fshLink fshNoWrap">${e[0]}</span>`;function Te(e){let t=parseInt(n("fshSendHowMany").value,10);return $(t)?e.length:E.subcmd!=="-"?Math.min(100,t):t}function Ce(e,t){t.filter(c(Ie,Se())).map(J).filter(c(ke,e)).slice(0,Te(t)).forEach(ve)}function Ee(e){l("trade","doCheckAll");let t=n("item-div")||n("item-list"),s=h("table:not(.fshHide)",t);s.map(J).forEach(Le),Ce(e.target.id,s)}function Ae(e){i("fshCheckAll",e.target)&&Ee(e)}function Ne(){let e=p("sendClasses");return S(e)||S(A.sendClasses)}function He(e){let t=y({id:"fshSelectMultiple",innerHTML:`<td colspan=6>Select:&ensp;<span id="itemid-1" class="fshCheckAll fshLink fshNoWrap">All Items</span> &ensp;<span id="itemid-2" class="fshCheckAll fshLink fshNoWrap">All Resources</span> &ensp;<span id="itemid-3" class="fshCheckAll fshLink fshNoWrap">Guild Tagged</span>${Ne().map(Be).join("")} &ensp;How&nbsp;many:<input id="fshSendHowMany" type="text" class="custominput fshHowMany" value="all"></td>`});a(t,Ae),d(t,e.parentNode.parentNode)}function be(){let e=n("item-list");!e||(m(3,v),m(3,He,[e]),m(3,T))}export{be as default};
//# sourceMappingURL=trade-J7P4JJG7.js.map
