import{g as n,p as e,a as i,i as t,b as s,c as r,e as a,f as c,h as o,j as l,k as u,m as d,l as f,n as p,o as h,q as m,r as k,t as v,s as g,u as b,v as S,w as L,x as E,y as N,z as H,A,B as j,C as w,D as I,E as D,F as T,G as x,H as M,I as _,J as O,K as C,L as Q,M as R,N as F,O as y,P as U,Q as q,R as G,S as P}from"./calfSystem-9b5b466b.js"
const V=n=>n.src.includes("/folder.png")
function Y(n){return"<option value="+n.parentNode.href.match(/&folder_id=(-?\d+)/i)[1]+">"+s(n.parentNode.parentNode)+"</option>"}var z,B
function J(n,e){e.checked=!e.disabled&&!e.checked}var K,W=[["guild",function(n,e){e.checked=!e.disabled&&-1!==z[n.invid].guild_tag}],["item",function(n,e){z[n.invid]&&z[n.invid].item_id===B&&J(0,e)}],["checkAll",J]]
function X(n,e){return e[0]===n}function Z(n,e){e.injectHere&&(e.injectHere.parentNode.classList.contains("fshHide")||n(e,e.el.parentNode.parentNode.previousElementSibling.children[0]))}function $(n,e,i,t){z=e
var s=W.find(r(X,i))[1]
B=Number(t),n.forEach(r(Z,s))}function nn(i){if("storeitems"===a.subcmd2){var t=n("form",e)[0]
if(t){var s=c({className:"fshCenter"}),r=o({colSpan:3})
l(s,r),u(s,t),r.innerHTML=d(i),h=n(f,e)[0].rows,p(h[h.length-2].cells[0],'<input id="fshChkAll" value="Check All" type="button">&nbsp;')}}var h}function en(n){return n?"Hide":"Show"}function tn(i,t){if(function(){if(!K){var i=n("form",e)
i.length>0&&(K=i[0].previousElementSibling.children[0])}}(),K){var s='[<span id="fshShowExtraLinks" class="sendLink">'+en(i)+' AH and UFSG links</span>]&nbsp;[<span id="fshShowQuickDropLinks" class="sendLink">'+en(t)+" Quick Drop links</span>]&nbsp;"
"storeitems"===a.subcmd2&&(s+='[<span id="fshSelectAllGuildLocked" class="sendLink"> Select All Guild Locked</span>]&nbsp;'),K.innerHTML=s}}function sn(n,e,i){i.el.parentNode.parentNode.previousElementSibling.children[0].checked=!1,function(n,e,i){var t=i.injectHere.parentNode,s=n[i.invid].folder_id,r=0!==e&&e!==s;[563116,1963510].includes(h())&&console.log(e,s,e!==s),v(t,r),v(t.nextElementSibling,r)}(n,e,i)}function rn(n,e,i){[563116,1963510].includes(h())&&console.log("itemsAry.length",n.length,"entries(invItems).length",m(e).length,n,e),k([2,3,n,0,r(sn,e,Number(i.dataset.folder))])}function an(n){if(n.injectHere)return n.injectHere.previousElementSibling.previousElementSibling.children[0].checked}const cn=n=>n.invid
function on(n,e){return n.toString()===e.invid}function ln(n,e){var i=n.find(r(on,e))
if(i){var t=i.injectHere.parentNode
t.nextElementSibling.remove(),t.remove(),i.el=null,i.invid=null,i.injectHere=null}}function un(n,e){L(e.r)&&e.r.forEach(r(ln,n))}function dn(n,e,i){S(e,i).then(r(un,n))}function fn(n){var e=g("selectFolderId").value
b(30,n.filter(an).map(cn)).forEach(r(dn,n,e))}function pn(n,e,i){1!==i.r&&(n.style.color="green",n.innerHTML=e)}function hn(n,e,i,t){t.className="quickAction",function(n,e,i){e([n.getAttribute("itemInvId")]).then(r(pn,n,i))}(t,n,e),E(t),function(n){n.innerHTML='<img class="quickActionSpinner" src="'+N+'ui/misc/spinner.gif" width="15" height="15">'}(t)
var s=t.parentNode
!function(n,e){var i=H(e,n)
i&&(i.className="quickAction",i.innerHTML="")}(s,i),function(n){var e=n.parentNode.children[0].children[0]
e.checked=!1,e.disabled=!0}(s)}var mn,kn,vn,gn,bn,Sn,Ln,En,Nn,Hn,An,jn
function wn(n){return n.dataset.tipped}function In(n){var e=n.dataset.tipped.match(I)
return[n,e[1],e[2]]}function Dn(n,e){return n[e[1]]=(n[e[1]]||0)+1,n}function Tn(n){return{el:n[0],invid:n[2],injectHere:n[0].parentNode.parentNode.nextElementSibling}}function xn(){w(),mn=A("disableItemColoring"),kn=A("showExtraLinks"),vn=A("showQuickDropLinks"),gn=A("showQuickSendLinks"),tn(kn,vn)
var t,s,r=(t=n(f,e),s=t[t.length-1],i("img",s)).filter(wn).map(In)
bn=r.map(Tn),(Sn=r.reduce(Dn,{}))[13699]=1}var Mn=[[function(n){return!En&&1!==Sn[n.item_id]},function(n,e){return' [<span linkto="'+e.item_id+'" class="fshLink">Check all</span>]'}],[function(n){return!jn&&gn&&!n.bound},function(n){return' <span class="quickAction sendLink tip-static" itemInvId="'+n.invid+'" data-tipped="INSTANTLY SENDS THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk.">[Quick Send]</span>'}],[function(n){return!Nn&&vn&&-1===n.guild_tag},function(n){return' <span class="quickAction dropLink tip-static" itemInvId="'+n.invid+'" data-tipped="INSTANTLY DROP THE ITEM. NO REFUNDS OR DO-OVERS! Use at own risk.">[Quick Drop]</span>'}]]
function _n(n,e){return e[0](n)}function On(n,e,i){return i[1](n,e)}function Cn(n,e){!function(n,e){An||mn||n.injectHere.classList.add(P[e.rarity].clas)}(n,e)
var i=Mn.filter(r(_n,e)).map(r(On,n,e)).join("")
""!==i&&G(n.injectHere,i)}function Qn(n){var e=Hn[n.invid]
e&&(!function(n,e){if(!F(Ln,!kn)){var i='<span><span class="aHLink">'
e.bound||(i+='[<a href="'+y+encodeURIComponent(e.item_name)+'">AH</a>]'),i+='</span>[<a href="'+U+"items"+q+"view&item_id="+e.item_id+'" target="_blank">UFSG</a>]</span>',p(n.injectHere,i)}}(n,e),Cn(n,e))}function Rn(){kn&&(Ln=!0),En=!0,An=!0,vn&&(Nn=!0),jn=!0}function Fn(n){v(n.injectHere.children[0],!kn)}function yn(){j("showExtraLinks",kn=!kn),tn(kn,vn),Ln?bn.forEach(Fn):k([5,3,bn,0,Qn,Rn])}function Un(n){v(H(".dropLink",n.injectHere),!vn)}function qn(){j("showQuickDropLinks",vn=!vn),tn(kn,vn),Nn?bn.forEach(Un):k([5,3,bn,0,Qn,Rn])}function Gn(n,e){$(bn,Hn,n,e)}function Pn(){return[[O("fshShowExtraLinks"),yn],[O("fshShowQuickDropLinks"),qn],[O("fshSelectAllGuildLocked"),r(Gn,"guild",null)],[O("fshMove"),r(fn,bn)],[O("fshChkAll"),r(Gn,"checkAll",null)]].concat([[function(n){return n.hasAttribute("linkto")},function(n){Gn("item",n.getAttribute("linkto"))}],[r(C,"sendLink"),r(hn,Q,"Sent",".dropLink")],[r(C,"dropLink"),r(hn,R,"Dropped",".sendLink")],[r(C,"fshFolder"),r(rn,bn,Hn)]])}function Vn(n){!function(n){return!n||!n.items||!n.folders}(n)&&bn&&(Ln=!1,En=!1,Hn=n.items,An=!1,Nn=!1,jn=!1,k([5,3,bn,0,Qn,Rn]),nn(n.folders),M(e,_(Pn())))}export default function(){var s,r
D()||(T().then(Vn),x(3,xn)),"dropitems"===a.subcmd&&(s=n("form",e)[0].nextElementSibling.nextElementSibling.nextElementSibling,0!==(r=i("img",s).filter(V)).length&&t(s,'<tr><td class="fshCenter">Move selected items to: <select name="folder" id="selectFolderId" class="customselect">'+r.map(Y).join("")+'</select>&nbsp;<input type="button" class="custombutton" id="fshMove" value="Move"></td></tr>'))}
//# sourceMappingURL=injectProfileDropItems-0f1e4447.js.map
