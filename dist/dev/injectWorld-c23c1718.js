import{e,t,l as a,A as n,V as r,B as o,U as i,h as s,ac as u,v as l,i as c,o as f,ad as d,ae as h,R as m,af as p,ag as b,ah as g,a5 as v,G as y,ai as w,aj as k,ak as C,al as L,D,am as M,an as V,ao as A,N as S,ap as B,aq as H,ar as N,as as G,P as x,f as T,at as E,au as P,av as F,aw as R,ax as O,C as I,n as _,ay as j,aa as q,az as Y,x as K,aA as z,ab as U,aB as W,aC as Q,Q as J,w as X,S as Z,W as ee,a as te,J as ae,K as ne,aD as re,aE as oe,aF as ie,aG as se,aH as ue,aI as le,aJ as ce,a1 as fe,aK as de,aL as he,aM as me,aN as pe,aO as be,aP as ge,aQ as ve,aR as ye,aS as we,aT as ke,aU as Ce,aV as Le,aW as De,aX as Me,aY as Ve,aZ as Ae,a_ as $e,j as Se}from"./calfSystem-94018cd0.js"
import{n as Be}from"./numberIsNaN-b4c6efab.js"
import{r as He}from"./round-f3bae54c.js"
import{r as Ne}from"./roundToString-3630f5f8.js"
import{c as Ge}from"./createInput-cfb8faf0.js"
import{i as xe}from"./insertTextBeforeEnd-3c1378c7.js"
import"./testRange-fc41b767.js"
import{t as Te}from"./testQuant-317385a9.js"
import{c as Ee}from"./createLabel-7e7c4883.js"
import"./createUl-64d10195.js"
import"./isChecked-a7321077.js"
import{b as Pe}from"./simpleCheckbox-8df8914d.js"
import{c as Fe}from"./createTable-f30811ff.js"
import{c as Re}from"./createButton-080d3bb7.js"
import{c as Oe}from"./createStyle-9e33cb1c.js"
import{a as Ie}from"./all-e6dbe465.js"
import{a as _e}from"./allthen-55ea9059.js"
import"./rnd-a3395d81.js"
import{f as je}from"./fetchdata-a7ab50e8.js"
import{e as qe}from"./eventHandler5-88d5304b.js"
import{h as Ye}from"./hasClasses-f3871f4e.js"
import"./isSelected-9fb4d004.js"
import{g as Ke}from"./getMembrList-fc5e54d6.js"
import{d as ze,g as Ue}from"./getGroupStats-39417237.js"
import"./groupViewStats-e145c660.js"
import{g as We}from"./getMercStats-0ebd4f19.js"
import{b as Qe}from"./bitwiseAnd-88b7ba23.js"
import{r as Je}from"./reduceBuffArray-c4e63d9a.js"
import{g as Xe,a as Ze}from"./getTitanString-43e16e62.js"
import{d as et,q as tt}from"./quickbuffSuccess-2314ede9.js"
import{a as at}from"./huntingBuffs-5817ac3d.js"
let nt,rt,ot,it,st,ut,lt,ct,ft
function dt(e){return e}function ht(o){if(function(t){return e.showBuffInfo&&t.some(dt)}(o))return function(){if(nt)t(nt,!1)
else{nt=a({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const e=n("actionContainer")
r(nt,e.children[2])}return nt}()
nt&&t(nt,!0)}function mt(e,a){rt?t(rt,!1):function(e){rt=e.children[3],rt.className="fshBlue",o("CA ",rt),ot=i(),s(rt,ot),xe(rt," active")}(e),o(a.level,ot)}function pt(e,a){a?mt(e,a):rt&&t(rt,!0)}function bt(e,a){it?t(it,!1):function(e){it=e.children[4],it.className="fshRed",o("Doubler ",it),st=i(),s(it,st),xe(it," active")}(e),o(a.level,st)}function gt(e,a){a?bt(e,a):it&&t(it,!0)}function vt(e,a,n){ut?t(ut,!1):function(e){ut=e.children[2],o("Damage bonus: ",ut),lt=i(),s(ut,lt),xe(ut,"%")}(e),o(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return He(a,2).toString()}return"0"}(a,Number(n)),lt)}function yt(e,a,n){a?vt(e,a,n):ut&&t(ut,!0)}function wt(e,t){o(u(e),t)}function kt(e,a){ct?t(ct,!1):function(e){ct=e.children[1],o("Kill Streak: ",ct),ft=i(),s(ct,ft)}(e),wt(a,ft)}function Ct(e,a,n,r){a||n?kt(e,r):ct&&t(ct,!0)}function Lt(e,t){return t.name===e}function Dt(e){const{buffs:t}=GameData.player()
if(t)return t.find(l(Lt,e))}const Mt=["red","orange","yellow"]
let Vt,At
function $t(e){tt(e)&&GameData.fetch(h)}function St(){Dt("Summon Shield Imp")||et([d()],[55]).then($t)}const Bt=["imp-0","imp-1","imp-1"]
function Ht(e,a){Vt?t(Vt,!1):function(e){Vt=e.children[0],o("Shield Imps Remaining: ",Vt),At=i(),s(Vt,At),c(Vt,"&nbsp;")
const t=i({className:"xSmallLink",textContent:"Recast"})
s(Vt,t),f(t,St)}(e)
const n=function(e){return e?Number(e.stack):0}(a)
Vt.className=function(e){return Bt[e]||"fshGreen"}(n),o(n,At)}function Nt(e,a,n){a||n?Ht(e,a):Vt&&t(Vt,!0)}function Gt(e){return 0===e.type}function xt(e){return i({textContent:e})}let Tt,Et,Pt,Ft,Rt,Ot,It,_t,jt,qt
function Yt(e,a){Tt?t(Tt,!1):function(e,t){Tt=e.children[5],o("Teleport Cooldown: ",Tt),Et=xt(t.toString()),s(Tt,Et)}(e,a)}function Kt(){const e=Math.max(Math.ceil((Pt-Date.now())/1e3),0)
o(e,Et),e>0&&setTimeout(Kt,500)}function zt(e,a){a?Yt(e,a):Tt&&t(Tt,!0)}function Ut(){Ft=Dt("Death Dealer"),Rt=Dt("Doubler"),Ot=Dt("Counter Attack"),It=Dt("Summon Shield Imp"),_t=function(){const e=GameData.player().teleportCooldown
return e>1&&e}(),jt=function(){const{dynamic:e}=GameData.realm()
return m(e)&&e.some(Gt)}(),qt=GameData.player().killStreak}function Wt(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",Mt[e.text()]||"#ad8043")}(),Ut()
const e=ht([Ft,Rt,Ot,It,_t,jt])
e&&(Nt(e,It,Ft),Ct(e,Ft,jt,qt),yt(e,Ft,qt),pt(e,Ot),gt(e,Rt),zt(e,_t))}function Qt(e,t){var a
a=t.player.teleportCooldown,Et&&(Pt=Date.now()+1e3*a,Kt())}function Jt(){Wt(),$.subscribe(`${p} ${b}`,Wt),$.subscribe(g,Qt)}const Xt=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let Zt,ea=[]
function ta(e){54!==e.id&&26!==e.id||(Zt.player.buffs[e.id]=parseInt(e.level,10))}function aa(e){-1===Xt.indexOf(e.name)&&(Zt.player.enhancements[e.name]=e.value)}function na(e,t){Zt={},Zt.combat=t.response.data,Zt.combat.inventory_id&&(Zt.combat.drop=Zt.combat.item.id),Zt.player={},Zt.player.buffs={},Zt.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(ta)}(t),function(e){e.player.enhancements&&e.player.enhancements.forEach(aa)}(t),Zt.time=t.time,ea.push(Zt),C("fsh_combatLog",ea)}function ra(e,t){0===t.response.response&&na(0,t)}function oa(e){e&&(ea=e),$.subscribe(k,ra)}function ia(){y("keepLogs")&&w("fsh_combatLog").then(oa)}function sa(t){return e.doNotKillList.includes(t.trim())}function ua(e){e.classList.toggle("fshBlue",sa(D(e)))}function la(){const e=n("actionList")
L("creature",e).forEach(ua)}function ca(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(sa(e))return n("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const fa={2:function(e){return function(t,a,n,r){ca(n.passback)||e(t,a,n,r)}}}
function da(e){return function(t,a,n,r){const o=fa[t];(function(e){return e&&M(e)})(o)&&function(e){return V(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function ha(){$.subscribe(A,la),la(),function(){const e=GameData.doAction
GameData.doAction=da(e)}()}function ma(e){e.remove()}function pa(e,t){!function(e){(function(e){return e.response&&e.response.msg&&e.response.msg.startsWith("Creature did not exist at that location")})(e)&&GameData.fetch(B+H)}(t),S(".creature-4 > .quickCombat > .verbs").forEach(ma)}function ba(){$.subscribe(k,pa)}function ga(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function va(e,t,a){return Ee({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${e}`,dataset:{tipped:t},htmlFor:a})}function ya(e){const t=a({className:"fshToggle"}),n=Ge({checked:e.prefVal,id:e.checkId,type:"checkbox"})
s(t,n)
const r=va(e.onClass,e.onTip,e.checkId)
s(t,r)
const o=va(e.offClass,e.offTip,e.checkId)
return s(t,o),s(e.worldName,t),n}let wa,ka,Ca,La,Da,Ma,Va,Aa,$a
function Sa(e){return e?e.toString():"?"}function Ba(e){const t=a({className:"fshFsty"})
s(t,function(){const e=a({textContent:"Min Lvl: "})
return ka=xt(Sa(GameData.realm().minlevel)),s(e,ka),e}()),s(t,function(){const e=a({textContent:"Your Lvl: "})
return Ca=xt(Sa(GameData.player().level)),s(e,Ca),e}()),s(e,t)}function Ha(e,t,a){const n=Re({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${e}`,dataset:{tipped:t}})
return s(a,n),n}function Na(){var t
Ba(t=wa),La=Ha("fshFormGroup","Quick Create Attack Group",t),Da=Ha("fshQuickBuff","Open Quick Buff Popup",t),Ma=Ha("fshRealmMap","Open Realm Map",t),Va=Ha("fshTempleOne","Search map in Ultimate FSG",t),function(e){if(y("showSpeakerOnWorld")){const t=y("playNewMessageSound")
Aa=ya({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(wa),function(t){const a=e.huntingMode
$a=ya({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:t})}(wa)}const Ga=[[e=>e===Aa,function(){v("playNewMessageSound",!y("playNewMessageSound"))}],[e=>e===$a,function(){e.huntingMode=!e.huntingMode,v("huntingMode",e.huntingMode)}]],xa=[[e=>e===La,function(e){E(e),GameData.doAction(12,401,{},0)}],[e=>e===Da,function(){P(d())}],[e=>e===Ma,function(){window.open(`${F+R}map`,"fsMap")}],[e=>e===Va,function(){const e=GameData.realm()
window.open(`${O}realms${R}view&realm_id=${e.id}`,"mapUfsg")}]]
function Ta(){wa||(wa=a({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),Na(),f(wa,qe(xa)),T(wa,"change",qe(Ga)),x(wa,n("worldCoord")))}function Ea(e,t){ka&&t.b.minlevel&&(ga(),o(t.b.minlevel,ka))}function Pa(e,t){Ca&&o(t.b,Ca)}function Fa(){Ta(),$.subscribe(N,Ea),$.subscribe(G,Pa)}function Ra(e){return!e||!e.response||!e.response.data}let Oa,Ia,_a,ja,qa,Ya,Ka,za,Ua,Wa,Qa,Ja,Xa,Za,en,tn,an,nn,rn,on,sn,un,ln,cn,fn,dn,hn,mn,pn,bn,gn,vn,yn,wn,kn
function Cn(e){return e.player_name}function Ln(e){!function(e){ja=e.defenders.map(Cn)}(e),Oa?I("",Oa):Oa=a({className:"body"}),function(e){Ia=a({className:"fshFloatLeft fshRelicLeftDiv"}),s(Oa,Ia),e.is_owner&&s(Ia,ze(ja)),_a=Re({className:"custombutton",textContent:"Fetch Stats"}),s(Ia,_a)}(e)
const t=n("dialog-relic")
s(t,Oa)}const Dn=[e=>"lastUpdate"!==e,e=>!ja.includes(e),e=>qa[e].last_login,e=>Number(qa[e].last_login)<Ya,e=>Number(qa[e].last_login)>Ka,e=>qa[e].level<400||qa[e].level>421,e=>qa[e].level<441||qa[e].level>450]
function Mn(e,t){return t(e)}function Vn(e){return Dn.every(l(Mn,e))}function An(e){return`<a href="${q}${qa[e].id}">${e}</a>`}function $n(e){qa=e,Ya=Y-120,Ka=Y-604800
const t=j(qa).filter(Vn).map(An)
c(Oa,'<div class="fshFloatLeft fshRelicLowDiv">'+`<table class="relicT"><thead><tr><th>${t.length.toString()}`+" Offline guild members not at relic:</th></tr></thead>"+`<tbody><tr><td>${t.join(" ")}</td></tr></tbody>`+"</table></div>")}function Sn(e){_(_a)
const t=y("hideRelicOffline")
e.is_owner&&!t&&Ke(!0).then($n),c(Ia,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),kn=n("ProcessingStatus")
const r=a({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
s(Oa,r),za=n("relicCount"),Ua=n("LDPercentage"),Wa=n("LDCloaked"),Qa=n("attackValue"),Ja=n("attackValueBuffed"),Xa=n("defenseValue"),Za=n("defenseValueBuffed"),en=n("armorValue"),tn=n("armorValueBuffed"),an=n("damageValue"),nn=n("damageValueBuffed"),rn=n("hpValue"),on=n("hpValueBuffed"),sn=n("defendersCloaked"),un=n("defendersProcessed")
const o=a({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
s(Oa,o),ln=n("DC225"),cn=n("DC175"),fn=n("GroupAttack"),dn=n("GroupAttackBuffed"),hn=n("GroupDefense"),mn=n("GroupDefenseBuffed"),pn=n("GroupArmor"),bn=n("GroupArmorBuffed"),gn=n("GroupDamage"),vn=n("GroupDamageBuffed"),yn=n("GroupHP"),wn=n("GroupHPBuffed")}let Bn
function Hn(e){const t=K(e),a=z('#pCC img[src*="/relics/"]',t).length
var n
o(a,za),Bn=1===(n=a)?1.5:He(1-n/10,2),o(`${String(100*Bn)}%`,Ua)}function Nn(e,t){return e>10*t||e<t?e:10*t}const Gn=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function xn(e,t,a){e[a[0]]=Number(t[a[1]])}const Tn=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function En(e,t,a){e[a[0]]=t[a[1]]||0}function Pn(e){const t=Je(e._skills),a={}
return function(e,t){Gn.forEach(l(xn,e,t))}(a,e),function(e,t){Tn.forEach(l(En,e,t))}(a,t),a.superEliteSlayerMultiplier=He(.002*a.superEliteSlayerLevel,2),Be(a.armorValue)&&function(e){e.attackValue=Nn(e.attackBonus,e.levelValue),e.defenseValue=Nn(e.defenseBonus,e.levelValue),e.armorValue=Nn(e.armorBonus,e.levelValue),e.damageValue=Nn(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}let Fn,Rn,On,In,_n,jn,qn,Yn,Kn,zn,Un,Wn,Qn
function Jn(e){return Math.round(e*Bn)}function Xn(){wt(Fn,Qa),wt(On,Xa),wt(In,en),wt(_n,an),wt(qn,rn),o(Yn,sn),Kn+=1,o(Kn,un)}function Zn(e){const t=function(e){return Math.ceil(Un.attack*(.0025*U(e["Nightmare Visage"],0)))}(e)
Un.attack-=t,function(){const e=Math.ceil(Un.attack*zn.flinchLevel*.001)
wt(Un.attack-e,dn)}()
const a=function(e){return Math.ceil(Un.defense*(1+.001*U(e.Constitution,0)))}(e)
wt(a+t,mn),function(e){wt(Un.armor+Math.floor(Un.armor*U(e.Sanctuary,0)*.001),bn)}(e)
const n=function(e,t){return Math.ceil(t*U(e.Fortitude,0)*.001)}(e,a)
!function(e){wt(Un.hp+e,wn)}(n),function(e,t){const a=Math.ceil((Un.hp+t)*U(e["Chi Strike"],0)*.001),n=Math.ceil(Un.damage*zn.terrorizeLevel*.001)
wt(Un.damage+a-n,vn)}(e,n)}function er(){o("Processing attacking group stats ... ",kn),Wn&&(Un.attack-=Wn.attack,Un.defense-=Wn.defense,Un.armor-=Wn.armor,Un.damage-=Wn.damage,Un.hp-=Wn.hp),wt(Un.attack,fn),wt(Un.defense,hn),wt(Un.armor,pn),wt(Un.damage,gn),wt(Un.hp,yn)
const e=Je(GameData.player().buffs)
Zn(e),function(e){const t=Math.ceil(Rn*U(e.Flinch,0)*.001)
wt(Rn-t,Ja)}(e),function(e){const t=Math.ceil(jn*U(e.Terrorize,0)*.001)
wt(jn-t,nn)}(e),o("Done.",kn)}function tr(){o("Processing defending guild stats ... ",kn),Fn+=Jn(zn.attackValue),On+=Jn(zn.defenseValue),In+=Jn(zn.armorValue),_n+=Jn(zn.damageValue),qn+=Jn(zn.hpValue),Xn()
const e=Math.ceil(Fn*(.0025*zn.nightmareVisageLevel))
!function(e){Rn=Fn-e,wt(Rn,Ja)}(e)
const t=Math.ceil(On*(1+.001*zn.constitutionLevel))
!function(e,t){const a=t+e
wt(a,Za),wt(Math.ceil(.55*a),ln),wt(Math.ceil(.65*a),cn)}(e,t),wt(In+Math.floor(In*zn.sanctuaryLevel*.001),tn)
const a=qn+function(e){return Math.ceil(e*zn.fortitudeLevel*.001)}(t)
wt(a,on),function(e){jn=_n+Math.ceil(e*zn.chiStrikeLevel*.001),wt(jn)}(a),0!==zn.cloakLevel&&o("Yes",Wa),GameData.player().hasGroup&&Un?er():o("Done.",kn)}function ar(e){const t=Pn(e)
Fn+=Math.round(t.attackValue*W),On+=Math.round(t.defenseValue*W),In+=Math.round(t.armorValue*W),_n+=Math.round(t.damageValue*W),qn+=Math.round(t.hpValue*W),0!==t.cloakLevel&&(Yn+=1),Xn()}function nr(e){zn=Pn(e)}function rr(e){Un=e}function or(e){Wn=e}function ir(e){o(e.message,kn)}function sr(e){const t=K(e),a=Z('#pCC a[href*="confirmDisband"]',t)
if(!a)return
const n=function(e){const t=e.previousElementSibling.href,a=[Ue(t).then(rr)]
return function(e){return-1!==e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(e)&&a.push(We().then(or)),a}(a)
return Ie(n)}function ur(e,t){return 0===t?ee(e).then(nr):ee(e).then(ar).catch(ir)}function lr(){let e=[X({cmd:"guild",subcmd:"view",guild_id:Qn.controlled_by.guild_id}).then(Hn)]
return GameData.player().hasGroup&&e.push(X({cmd:"guild",subcmd:"groups"}).then(sr)),e=e.concat(ja.map(ur)),e}function cr(){Sn(Qn),Fn=0,On=0,In=0,_n=0,qn=0,Yn=0,Kn=0
const e=lr()
_e(e,tr)}function fr(e,t){Ra(t)||(Qn=t.response.data,Qn.defenders.length>0&&(Ln(Qn),J(_a,"click",cr)))}function dr(){$.subscribe(Q,fr)}const hr=[]
function mr(e){return Ra(e)||hr.push(e),e}function pr(e,t){return e===Number(t.response.data.id)}function br(e,t){e(t)}function gr(e,t){const a=hr.find(l(pr,e))
return a?function(e){return new Promise(t=>{te(3,br,[t,e])})}(a):je({a:1,id:e,passback:t}).then(mr)}let vr,yr,wr,kr,Cr,Lr
function Dr(e,t){return ae(ne(t,e))}function Mr(){var e
vr=GameData.player().level,e=n("statbar-character-tooltip-stats"),wr=Dr(e,ue),yr=Dr(e,re),Cr=Dr(e,oe),kr=Dr(e,ie),Lr=Dr(e,se)}function Vr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function Ar(e,t,a){return function(e){return"<table><tr><td>"+`<img src="${le}creatures/${e.image_id}.png" `+'height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>'}(e)+function(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${vr}</span>)</td></tr>`}(e,a)+function(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${yr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${wr}</span>)</td></tr>`}(e)+function(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${kr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${Cr}</span>)</td></tr>`}(e)+function(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${Lr}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}(e,t)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(Vr).join("")}(e)+function(e){return'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td>'+`</tr><tr><td colspan="4">${e.description}</td></tr>`+'<tr><td colspan="4" height="5"></td></tr></table></td></tr>'+`<tr><td class="fshCenter"><b>${e.name}</b></td></tr>`+"</table>"}(e)}function $r(t){if(!Ra(t))return function(t){const a=Math.ceil(t.hp*e.hpVariable+t.armor*e.generalVariable)
let n="fshYellow"
return Mr(),vr>t.level&&(n="fshRed"),Ar(t,a,n)}(t.response.data)}const Sr=["verb","view","tip-static"]
function Br(e,t){const a=$r(t)
e.set("content.text",a)}function Hr(e,t,a){return gr(GameData.actions()[e].data.id,e).then(l(Br,a)),"Loading..."}function Nr(e,t){fe("NewMap","CreatureInfo")
const a=de((n=t).parentNode.children).indexOf(n)
var n,r,o
e.classList.add("fshTip"),r=e,o=l(Hr,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:o},hide:{effect:!1}})}function Gr(t){if(!e.showCreatureInfo)return
const{target:a}=t,n=a.parentNode.parentNode.parentNode;(function(e,t){return Ye(Sr,e)&&!ce("fshTip",e)&&ce("creature",t)})(a,n)&&Nr(a,n)}function xr(){T(n("actionList"),"mouseover",Gr)}function Tr(){return he({subcmd:"scouttower"})}function Er(e,t){const a=e.insertCell(-1)
return[a.colSpan]=t,t[2]&&(a.className="header"),s(a,t[1]),a}function Pr(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(l(Er,e))}(n,t),n}function Fr(e,t){Pr(e,t[0],t[1])}function Rr(e,t){t.forEach(l(Fr,e))}let Or,Ir,_r,jr,qr,Yr,Kr,zr,Ur,Wr,Qr,Jr,Xr,Zr,eo,to,ao,no,ro,oo,io,so,uo,lo,co,fo,ho,mo
function po(){Ir=xt("Current"),_r=xt("Kills"),jr=xt("Member"),qr=xt("% of Total"),Yr=xt("Status"),Kr=xt("Titan HP"),zr=xt("Total"),Ur=xt("Your Guild")}function bo(){for(;ao.rows.length>7;)ao.deleteRow(7)}function go(){const e=i()
return s(e,Wr),xe(e,"/"),s(e,Qr),e}function vo(e){const t=i()
return s(t,e),xe(t,"%"),t}function yo(){ro=null,no&&!no.classList.contains("fshHide")&&(t(no,!0),o("",Wr),o("",Qr),o("",Jr),o("",Xr),o("",Zr),I("",eo),I("",to),bo())}function wo(e){return 0===e.type&&(ro=e.base_creature_id,!0)}function ko(){if(no)t(no,!1)
else{const e=n("actionContainer")
no=a({className:"fshActionBox titanInfo"}),Wr=i(),Qr=i(),Jr=i(),Xr=i(),Zr=i(),eo=i(),to=i(),ao=Fe({className:"fshCenter"}),po(),Rr(ao,[[[[2,Kr,!0],[4,Ur,!0]]],[[[2,go()],[4,Jr]]],[[[2,Ir,!0],[4,vo(Xr)]],!0],[[[2,zr,!0],[4,vo(Zr)]],!0],[[[2,Yr,!0],[4,eo]],!0],[[[6,to]]],[[[2,jr,!0],[2,_r,!0],[2,qr,!0]]]]),s(no,ao),s(e,no)}}function Co(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(be+1e3*e)
return`${me(t.getHours())}:${me(t.getMinutes())} ${me(t.getDate())}/${pe[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function Lo(e){o(e.current_hp,Wr),o(e.max_hp,Qr),o(e.kills,Jr),o(function(e){return Ne(Xe(e.max_hp-e.current_hp,e.kills),2)}(e),Xr),o(function(e){return Ne(100*e.kills/e.max_hp,2)}(e),Zr),I(function(e){return Ze(e.kills,e.max_hp,e.current_hp)}(e),eo),I(Co(e.cooldown),to)}function Do(e,t){return[[[2,xt(t.player.name)],[2,xt(t.kills.toString())],[2,xt(`${Ne(100*t.kills/e.kills,2)}%`)]]]}function Mo(e){return e.realm&&e.creature.base_id===ro&&e.realm===Or}function Vo(e){const t=e.find(Mo)
t&&(Lo(t),function(e){if(bo(),!e.contributors)return
const t=e.contributors.map(l(Do,e))
Rr(ao,t)}(t))}function Ao(t){return e.showTitanInfo&&m(t)&&t.some(wo)}function $o(e,t){(function(e){return e.s&&m(e.r)})(t)&&(Vo(t.r),Ao(GameData.realm().dynamic)?oo=window.setTimeout(e,3e4):yo())}function So(){Tr().then(l($o,So))}function Bo(e){oo&&(window.clearTimeout(oo),oo=null),Ao(e)?(ko(),So()):yo()}function Ho(e){var t
e.dynamic&&(t=e.name,Or=t,Bo(e.dynamic))}function No(e,t){(function(e){return e.realm&&e.realm.name})(t)&&Ho(t.realm)}function Go(){window.initialGameData&&No(0,window.initialGameData),$.subscribe(`${ge} ${ve}`,No)}function xo(e){const t=e.response.response,a=e.response.msg
let n
if(0!==t){const e=a.indexOf("<")
n=-1!==e?a.substring(0,e):a}else n=`You purchased ${e.response.data.name} for ${u(e.response.data.cost)} gold.`
c(ho,`${n}<br>`)}function To(){GameData.doAction(14,3,{id:io.id,item_id:io.itemId},0),uo.close()}function Eo(){const e=Te(co.value)
if(!e)return
const t=[]
for(let a=1;a<e;a+=1)t.push(je({a:14,d:0,id:io.id,item_id:io.itemId}).then(xo))
_e(t,To)}function Po(){lo?o("",ho):(lo=a({className:"fshClear",textContent:"Select how many to quick-buy:"}),co=Ge({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),s(lo,co),fo=Re({textContent:"Quick-buy"}),f(fo,Eo),s(lo,fo),ho=a(),s(lo,ho),s(so,lo))}function Fo(e,t){io=t,so=so||n("shopDialogConfirm"),so&&(uo=uo||$(so).data("hcsWorldDialogShopConfirm"),uo&&Po())}function Ro(){$.subscribe(ye,Fo)}function Oo(e){mo[e.name]?mo[e.name].seen&&(mo[e.name].seen+=1):(mo[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,mo[e.name]))}function Io(e,t,a){return t?e(t,a):a}function _o(e,t){const a=e||{}
return a.min=Io(Math.min,a.min,t),a.max=Io(Math.max,a.max,t),a}const jo=["attack","armor","damage","defense","hp"]
function qo(e,t,a){const n=_o(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function Yo(e,t){e[t.name]=_o(e[t.name],Number(t.value))}function Ko(e){mo||(mo={}),Oo(e),function(e,t){jo.forEach(l(qo,e,t))}(e,mo[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(l(Yo,t.enhancements)))}(e,mo[e.name]),C("fsh_monsterLog",mo)}function zo(e){mo=e||{}}const Uo=[]
function Wo(t){var a
Ra(t)||(fe("NewMap","MonsterLog"),a=t.response.data,e.showMonsterLog&&Ko(a))}function Qo(e,t){return e.id===t.id}function Jo(e,t){6!==e.type||function(e){if(Uo.find(l(Qo,e.data)))return!0
Uo.push(e.data)}(e)||gr(e.data.id,t).then(Wo)}function Xo(){e.showMonsterLog&&GameData.actions().forEach(Jo)}function Zo(){w("fsh_monsterLog").then(zo),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",Xo),Xo()}function ei(e){return he(we({subcmd:"groups"},e))}function ti(e){return function(e){return ei({subcmd2:"viewstats",group_id:e})}(e)}function ai(){return ei({subcmd2:"view"})}function ni(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const ri=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>`Player 1 hits${ni(e)}`],[e=>e.playerHits>1,e=>`Player > 1 hits${ni(e)}`]]
function oi(e,t){return t[0](e)}function ii(e){e.playerHits=function(e){return"-"===e.numberOfCreatureHitsTillDead?e.numberOfHitsRequired:function(e){return"-"===e.numberOfHitsRequired||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}(e)?"-":e.numberOfHitsRequired}(e),e.creatureHits=function(e){return"-"===e.numberOfHitsRequired?e.numberOfCreatureHitsTillDead:function(e){return"-"===e.numberOfCreatureHitsTillDead||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}(e)?"-":e.numberOfCreatureHitsTillDead}(e),e.fightStatus=function(e){const t=ri.find(l(oi,e))
return t?t[1](e):"Unknown"}(e)}function si(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function ui(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),si(e)}function li(e){const t=function(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${Math.floor(e.creature.defense*e.player.darkCurseLevel*.002)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-e.creature.defense*e.player.darkCurseLevel*.002
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}function ci(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function fi(e){ci(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function di(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&fi(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){ci(e),function(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==e.lowestCALevelToStillHit&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}(e),function(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==e.lowestCALevelToStillKill&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(e)}(e)}function hi(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e)
const t=function(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}(e)
if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}function mi(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function pi(e){e.overallDefenseValue=mi(e)+Math.floor(mi(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(mi(e)*e.player.constitutionLevel*.001)}<br>`)}(e),function(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function bi(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>`+`CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}let gi,vi,yi,wi,ki,Ci,Li,Di,Mi,Vi
function Ai(){return sa(vi)?"Remove from do not kill list":"Add to the do not kill list"}function $i(){o(Ai(),yi)}function Si(){const t=e.doNotKillList.indexOf(vi);-1===t?e.doNotKillList.push(vi):e.doNotKillList.splice(t,1),$i(),v("doNotKillList",e.doNotKillList.join()),la()}function Bi(){yi?$i():function(){yi=Re({className:"fshBl",textContent:Ai(),type:"button"})
const e=a({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
s(e,yi),s(gi,e),f(yi,Si)}()}function Hi(e,t){!function(e){if(!gi){const t=ne("body",e)
1===t.length&&([gi]=t)}}(t),gi&&(vi=e.trim(),Bi())}function Ni(){Ci||(ki||(ki=a(),s(wi,ki),s(wi,a({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),Ci=a(),s(ki,Ci))}function Gi(e){Ni(),I(e,Ci)}function xi(e){Li||(Ni(),Li=a(),s(ki,Li)),I(e,Li)}function Ti(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Ei(t,a,n){const r={}
r.callback=n,r.player=Pn(a),function(t){t.combatEvaluatorBias=e.combatEvaluatorBias,t.attackVariable=1.1053,t.generalVariable=e.generalVariable,t.hpVariable=e.hpVariable}(r),r.creature=Ti(t.response.data,r.player.superEliteSlayerMultiplier),function(e){bi(e),li(e),hi(e),pi(e),ui(e),ii(e),di(e)}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${function(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(e){return e.callback.groupExists?"Group ":""}(e)}Combat Evaluation</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`Will I hit it? </td><td align="left">${function(e){return e.hitByHowMuch>0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">`+`Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`# Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right">`+`<span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`Will I be hit? </td><td align="left">${function(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">`+`Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`# Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right">`+`<span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`# Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333">`+`# Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3">'+`<span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}(e)}</tbody></table>`}(r),n.groupExists?xi(r.evaluatorHTML):Gi(r.evaluatorHTML)}function Pi(e){return e.members[0].name===d()}function Fi(e){if(m(e.r))return e.r.find(Pi).id}function Ri(e,t,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Ei(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Oi(e,t,a){a&&ti(a).then(l(Ri,e,t))}function Ii(e,t){e.player.hasGroup&&function(e,t){ai().then(Fi).then(l(Oi,e,t))}(e,t),Ei(e,t,{groupExists:!1})}function _i(e,t){wi||(wi=n("dialog-viewcreature")),wi&&(Gi(""),xi(""),function(e){return e.response&&e.response.data}(t)&&(Hi(t.response.data.name,wi),Ce(!0).then(l(Ii,t))))}function ji(){$.subscribe(ke,_i)}function qi(){const t=[,[e.buffs,e.buffsName],[e.buffs2,e.buffs2Name],[e.buffs3,e.buffs3Name]][e.enabledHuntingMode]
m(t)&&([Di,Mi]=t)}function Yi(t){"enabledHuntingMode"===t.target.name&&(e.enabledHuntingMode=t.target.value,v("enabledHuntingMode",e.enabledHuntingMode),qi(),GameData.fetch(h))}function Ki(e){const t=ne("verbs",e)
1===t.length&&_(t[0])}function zi(){if(!Vi)return
const e=n("actionList")
L("player",e).forEach(Ki)}const Ui={hideSubLvlCreature:function(){e.hideSubLvlCreature=!e.hideSubLvlCreature,v("hideSubLvlCreature",e.hideSubLvlCreature),GameData.fetch(H)},hidePlayerActions:function(){Vi=!Vi,v("hidePlayerActions",Vi),GameData.fetch(H)},showCreatureInfo:function(){e.showCreatureInfo=!e.showCreatureInfo,v("showCreatureInfo",e.showCreatureInfo)},showHuntingBuffs:function(){e.showBuffs=!e.showBuffs,v("showHuntingBuffs",e.showBuffs),GameData.fetch(h)},showMonsterLog:function(){e.showMonsterLog=!e.showMonsterLog,v("showMonsterLog",e.showMonsterLog)},showTitanInfo:function(){e.showTitanInfo=!e.showTitanInfo,v("showTitanInfo",e.showTitanInfo),Bo(GameData.realm().dynamic)},showBuffInfo:function(){e.showBuffInfo=!e.showBuffInfo,v("showBuffInfo",e.showBuffInfo),Wt()}}
function Wi(e){const t=Ui[e.target.name]
M(t)&&(e.target.blur(),t(e))}function Qi(){const e=a({className:"fshCenter fshFten"}),t=a({id:"fshWorldPrefs",innerHTML:`${Pe("showCreatureInfo")}&nbsp;&nbsp;${Pe("showMonsterLog")}&nbsp;&nbsp;${Pe("showTitanInfo")}&nbsp;&nbsp;${Pe("showBuffInfo")}<br>${Pe("hideSubLvlCreature")}&nbsp;&nbsp;${Pe("hidePlayerActions")}&nbsp;&nbsp;${at()}`})
f(t,Wi),T(t,"change",Yi),s(e,t)
const r=a()
s(e,r)
const o=n("worldContainerBelow").children[0]
return x(e,o),r}function Ji(e,t){return e[t.name]=!0,e}function Xi(e,t,a){return e[a.trim()]||t.push(a),t}function Zi(e){I("",e)}function es(e,t){const a=t.b.reduce(Ji,{}),n=Di.reduce(l(Xi,a),[])
n.length>0?function(e,t){I(`You are missing some ${Mi} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):Zi(e)}function ts(t,a,n){Di&&function(t,a,n){e.showBuffs?es(t,n):Zi(t)}(t,0,n)}const as=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function ns(){var t
e.combatEvaluatorBias=y("combatEvaluatorBias"),e.generalVariable=(t=e.combatEvaluatorBias,as[t]?as[t].generalVariable:1.1053),e.hpVariable=function(e){return as[e]?as[e].hpVariable:1.1}(e.combatEvaluatorBias)}function rs(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function os(e){const t=Le(e)
return function(e){return!e||!e.actions||0===e.actions.length}(t)?e:(t.actions=t.actions.filter(l(rs,function(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}(t))),JSON.stringify(t))}function is(t,a){e.hideSubLvlCreature&&function(e){return e.data&&e.data.d&&Qe(e.data.d,H)}(a)&&(t.dataFilter=os)}function ss(t){e[t[0]]=De(t[1])}function us(t){e[t]=De(t)}function ls(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(ss),["doNotKillList"].forEach(us)}function cs(t){e[t[0]]=y(t[1])}function fs(t){e[t]=y(t)}function ds(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(cs),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(fs)}function hs(){ns(),ls(),ds()
const t=Qi()
$.ajaxPrefilter("JSON",is),e.hideSubLvlCreature&&GameData.fetch(H),function(t){qi()
const a=l(ts,t)
$.subscribe(p,a),e.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(t),Vi=y("hidePlayerActions"),$.subscribe(A,zi),zi()}function ms(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const ps=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function bs(e,t){var a
y(e)&&(a=t+1,$.subscribe(A,l(ms,a)),ms(t+1))}function gs(){ps.forEach(bs)}function vs(){y("enableCreatureColoring")&&s(document.body,Oe("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))}function ys(e,t){"ACT_REPAIR"===t&&GameData.fetch($e+h+B+H)}function ws(){$.subscribe(Ae,ys)}function ks(){$("#messageCenter").worldMessageCenter({offset:"0 60"})}function Cs(){E("#mapTooltip")}function Ls(e){E(e.target)}function Ds(){f(n("buffList"),Ls)}export default function(){Se()&&n("worldPage")&&window.GameData&&Me([hs,Ve,ji,gs,vs,ha,Zo,ws,ia,Go,Ro,dr,ks,Cs,Fa,Jt,Ds,xr,ba])}
//# sourceMappingURL=injectWorld-c23c1718.js.map
