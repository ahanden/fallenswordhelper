import{e,t,l as a,A as n,V as r,B as o,U as i,h as s,ac as u,v as l,i as c,o as f,ad as d,ae as h,R as m,af as p,ag as b,ah as g,a5 as v,G as y,ai as w,aj as k,ak as C,al as L,D,am as M,an as V,ao as A,N as S,ap as B,aq as H,ar as N,as as G,P as x,f as T,at as E,au as P,av as F,aw as R,ax as O,C as I,n as _,ay as j,aa as q,az as Y,x as K,aA as z,ab as U,aB as W,aC as Q,Q as J,w as X,S as Z,W as ee,a as te,J as ae,K as ne,aD as re,aE as oe,aF as ie,aG as se,aH as ue,aI as le,aJ as ce,a1 as fe,aK as de,aL as he,aM as me,aN as pe,aO as be,aP as ge,aQ as ve,aR as ye,aS as we,aT as ke,aU as Ce,aV as Le,aW as De,aX as Me,aY as Ve,aZ as Ae,a_ as $e,j as Se}from"./calfSystem-8dc0fa4b.js"
import{n as Be}from"./numberIsNaN-73f607dc.js"
import{r as He}from"./round-98f16be7.js"
import{r as Ne}from"./roundToString-f0f1b4b6.js"
import{c as Ge}from"./createInput-29f46dac.js"
import{i as xe}from"./insertTextBeforeEnd-6e2a79ca.js"
import"./testRange-f5543cbb.js"
import{t as Te}from"./testQuant-df90ef77.js"
import{c as Ee}from"./createLabel-fd3e7486.js"
import"./createUl-ea106be9.js"
import"./isChecked-1bdf83c2.js"
import{b as Pe}from"./simpleCheckbox-1f751e80.js"
import{c as Fe}from"./createTable-5d1d98c3.js"
import{c as Re}from"./createButton-0d666b00.js"
import{c as Oe}from"./createStyle-fc573314.js"
import{a as Ie}from"./all-905003de.js"
import{a as _e}from"./allthen-88a2d4fe.js"
import"./rnd-e3066900.js"
import{f as je}from"./fetchdata-bfcd331e.js"
import{e as qe}from"./eventHandler5-31d45a93.js"
import{h as Ye}from"./hasClasses-f2e27da8.js"
import"./isSelected-05c2993c.js"
import{g as Ke}from"./getMembrList-3cebc84a.js"
import{d as ze,g as Ue}from"./getGroupStats-19e5bf54.js"
import"./groupViewStats-ed114cc2.js"
import{g as We}from"./getMercStats-a2ebdb2c.js"
import{b as Qe}from"./bitwiseAnd-c1852f0f.js"
import{r as Je}from"./reduceBuffArray-3651d455.js"
import{g as Xe,a as Ze}from"./getTitanString-c79af332.js"
import{d as et,q as tt}from"./quickbuffSuccess-1c75a552.js"
import{a as at}from"./huntingBuffs-183e7768.js"
let nt,rt,ot,it,st,ut,lt,ct,ft
function dt(e){return e}function ht(o){if(function(t){return e.showBuffInfo&&t.some(dt)}(o))return function(){if(nt)t(nt,!1)
else{nt=a({className:"fshActionBox",innerHTML:"<div></div><div></div><div></div><div></div><div></div><div></div>"})
const e=n("actionContainer")
r(nt,e.children[2])}return nt}()
nt&&t(nt,!0)}function mt(e,a){rt?t(rt,!1):function(e){rt=e.children[3],rt.className="fshBlue",o("CA ",rt),ot=i(),s(rt,ot),xe(rt," active")}(e),o(a.level,ot)}function pt(e,a){a?mt(e,a):rt&&t(rt,!0)}function bt(e,a){it?t(it,!1):function(e){it=e.children[4],it.className="fshRed",o("Doubler ",it),st=i(),s(it,st),xe(it," active")}(e),o(a.level,st)}function gt(e,a){a?bt(e,a):it&&t(it,!0)}function vt(e,a,n){ut?t(ut,!1):function(e){ut=e.children[2],o("Damage bonus: ",ut),lt=i(),s(ut,lt),xe(ut,"%")}(e),o(function(e,t){if(e){const a=Math.min(.01*Math.round(Math.floor(t/5)*Number(e.level)),20)
return He(a,2).toString()}return"0"}(a,Number(n)),lt)}function yt(e,a,n){a?vt(e,a,n):ut&&t(ut,!0)}function wt(e,t){o(u(e),t)}function kt(e,a){ct?t(ct,!1):function(e){ct=e.children[1],o("Kill Streak: ",ct),ft=i(),s(ct,ft)}(e),wt(a,ft)}function Ct(e,a,n,r){a||n?kt(e,r):ct&&t(ct,!0)}function Lt(e,t){return t.name===e}function Dt(e){const{buffs:t}=GameData.player()
if(t)return t.find(l(Lt,e))}const Mt=["red","orange","yellow"]
let Vt,At
function $t(e){tt(e)&&GameData.fetch(h)}function St(){Dt("Summon Shield Imp")||et([d()],[55]).then($t)}const Bt=["imp-0","imp-1","imp-1"]
function Ht(e,a){Vt?t(Vt,!1):function(e){Vt=e.children[0],o("Shield Imps Remaining: ",Vt),At=i(),s(Vt,At),c(Vt,"&nbsp;")
const t=i({className:"xSmallLink",textContent:"Recast"})
s(Vt,t),f(t,St)}(e)
const n=function(e){return e?Number(e.stack):0}(a)
Vt.className=function(e){return Bt[e]||"fshGreen"}(n),o(n,At)}function Nt(e,a,n){a||n?Ht(e,a):Vt&&t(Vt,!0)}function Gt(e){return 0===e.type}function xt(e){return i({textContent:e})}let Tt,Et,Pt,Ft,Rt,Ot,It,_t,jt,qt
function Yt(e,a){Tt?t(Tt,!1):function(e,t){Tt=e.children[5],o("Teleport Cooldown: ",Tt),Et=xt(t.toString()),s(Tt,Et)}(e,a)}function Kt(){const e=Math.max(Math.ceil((Pt-Date.now())/1e3),0)
o(e,Et),e>0&&setTimeout(Kt,500)}function zt(e,a){a?Yt(e,a):Tt&&t(Tt,!0)}function Ut(){Ft=Dt("Death Dealer"),Rt=Dt("Doubler"),Ot=Dt("Counter Attack"),It=Dt("Summon Shield Imp"),_t=function(){const e=GameData.player().teleportCooldown
return e>1&&e}(),jt=function(){const{dynamic:e}=GameData.realm()
return m(e)&&e.some(Gt)}(),qt=GameData.player().killStreak}function Wt(){!function(){const e=$("#actionlist-shield-imp")
1===e.length&&e.css("background-color",Mt[e.text()]||"#ad8043")}(),Ut()
const e=ht([Ft,Rt,Ot,It,_t,jt])
e&&(Nt(e,It,Ft),Ct(e,Ft,jt,qt),yt(e,Ft,qt),pt(e,Ot),gt(e,Rt),zt(e,_t))}function Qt(e,t){var a
a=t.player.teleportCooldown,Et&&(Pt=Date.now()+1e3*a,Kt())}function Jt(){Wt(),$.subscribe(`${p} ${b}`,Wt),$.subscribe(g,Qt)}const Xt=["Breaker","Protection","Master Thief","Protect Gold","Disarm","Duelist","Thievery","Master Blacksmith","Master Crafter","Fury Caster","Master Inventor","Sustain"]
let Zt,ea=[]
function ta(e){54!==e.id&&26!==e.id||(Zt.player.buffs[e.id]=parseInt(e.level,10))}function aa(e){-1===Xt.indexOf(e.name)&&(Zt.player.enhancements[e.name]=e.value)}function na(e,t){Zt={},Zt.combat=t.response.data,Zt.combat.inventory_id&&(Zt.combat.drop=Zt.combat.item.id),Zt.player={},Zt.player.buffs={},Zt.player.enhancements={},function(e){e.player.buffs&&e.player.buffs.forEach(ta)}(t),function(e){e.player.enhancements&&e.player.enhancements.forEach(aa)}(t),Zt.time=t.time,ea.push(Zt),C("fsh_combatLog",ea)}function ra(e,t){0===t.response.response&&na(0,t)}function oa(e){e&&(ea=e),$.subscribe(k,ra)}function ia(){y("keepLogs")&&w("fsh_combatLog").then(oa)}function sa(t){return e.doNotKillList.includes(t.trim())}function ua(e){e.classList.toggle("fshBlue",sa(D(e)))}function la(){const e=n("actionList")
L("creature",e).forEach(ua)}function ca(e){const t=GameData.actions()[e]
if(t)return function(e,t){if(sa(e))return n("actionList").children[t].children[0].children[1].classList.remove("loading"),!0}(t.data.name,e)}const fa={2:function(e){return function(t,a,n,r){ca(n.passback)||e(t,a,n,r)}}}
function da(e){return function(t,a,n,r){const o=fa[t];(function(e){return e&&M(e)})(o)&&function(e){return V(e)||0===e}(r)?o(e)(t,a,n,r):e(t,a,n,r)}}function ha(){$.subscribe(A,la),la(),function(){const e=GameData.doAction
GameData.doAction=da(e)}()}function ma(e){e.remove()}function pa(e,t){!function(e){(function(e){return e.response&&e.response.msg&&e.response.msg.startsWith("Creature did not exist at that location")})(e)&&GameData.fetch(B+H)}(t),S(".creature-4 > .quickCombat > .verbs").forEach(ma)}function ba(){window.GameController&&GameController.Realm&&!GameController.Realm.footprintTileList&&(GameController.Realm.footprintTileList=[])}function ga(e,t,a){return Ee({className:`fshCurveEle fshCurveLbl fshPoint tip-static ${e}`,dataset:{tipped:t},htmlFor:a})}function va(e){const t=a({className:"fshToggle"}),n=Ge({checked:e.prefVal,id:e.checkId,type:"checkbox"})
s(t,n)
const r=ga(e.onClass,e.onTip,e.checkId)
s(t,r)
const o=ga(e.offClass,e.offTip,e.checkId)
return s(t,o),s(e.worldName,t),n}let ya,wa,ka,Ca,La,Da,Ma,Va,Aa
function $a(e){return e?e.toString():"?"}function Sa(e){const t=a({className:"fshFsty"})
s(t,function(){const e=a({textContent:"Min Lvl: "})
return wa=xt($a(GameData.realm().minlevel)),s(e,wa),e}()),s(t,function(){const e=a({textContent:"Your Lvl: "})
return ka=xt($a(GameData.player().level)),s(e,ka),e}()),s(e,t)}function Ba(e,t,a){const n=Re({className:`fshCurveEle fshCurveBtn fshPoint tip-static ${e}`,dataset:{tipped:t}})
return s(a,n),n}function Ha(){var t
Sa(t=ya),Ca=Ba("fshFormGroup","Quick Create Attack Group",t),La=Ba("fshQuickBuff","Open Quick Buff Popup",t),Da=Ba("fshRealmMap","Open Realm Map",t),Ma=Ba("fshTempleOne","Search map in Ultimate FSG",t),function(e){if(y("showSpeakerOnWorld")){const t=y("playNewMessageSound")
Va=va({prefVal:t,checkId:"fshSoundCheck",onClass:"soundOn",onTip:"Turn Off Sound when you have a new log message",offClass:"soundOff",offTip:"Turn On Sound when you have a new log message",worldName:e})}}(ya),function(t){const a=e.huntingMode
Aa=va({prefVal:a,checkId:"fshHuntCheck",onClass:"huntOn",onTip:"Hunting mode is ON",offClass:"huntOff",offTip:"Hunting mode is OFF",worldName:t})}(ya)}const Na=[[e=>e===Va,function(){v("playNewMessageSound",!y("playNewMessageSound"))}],[e=>e===Aa,function(){e.huntingMode=!e.huntingMode,v("huntingMode",e.huntingMode)}]],Ga=[[e=>e===Ca,function(e){E(e),GameData.doAction(12,401,{},0)}],[e=>e===La,function(){P(d())}],[e=>e===Da,function(){window.open(`${F+R}map`,"fsMap")}],[e=>e===Ma,function(){const e=GameData.realm()
window.open(`${O}realms${R}view&realm_id=${e.id}`,"mapUfsg")}]]
function xa(){ya||(ya=a({className:"fshCurveContainer",id:"fshWorldButtonContainer"}),Ha(),f(ya,qe(Ga)),T(ya,"change",qe(Na)),x(ya,n("worldCoord")))}function Ta(e,t){wa&&t.b.minlevel&&(ba(),o(t.b.minlevel,wa))}function Ea(e,t){ka&&o(t.b,ka)}function Pa(){xa(),$.subscribe(N,Ta),$.subscribe(G,Ea)}function Fa(e){return!e||!e.response||!e.response.data}let Ra,Oa,Ia,_a,ja,qa,Ya,Ka,za,Ua,Wa,Qa,Ja,Xa,Za,en,tn,an,nn,rn,on,sn,un,ln,cn,fn,dn,hn,mn,pn,bn,gn,vn,yn,wn
function kn(e){return e.player_name}function Cn(e){!function(e){_a=e.defenders.map(kn)}(e),Ra?I("",Ra):Ra=a({className:"body"}),function(e){Oa=a({className:"fshFloatLeft fshRelicLeftDiv"}),s(Ra,Oa),e.is_owner&&s(Oa,ze(_a)),Ia=Re({className:"custombutton",textContent:"Fetch Stats"}),s(Oa,Ia)}(e)
const t=n("dialog-relic")
s(t,Ra)}const Ln=[e=>"lastUpdate"!==e,e=>!_a.includes(e),e=>ja[e].last_login,e=>Number(ja[e].last_login)<qa,e=>Number(ja[e].last_login)>Ya,e=>ja[e].level<400||ja[e].level>421,e=>ja[e].level<441||ja[e].level>450]
function Dn(e,t){return t(e)}function Mn(e){return Ln.every(l(Dn,e))}function Vn(e){return`<a href="${q}${ja[e].id}">${e}</a>`}function An(e){ja=e,qa=Y-120,Ya=Y-604800
const t=j(ja).filter(Mn).map(Vn)
c(Ra,'<div class="fshFloatLeft fshRelicLowDiv">'+`<table class="relicT"><thead><tr><th>${t.length.toString()}`+" Offline guild members not at relic:</th></tr></thead>"+`<tbody><tr><td>${t.join(" ")}</td></tr></tbody>`+"</table></div>")}function $n(e){_(Ia)
const t=y("hideRelicOffline")
e.is_owner&&!t&&Ke(!0).then(An),c(Oa,'<table class="relicT"><thead><tr><th colspan="2">Processing</th></tr></thead><tbody><tr><td class="fshGreen" colspan="2" id="ProcessingStatus">Parsing defending guild stats ...</td></tr></tbody><thead><tr><th colspan="2">Assumptions</th></tr></thead><tbody><tr><td colspan="2" class="fshGrey">Above calculations include Constitution, Fortitude, Nightmare Visage, Chi Strike, Sanctuary, Terrorize and Flinch bonus calculations (in that order) on both the defending group and attacking group.</td></tr></tbody></table>'),wn=n("ProcessingStatus")
const r=a({className:"fshFloatLeft fshRelicMidDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Defending Guild Stats</th></tr></thead><tbody><tr><td>Relic Count:</td><td id="relicCount">0</td></tr><tr><td>Lead Defender Bonus:</td><td id="LDPercentage">0</td></tr><tr><td>Lead Defender Cloaked:</td><td id="LDCloaked">No</td></tr></tbody><thead><tr><th colspan="2">Other Defender Stats</th></tr></thead><tbody><tr><td>Raw Attack:</td><td class="fshGrey" id="attackValue">0</td></tr><tr><td>Attack w/ buffs:</td><td id="attackValueBuffed">0</td></tr><tr><td>Raw Defense:</td><td class="fshGrey" id="defenseValue">0</td></tr><tr><td>Defense w/buffs:</td><td id="defenseValueBuffed">0</td></tr><tr><td>Raw Armor:</td><td class="fshGrey" id="armorValue">0</td></tr><tr><td>Armor w/ buffs:</td><td id="armorValueBuffed">0</td></tr><tr><td>Raw Damage:</td><td class="fshGrey" id="damageValue">0</td></tr><tr><td>Damage w/ buffs:</td><td id="damageValueBuffed">0</td></tr><tr><td>Raw HP:</td><td class="fshGrey" id="hpValue">0</td></tr><tr><td>HP w/ buffs:</td><td id="hpValueBuffed">0</td></tr><tr><td>Cloaked:</td><td id="defendersCloaked">0</td></tr><tr><td>Processed:</td><td id="defendersProcessed">0</td></tr></tbody></table>'})
s(Ra,r),Ka=n("relicCount"),za=n("LDPercentage"),Ua=n("LDCloaked"),Wa=n("attackValue"),Qa=n("attackValueBuffed"),Ja=n("defenseValue"),Xa=n("defenseValueBuffed"),Za=n("armorValue"),en=n("armorValueBuffed"),tn=n("damageValue"),an=n("damageValueBuffed"),nn=n("hpValue"),rn=n("hpValueBuffed"),on=n("defendersCloaked"),sn=n("defendersProcessed")
const o=a({className:"fshFloatLeft fshRelicRightDiv",innerHTML:'<table class="relicT relicS"><thead><tr><th colspan="2">Adjusted defense values</th></tr></thead><tbody><tr><td>DC225:</td><td id="DC225">0</td></tr><tr><td>DC175:</td><td id="DC175">0</td></tr><tr><td colspan="2">&nbsp;</td></tr></tbody><thead><tr><th colspan="2">Attacking Group Stats</th></tr></thead><tbody><tr><td>Raw Group Attack:</td><td class="fshGrey" id="GroupAttack"></td></tr><tr><td>Group Attack w/ buffs:</td><td id="GroupAttackBuffed"></td></tr><tr><td>Raw Group Defense:</td><td class="fshGrey" id="GroupDefense"></td></tr><tr><td>Group Defense w/ buffs:</td><td id="GroupDefenseBuffed"></td></tr><tr><td>Raw Group Armor:</td><td class="fshGrey" id="GroupArmor"></td></tr><tr><td>Group Armor w/ buffs:</td><td id="GroupArmorBuffed"></td></tr><tr><td>Raw Group Damage:</td><td class="fshGrey" id="GroupDamage"></td></tr><tr><td>Group Damage w/ buffs:</td><td id="GroupDamageBuffed"></td></tr><tr><td>Raw Group HP:</td><td class="fshGrey" id="GroupHP"></td></tr><tr><td>Group HP w/ buffs:</td><td id="GroupHPBuffed"></td></tr></tbody></table>'})
s(Ra,o),un=n("DC225"),ln=n("DC175"),cn=n("GroupAttack"),fn=n("GroupAttackBuffed"),dn=n("GroupDefense"),hn=n("GroupDefenseBuffed"),mn=n("GroupArmor"),pn=n("GroupArmorBuffed"),bn=n("GroupDamage"),gn=n("GroupDamageBuffed"),vn=n("GroupHP"),yn=n("GroupHPBuffed")}let Sn
function Bn(e){const t=K(e),a=z('#pCC img[src*="/relics/"]',t).length
var n
o(a,Ka),Sn=1===(n=a)?1.5:He(1-n/10,2),o(`${String(100*Sn)}%`,za)}function Hn(e,t){return e>10*t||e<t?e:10*t}const Nn=[["levelValue","level"],["attackValue","attack"],["attackBonus","bonus_attack"],["defenseValue","defense"],["defenseBonus","bonus_defense"],["armorValue","armor"],["armorBonus","bonus_armor"],["damageValue","damage"],["damageBonus","bonus_damage"],["hpValue","hp"],["hpBonus","bonus_hp"],["killStreakValue","killstreak"]]
function Gn(e,t,a){e[a[0]]=Number(t[a[1]])}const xn=[["counterAttackLevel","Counter Attack"],["doublerLevel","Doubler"],["deathDealerLevel","Death Dealer"],["darkCurseLevel","Dark Curse"],["holyFlameLevel","Holy Flame"],["constitutionLevel","Constitution"],["sanctuaryLevel","Sanctuary"],["flinchLevel","Flinch"],["nightmareVisageLevel","Nightmare Visage"],["superEliteSlayerLevel","Super Elite Slayer"],["fortitudeLevel","Fortitude"],["chiStrikeLevel","Chi Strike"],["terrorizeLevel","Terrorize"],["barricadeLevel","Barricade"],["reignOfTerrorLevel","Reign Of Terror"],["anchoredLevel","Anchored"],["severeConditionLevel","Severe Condition"],["entrenchLevel","Entrench"],["cloakLevel","Cloak"]]
function Tn(e,t,a){e[a[0]]=t[a[1]]||0}function En(e){const t=Je(e._skills),a={}
return function(e,t){Nn.forEach(l(Gn,e,t))}(a,e),function(e,t){xn.forEach(l(Tn,e,t))}(a,t),a.superEliteSlayerMultiplier=He(.002*a.superEliteSlayerLevel,2),Be(a.armorValue)&&function(e){e.attackValue=Hn(e.attackBonus,e.levelValue),e.defenseValue=Hn(e.defenseBonus,e.levelValue),e.armorValue=Hn(e.armorBonus,e.levelValue),e.damageValue=Hn(e.damageBonus,e.levelValue),e.hpValue=e.hpBonus}(a),a}let Pn,Fn,Rn,On,In,_n,jn,qn,Yn,Kn,zn,Un,Wn
function Qn(e){return Math.round(e*Sn)}function Jn(){wt(Pn,Wa),wt(Rn,Ja),wt(On,Za),wt(In,tn),wt(jn,nn),o(qn,on),Yn+=1,o(Yn,sn)}function Xn(e){const t=function(e){return Math.ceil(zn.attack*(.0025*U(e["Nightmare Visage"],0)))}(e)
zn.attack-=t,function(){const e=Math.ceil(zn.attack*Kn.flinchLevel*.001)
wt(zn.attack-e,fn)}()
const a=function(e){return Math.ceil(zn.defense*(1+.001*U(e.Constitution,0)))}(e)
wt(a+t,hn),function(e){wt(zn.armor+Math.floor(zn.armor*U(e.Sanctuary,0)*.001),pn)}(e)
const n=function(e,t){return Math.ceil(t*U(e.Fortitude,0)*.001)}(e,a)
!function(e){wt(zn.hp+e,yn)}(n),function(e,t){const a=Math.ceil((zn.hp+t)*U(e["Chi Strike"],0)*.001),n=Math.ceil(zn.damage*Kn.terrorizeLevel*.001)
wt(zn.damage+a-n,gn)}(e,n)}function Zn(){o("Processing attacking group stats ... ",wn),Un&&(zn.attack-=Un.attack,zn.defense-=Un.defense,zn.armor-=Un.armor,zn.damage-=Un.damage,zn.hp-=Un.hp),wt(zn.attack,cn),wt(zn.defense,dn),wt(zn.armor,mn),wt(zn.damage,bn),wt(zn.hp,vn)
const e=Je(GameData.player().buffs)
Xn(e),function(e){const t=Math.ceil(Fn*U(e.Flinch,0)*.001)
wt(Fn-t,Qa)}(e),function(e){const t=Math.ceil(_n*U(e.Terrorize,0)*.001)
wt(_n-t,an)}(e),o("Done.",wn)}function er(){o("Processing defending guild stats ... ",wn),Pn+=Qn(Kn.attackValue),Rn+=Qn(Kn.defenseValue),On+=Qn(Kn.armorValue),In+=Qn(Kn.damageValue),jn+=Qn(Kn.hpValue),Jn()
const e=Math.ceil(Pn*(.0025*Kn.nightmareVisageLevel))
!function(e){Fn=Pn-e,wt(Fn,Qa)}(e)
const t=Math.ceil(Rn*(1+.001*Kn.constitutionLevel))
!function(e,t){const a=t+e
wt(a,Xa),wt(Math.ceil(.55*a),un),wt(Math.ceil(.65*a),ln)}(e,t),wt(On+Math.floor(On*Kn.sanctuaryLevel*.001),en)
const a=jn+function(e){return Math.ceil(e*Kn.fortitudeLevel*.001)}(t)
wt(a,rn),function(e){_n=In+Math.ceil(e*Kn.chiStrikeLevel*.001),wt(_n)}(a),0!==Kn.cloakLevel&&o("Yes",Ua),GameData.player().hasGroup&&zn?Zn():o("Done.",wn)}function tr(e){const t=En(e)
Pn+=Math.round(t.attackValue*W),Rn+=Math.round(t.defenseValue*W),On+=Math.round(t.armorValue*W),In+=Math.round(t.damageValue*W),jn+=Math.round(t.hpValue*W),0!==t.cloakLevel&&(qn+=1),Jn()}function ar(e){Kn=En(e)}function nr(e){zn=e}function rr(e){Un=e}function or(e){o(e.message,wn)}function ir(e){const t=K(e),a=Z('#pCC a[href*="confirmDisband"]',t)
if(!a)return
const n=function(e){const t=e.previousElementSibling.href,a=[Ue(t).then(nr)]
return function(e){return-1!==e.parentNode.parentNode.previousElementSibling.previousElementSibling.innerHTML.indexOf('"#000099"')}(e)&&a.push(We().then(rr)),a}(a)
return Ie(n)}function sr(e,t){return 0===t?ee(e).then(ar):ee(e).then(tr).catch(or)}function ur(){let e=[X({cmd:"guild",subcmd:"view",guild_id:Wn.controlled_by.guild_id}).then(Bn)]
return GameData.player().hasGroup&&e.push(X({cmd:"guild",subcmd:"groups"}).then(ir)),e=e.concat(_a.map(sr)),e}function lr(){$n(Wn),Pn=0,Rn=0,On=0,In=0,jn=0,qn=0,Yn=0
const e=ur()
_e(e,er)}function cr(e,t){Fa(t)||(Wn=t.response.data,Wn.defenders.length>0&&(Cn(Wn),J(Ia,"click",lr)))}function fr(){$.subscribe(Q,cr)}const dr=[]
function hr(e){return Fa(e)||dr.push(e),e}function mr(e,t){return e===Number(t.response.data.id)}function pr(e,t){e(t)}function br(e,t){const a=dr.find(l(mr,e))
return a?function(e){return new Promise(t=>{te(3,pr,[t,e])})}(a):je({a:1,id:e,passback:t}).then(hr)}let gr,vr,yr,wr,kr,Cr
function Lr(e,t){return ae(ne(t,e))}function Dr(){var e
gr=GameData.player().level,e=n("statbar-character-tooltip-stats"),yr=Lr(e,ue),vr=Lr(e,re),kr=Lr(e,oe),wr=Lr(e,ie),Cr=Lr(e,se)}function Mr(e){return`<tr><td colspan="2">${e.name}:</td><td colspan="2">${e.value}</td></tr>`}function Vr(e,t,a){return function(e){return"<table><tr><td>"+`<img src="${le}creatures/${e.image_id}.png" `+'height="200" width="200"></td><td rowspan="2"><table width="400"><tr><td class="header" colspan="4" class="fshCenter">Statistics</td></tr>'}(e)+function(e,t){return`<tr><td>Class:&nbsp;</td><td width="40%">${e.creature_class}</td><td>Level:&nbsp;</td><td width="40%">${e.level} (your level:<span class="${t}">${gr}</span>)</td></tr>`}(e,a)+function(e){return`<tr><td>Attack:&nbsp;</td><td width="40%">${e.attack} (your defense:<span class="fshYellow">${vr}</span>)</td><td>Defense:&nbsp;</td><td width="40%">${e.defense} (your attack:<span class="fshYellow">${yr}</span>)</td></tr>`}(e)+function(e){return`<tr><td>Armor:&nbsp;</td><td width="40%">${e.armor} (your damage:<span class="fshYellow">${wr}</span>)</td><td>Damage:&nbsp;</td><td width="40%">${e.damage} (your armor:<span class="fshYellow">${kr}</span>)</td></tr>`}(e)+function(e,t){return`<tr><td>HP:&nbsp;</td><td width="40%">${e.hp} (your HP:<span class="fshYellow">${Cr}</span>)(1H: <span class="fshRed">${t}</span>)</td><td>Gold:&nbsp;</td><td width="40%">${e.gold}</td></tr>`}(e,t)+'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Enhancements</td></tr>'+function(e){return 0===e.enhancements.length?'<tr><td colspan="4">[no enhancements]</td></tr>':e.enhancements.map(Mr).join("")}(e)+function(e){return'<tr><td colspan="4" height="5"></td></tr><tr><td class="header" colspan="4" class="fshCenter">Description</td>'+`</tr><tr><td colspan="4">${e.description}</td></tr>`+'<tr><td colspan="4" height="5"></td></tr></table></td></tr>'+`<tr><td class="fshCenter"><b>${e.name}</b></td></tr>`+"</table>"}(e)}function Ar(t){if(!Fa(t))return function(t){const a=Math.ceil(t.hp*e.hpVariable+t.armor*e.generalVariable)
let n="fshYellow"
return Dr(),gr>t.level&&(n="fshRed"),Vr(t,a,n)}(t.response.data)}const $r=["verb","view","tip-static"]
function Sr(e,t){const a=Ar(t)
e.set("content.text",a)}function Br(e,t,a){return br(GameData.actions()[e].data.id,e).then(l(Sr,a)),"Loading..."}function Hr(e,t){fe("NewMap","CreatureInfo")
const a=de((n=t).parentNode.children).indexOf(n)
var n,r,o
e.classList.add("fshTip"),r=e,o=l(Br,a),$(r).qtip({overwrite:!0,show:{event:"mouseover",ready:!0},style:{classes:"qtip-tipsy qtip-custom"},position:{my:"center right",at:"center left",effect:!1,viewport:$(window)},content:{text:o},hide:{effect:!1}})}function Nr(t){if(!e.showCreatureInfo)return
const{target:a}=t,n=a.parentNode.parentNode.parentNode;(function(e,t){return Ye($r,e)&&!ce("fshTip",e)&&ce("creature",t)})(a,n)&&Hr(a,n)}function Gr(){T(n("actionList"),"mouseover",Nr)}function xr(){return he({subcmd:"scouttower"})}function Tr(e,t){const a=e.insertCell(-1)
return[a.colSpan]=t,t[2]&&(a.className="header"),s(a,t[1]),a}function Er(e,t,a){const n=e.insertRow(-1)
return a&&(n.className="fshBlue"),function(e,t){t.forEach(l(Tr,e))}(n,t),n}function Pr(e,t){Er(e,t[0],t[1])}function Fr(e,t){t.forEach(l(Pr,e))}let Rr,Or,Ir,_r,jr,qr,Yr,Kr,zr,Ur,Wr,Qr,Jr,Xr,Zr,eo,to,ao,no,ro,oo,io,so,uo,lo,co,fo,ho
function mo(){Or=xt("Current"),Ir=xt("Kills"),_r=xt("Member"),jr=xt("% of Total"),qr=xt("Status"),Yr=xt("Titan HP"),Kr=xt("Total"),zr=xt("Your Guild")}function po(){for(;to.rows.length>7;)to.deleteRow(7)}function bo(){const e=i()
return s(e,Ur),xe(e,"/"),s(e,Wr),e}function go(e){const t=i()
return s(t,e),xe(t,"%"),t}function vo(){no=null,ao&&!ao.classList.contains("fshHide")&&(t(ao,!0),o("",Ur),o("",Wr),o("",Qr),o("",Jr),o("",Xr),I("",Zr),I("",eo),po())}function yo(e){return 0===e.type&&(no=e.base_creature_id,!0)}function wo(){if(ao)t(ao,!1)
else{const e=n("actionContainer")
ao=a({className:"fshActionBox titanInfo"}),Ur=i(),Wr=i(),Qr=i(),Jr=i(),Xr=i(),Zr=i(),eo=i(),to=Fe({className:"fshCenter"}),mo(),Fr(to,[[[[2,Yr,!0],[4,zr,!0]]],[[[2,bo()],[4,Qr]]],[[[2,Or,!0],[4,go(Jr)]],!0],[[[2,Kr,!0],[4,go(Xr)]],!0],[[[2,qr,!0],[4,Zr]],!0],[[[6,eo]]],[[[2,_r,!0],[2,Ir,!0],[2,jr,!0]]]]),s(ao,to),s(e,ao)}}function ko(e){return e<=0?'<span class="fshGreen cooldown">No active cooldown</span>':`<span class="fshMaroon cooldown">Cooldown until: ${function(e){const t=new Date(be+1e3*e)
return`${me(t.getHours())}:${me(t.getMinutes())} ${me(t.getDate())}/${pe[t.getMonth()]}/${t.getFullYear()}`}(e)}</span>`}function Co(e){o(e.current_hp,Ur),o(e.max_hp,Wr),o(e.kills,Qr),o(function(e){return Ne(Xe(e.max_hp-e.current_hp,e.kills),2)}(e),Jr),o(function(e){return Ne(100*e.kills/e.max_hp,2)}(e),Xr),I(function(e){return Ze(e.kills,e.max_hp,e.current_hp)}(e),Zr),I(ko(e.cooldown),eo)}function Lo(e,t){return[[[2,xt(t.player.name)],[2,xt(t.kills.toString())],[2,xt(`${Ne(100*t.kills/e.kills,2)}%`)]]]}function Do(e){return e.realm&&e.creature.base_id===no&&e.realm===Rr}function Mo(e){const t=e.find(Do)
t&&(Co(t),function(e){if(po(),!e.contributors)return
const t=e.contributors.map(l(Lo,e))
Fr(to,t)}(t))}function Vo(t){return e.showTitanInfo&&m(t)&&t.some(yo)}function Ao(e,t){(function(e){return e.s&&m(e.r)})(t)&&(Mo(t.r),Vo(GameData.realm().dynamic)?ro=window.setTimeout(e,3e4):vo())}function $o(){xr().then(l(Ao,$o))}function So(e){ro&&(window.clearTimeout(ro),ro=null),Vo(e)?(wo(),$o()):vo()}function Bo(e){var t
e.dynamic&&(t=e.name,Rr=t,So(e.dynamic))}function Ho(e,t){(function(e){return e.realm&&e.realm.name})(t)&&Bo(t.realm)}function No(){window.initialGameData&&Ho(0,window.initialGameData),$.subscribe(`${ge} ${ve}`,Ho)}function Go(e){const t=e.response.response,a=e.response.msg
let n
if(0!==t){const e=a.indexOf("<")
n=-1!==e?a.substring(0,e):a}else n=`You purchased ${e.response.data.name} for ${u(e.response.data.cost)} gold.`
c(fo,`${n}<br>`)}function xo(){GameData.doAction(14,3,{id:oo.id,item_id:oo.itemId},0),so.close()}function To(){const e=Te(lo.value)
if(!e)return
const t=[]
for(let a=1;a<e;a+=1)t.push(je({a:14,d:0,id:oo.id,item_id:oo.itemId}).then(Go))
_e(t,xo)}function Eo(){uo?o("",fo):(uo=a({className:"fshClear",textContent:"Select how many to quick-buy:"}),lo=Ge({id:"buyAmount",className:"fshNumberInput",min:1,max:99,value:1,type:"number"}),s(uo,lo),co=Re({textContent:"Quick-buy"}),f(co,To),s(uo,co),fo=a(),s(uo,fo),s(io,uo))}function Po(e,t){oo=t,io=io||n("shopDialogConfirm"),io&&(so=so||$(io).data("hcsWorldDialogShopConfirm"),so&&Eo())}function Fo(){$.subscribe(ye,Po)}function Ro(e){ho[e.name]?ho[e.name].seen&&(ho[e.name].seen+=1):(ho[e.name]={seen:1},function(e,t){t.creature_class=e.creature_class,t.image_id=e.image_id,t.level=Number(e.level),t.type=e.type}(e,ho[e.name]))}function Oo(e,t,a){return t?e(t,a):a}function Io(e,t){const a=e||{}
return a.min=Oo(Math.min,a.min,t),a.max=Oo(Math.max,a.max,t),a}const _o=["attack","armor","damage","defense","hp"]
function jo(e,t,a){const n=Io(t[a],Number(e[a]));(function(e,t){return!e||e.min!==t.min||e.max!==t.max})(t[a],n)&&(t[a]=n)}function qo(e,t){e[t.name]=Io(e[t.name],Number(t.value))}function Yo(e){ho||(ho={}),Ro(e),function(e,t){_o.forEach(l(jo,e,t))}(e,ho[e.name]),function(e,t){(function(e){return e.enhancements&&e.enhancements.length>0})(e)&&(t.enhancements=t.enhancements||{},e.enhancements.forEach(l(qo,t.enhancements)))}(e,ho[e.name]),C("fsh_monsterLog",ho)}function Ko(e){ho=e||{}}const zo=[]
function Uo(t){var a
Fa(t)||(fe("NewMap","MonsterLog"),a=t.response.data,e.showMonsterLog&&Yo(a))}function Wo(e,t){return e.id===t.id}function Qo(e,t){6!==e.type||function(e){if(zo.find(l(Wo,e.data)))return!0
zo.push(e.data)}(e)||br(e.data.id,t).then(Uo)}function Jo(){e.showMonsterLog&&GameData.actions().forEach(Qo)}function Xo(){w("fsh_monsterLog").then(Ko),$.subscribe("-1-success.action-response 4-success.action-response 5-success.action-response 25-success.action-response",Jo),Jo()}function Zo(e){return he(we({subcmd:"groups"},e))}function ei(e){return function(e){return Zo({subcmd2:"viewstats",group_id:e})}(e)}function ti(){return Zo({subcmd2:"view"})}function ai(e){return e.numberOfCreatureHitsTillDead-e.numberOfHitsRequired<=1?", dies on miss":", survives a miss"}const ni=[[e=>"-"===e.playerHits&&"-"===e.creatureHits,()=>"Unresolved"],[e=>"-"===e.playerHits,()=>"Player dies"],[e=>1===e.playerHits,e=>`Player 1 hits${ai(e)}`],[e=>e.playerHits>1,e=>`Player > 1 hits${ai(e)}`]]
function ri(e,t){return t[0](e)}function oi(e){e.playerHits=function(e){return"-"===e.numberOfCreatureHitsTillDead?e.numberOfHitsRequired:function(e){return"-"===e.numberOfHitsRequired||e.numberOfHitsRequired>e.numberOfCreatureHitsTillDead}(e)?"-":e.numberOfHitsRequired}(e),e.creatureHits=function(e){return"-"===e.numberOfHitsRequired?e.numberOfCreatureHitsTillDead:function(e){return"-"===e.numberOfCreatureHitsTillDead||e.numberOfCreatureHitsTillDead>e.numberOfHitsRequired}(e)?"-":e.numberOfCreatureHitsTillDead}(e),e.fightStatus=function(e){const t=ni.find(l(ri,e))
return t?t[1](e):"Unknown"}(e)}function ii(e){e.creatureHitByHowMuch>=0?function(e){const t=e.generalVariable*e.creature.damage
t<e.overallArmorValue?e.numberOfCreatureHitsTillDead=e.overallHPValue:e.numberOfCreatureHitsTillDead=Math.ceil(e.overallHPValue/(t-e.overallArmorValue))}(e):e.numberOfCreatureHitsTillDead="-"}function si(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupArmorValue:e.player.armorValue}(e)
e.overallArmorValue=t+Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}(e),function(e){e.player.sanctuaryLevel>0&&(e.extraNotes+=`Sanc Bonus Armor = ${Math.floor(e.player.armorValue*e.player.sanctuaryLevel*.001)}<br>`)}(e),function(e){e.terrorizeEffect=Math.floor(e.creature.damage*e.player.terrorizeLevel*.001)}(e),function(e){e.player.terrorizeLevel>0&&(e.extraNotes+=`Terrorize Creature Damage Effect = ${-1*e.terrorizeEffect}<br>`)}(e),e.creature.damage-=e.terrorizeEffect,function(e){e.creatureDamageDone=Math.ceil(e.generalVariable*e.creature.damage-e.overallArmorValue+e.overallHPValue)}(e),ii(e)}function ui(e){const t=function(e){return e.callback.groupExists?e.callback.groupAttackValue:e.player.attackValue}(e)
e.player.darkCurseLevel>0&&(e.extraNotes+=`DC Bonus Attack = ${Math.floor(e.creature.defense*e.player.darkCurseLevel*.002)}<br>`),e.nightmareVisageAttackMovedToDefense=Math.floor((t+e.counterAttackBonusAttack)*e.player.nightmareVisageLevel*.0025),e.player.nightmareVisageLevel>0&&(e.extraNotes+=`NMV Attack moved to Defense = ${e.nightmareVisageAttackMovedToDefense}<br>`),e.overallAttackValue=t+e.counterAttackBonusAttack-e.nightmareVisageAttackMovedToDefense,e.hitByHowMuch=function(e){const t=e.creature.defense-e.creature.defense*e.player.darkCurseLevel*.002
return 3===e.combatEvaluatorBias?e.overallAttackValue-Math.ceil(t)-50:e.overallAttackValue-Math.ceil(e.attackVariable*t)}(e)}function li(e){e.lowestCALevelToStillHit=Math.max(Math.ceil((e.counterAttackBonusAttack-e.hitByHowMuch+1)/e.player.attackValue/.0025),0),e.lowestCALevelToStillKill=Math.max(Math.ceil((e.counterAttackBonusDamage-e.damageDone+1)/e.player.damageValue/.0025),0)}function ci(e){li(e),e.lowestFeasibleCALevel=Math.max(e.lowestCALevelToStillHit,e.lowestCALevelToStillKill),e.extraNotes+=`Lowest CA to still 1-hit this creature = ${e.lowestFeasibleCALevel}<br>`,0!==e.lowestFeasibleCALevel&&function(e){e.extraAttackAtLowestFeasibleCALevel=Math.floor(.0025*e.player.attackValue*e.lowestFeasibleCALevel),e.extraDamageAtLowestFeasibleCALevel=Math.floor(.0025*e.player.damageValue*e.lowestFeasibleCALevel),e.extraNotes+=`Extra CA Att/Dam at this lowered CA level = ${e.extraAttackAtLowestFeasibleCALevel} / ${e.extraDamageAtLowestFeasibleCALevel}<br>`}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel=function(e){return e.player.counterAttackLevel>0?Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.lowestFeasibleCALevel):0}(e),e.extraStaminaPerHitAtLowestFeasibleCALevel<e.extraStaminaPerHit?e.extraNotes+=`Extra Stam Used at this lowered CA level = ${e.extraStaminaPerHitAtLowestFeasibleCALevel}<br>`:e.extraNotes+="No reduction of stam used at the lower CA level<br>"}function fi(e){(function(e){return e.player.counterAttackLevel>0&&1===e.numberOfHitsRequired})(e)&&ci(e),function(e){return"-"===e.numberOfHitsRequired||1!==e.numberOfHitsRequired}(e)&&function(e){li(e),function(e){e.lowestCALevelToStillHit>175?e.extraNotes+="Even with CA175 you cannot hit this creature<br>":0!==e.lowestCALevelToStillHit&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillHit} to hit this creature<br>`)}(e),function(e){e.lowestCALevelToStillKill>175?e.extraNotes+="Even with CA175 you cannot 1-hit kill this creature<br>":0!==e.lowestCALevelToStillKill&&(e.extraNotes+=`You need a minimum of CA${e.lowestCALevelToStillKill} to 1-hit kill this creature<br>`)}(e)}(e)}function di(e){!function(e){const t=function(e){return e.callback.groupExists?e.callback.groupHPValue:e.player.hpValue}(e),{fortitudeLevel:a}=e.player
e.fortitudeExtraHPs=Math.floor(t*a*.001),a>0&&(e.extraNotes+=`Fortitude Bonus HP = ${e.fortitudeExtraHPs}<br>`),e.overallHPValue=t+e.fortitudeExtraHPs}(e),function(e){const{chiStrikeLevel:t}=e.player
e.chiStrikeExtraDamage=Math.floor(e.overallHPValue*t*.001),t>0&&(e.extraNotes+=`Chi Strike Bonus Damage = ${e.chiStrikeExtraDamage}<br>`)}(e)
const t=function(e){return e.callback.groupExists?e.callback.groupDamageValue:e.player.damageValue}(e)
if(e.overallDamageValue=t+e.deathDealerBonusDamage+e.counterAttackBonusDamage+e.holyFlameBonusDamage+e.chiStrikeExtraDamage,e.damageDone=Math.floor(e.overallDamageValue-(e.generalVariable*e.creature.armor+e.hpVariable*e.creature.hp)),e.hitByHowMuch>0){let t=1
e.overallDamageValue>=e.generalVariable*e.creature.armor&&(t=e.overallDamageValue-e.generalVariable*e.creature.armor),e.numberOfHitsRequired=Math.ceil(e.hpVariable*e.creature.hp/t)}else e.numberOfHitsRequired="-"}function hi(e){return e.callback.groupExists?e.callback.groupDefenseValue:e.player.defenseValue}function mi(e){e.overallDefenseValue=hi(e)+Math.floor(hi(e)*e.player.constitutionLevel*.001)+e.nightmareVisageAttackMovedToDefense,function(e){e.player.constitutionLevel>0&&(e.extraNotes+=`Constitution Bonus Defense = ${Math.floor(hi(e)*e.player.constitutionLevel*.001)}<br>`)}(e),function(e){e.player.flinchLevel>0&&(e.extraNotes+=`Flinch Bonus Attack Reduction = ${Math.floor(e.creature.attack*e.player.flinchLevel*.001)}<br>`)}(e),e.creatureHitByHowMuch=Math.floor(e.attackVariable*e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue),3===e.combatEvaluatorBias&&(e.creatureHitByHowMuch=Math.floor(e.creature.attack-e.creature.attack*e.player.flinchLevel*.001-e.overallDefenseValue-50))}function pi(e){e.extraNotes="",function(e){e.player.superEliteSlayerLevel>0&&(e.extraNotes+=`SES Stat Reduction Multiplier = ${e.player.superEliteSlayerMultiplier}<br>`)}(e),function(e){e.holyFlameBonusDamage=0,"Undead"===e.creature.class&&(e.holyFlameBonusDamage=Math.max(Math.floor((e.player.damageValue-e.creature.armor)*e.player.holyFlameLevel*.002),0),e.player.holyFlameLevel>0&&(e.extraNotes+=`HF Bonus Damage = ${e.holyFlameBonusDamage}<br>`))}(e),function(e){e.deathDealerBonusDamage=Math.floor(e.player.damageValue*(Math.min(.01*Math.floor(e.player.killStreakValue/5)*e.player.deathDealerLevel,20)/100))}(e),function(e){e.counterAttackBonusAttack=Math.floor(.0025*e.player.attackValue*e.player.counterAttackLevel),e.counterAttackBonusDamage=Math.floor(.0025*e.player.damageValue*e.player.counterAttackLevel)}(e),function(e){e.extraStaminaPerHit=0,e.player.counterAttackLevel>0&&(e.extraStaminaPerHit=Math.ceil(.0025*(1+e.player.doublerLevel/50)*e.player.counterAttackLevel))}(e),function(e){e.player.deathDealerLevel>0&&(e.extraNotes+=`DD Bonus Damage = ${e.deathDealerBonusDamage}<br>`)}(e),function(e){e.player.counterAttackLevel>0&&(e.extraNotes+=`CA Bonus Attack/Damage = ${e.counterAttackBonusAttack} / ${e.counterAttackBonusDamage}<br>`+`CA Extra Stam Used = ${e.extraStaminaPerHit}<br>`)}(e)}let bi,gi,vi,yi,wi,ki,Ci,Li,Di,Mi
function Vi(){return sa(gi)?"Remove from do not kill list":"Add to the do not kill list"}function Ai(){o(Vi(),vi)}function $i(){const t=e.doNotKillList.indexOf(gi);-1===t?e.doNotKillList.push(gi):e.doNotKillList.splice(t,1),Ai(),v("doNotKillList",e.doNotKillList.join()),la()}function Si(){vi?Ai():function(){vi=Re({className:"fshBl",textContent:Vi(),type:"button"})
const e=a({className:"description",innerHTML:'<span class="ui-helper-hidden-accessible"><input type="text"></span>'})
s(e,vi),s(bi,e),f(vi,$i)}()}function Bi(e,t){!function(e){if(!bi){const t=ne("body",e)
1===t.length&&([bi]=t)}}(t),bi&&(gi=e.trim(),Si())}function Hi(){ki||(wi||(wi=a(),s(yi,wi),s(yi,a({innerHTML:'<span class="fshFooter">*Does include CA, DD, HF, DC, Flinch, Super Elite Slayer, NMV, Sanctuary, Constitution, Fortitude, Chi Strike and Terrorize (if active) and allow for randomness (1.1053). Constitution, NMV, Fortitude and Chi Strike apply to group stats.</span>'}))),ki=a(),s(wi,ki))}function Ni(e){Hi(),I(e,ki)}function Gi(e){Ci||(Hi(),Ci=a(),s(wi,Ci)),I(e,Ci)}function xi(e,t){const a={name:e.name,class:e.creature_class,attack:Number(e.attack),defense:Number(e.defense),armor:Number(e.armor),damage:Number(e.damage),hp:Number(e.hp)}
return function(e,t,a){3===a&&(t.attack-=Math.ceil(t.attack*e),t.defense-=Math.ceil(t.defense*e),t.armor-=Math.ceil(t.armor*e),t.damage-=Math.ceil(t.damage*e),t.hp-=Math.ceil(t.hp*e))}(t,a,e.type),a}function Ti(t,a,n){const r={}
r.callback=n,r.player=En(a),function(t){t.combatEvaluatorBias=e.combatEvaluatorBias,t.attackVariable=1.1053,t.generalVariable=e.generalVariable,t.hpVariable=e.hpVariable}(r),r.creature=xi(t.response.data,r.player.superEliteSlayerMultiplier),function(e){pi(e),ui(e),di(e),mi(e),si(e),oi(e),fi(e)}(r),r.evaluatorHTML=function(e){return`<table width="100%"><tbody>${function(e){return`<tr><td bgcolor="#CD9E4B" colspan="4" align="center">${function(e){return e.callback.groupExists?"Group ":""}(e)}Combat Evaluation</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`Will I hit it? </td><td align="left">${function(e){return e.hitByHowMuch>0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">`+`Extra Attack: </td><td align="left">( ${e.hitByHowMuch} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`# Hits to kill it? </td><td align="left">${e.numberOfHitsRequired}</td><td align="right">`+`<span style="color:#333333">Extra Damage: </td><td align="left">( ${e.damageDone} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`Will I be hit? </td><td align="left">${function(e){return e.creatureHitByHowMuch>=0?"Yes":"No"}(e)}</td><td align="right"><span style="color:#333333">`+`Extra Defense: </td><td align="left">( ${-1*e.creatureHitByHowMuch} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`# Hits to kill me? </td><td align="left">${e.numberOfCreatureHitsTillDead}</td><td align="right">`+`<span style="color:#333333">Extra Armor + HP: </td><td align="left">( ${-1*e.creatureDamageDone} )</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`# Player Hits? </td><td align="left">${e.playerHits}</td><td align="right"><span style="color:#333333">`+`# Creature Hits? </td><td align="left">${e.creatureHits}</td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">'+`Fight Status: </span></td><td align="left" colspan="3"><span>${e.fightStatus}</span></td></tr>`}(e)}${function(e){return'<tr><td align="right"><span style="color:#333333">Notes: </span></td><td align="left" colspan="3">'+`<span style="font-size:x-small;">${e.extraNotes}</span></td></tr>`}(e)}</tbody></table>`}(r),n.groupExists?Gi(r.evaluatorHTML):Ni(r.evaluatorHTML)}function Ei(e){return e.members[0].name===d()}function Pi(e){if(m(e.r))return e.r.find(Ei).id}function Fi(e,t,a){if(!a.r||!a.r.attributes)return
const n=a.r.attributes
Ti(e,t,{groupExists:!0,groupAttackValue:n[0].value,groupDefenseValue:n[1].value,groupArmorValue:n[2].value,groupDamageValue:n[3].value,groupHPValue:n[4].value})}function Ri(e,t,a){a&&ei(a).then(l(Fi,e,t))}function Oi(e,t){e.player.hasGroup&&function(e,t){ti().then(Pi).then(l(Ri,e,t))}(e,t),Ti(e,t,{groupExists:!1})}function Ii(e,t){yi||(yi=n("dialog-viewcreature")),yi&&(Ni(""),Gi(""),function(e){return e.response&&e.response.data}(t)&&(Bi(t.response.data.name,yi),Ce(!0).then(l(Oi,t))))}function _i(){$.subscribe(ke,Ii)}function ji(){const t=[,[e.buffs,e.buffsName],[e.buffs2,e.buffs2Name],[e.buffs3,e.buffs3Name]][e.enabledHuntingMode]
m(t)&&([Li,Di]=t)}function qi(t){"enabledHuntingMode"===t.target.name&&(e.enabledHuntingMode=t.target.value,v("enabledHuntingMode",e.enabledHuntingMode),ji(),GameData.fetch(h))}function Yi(e){const t=ne("verbs",e)
1===t.length&&_(t[0])}function Ki(){if(!Mi)return
const e=n("actionList")
L("player",e).forEach(Yi)}const zi={hideSubLvlCreature:function(){e.hideSubLvlCreature=!e.hideSubLvlCreature,v("hideSubLvlCreature",e.hideSubLvlCreature),GameData.fetch(H)},hidePlayerActions:function(){Mi=!Mi,v("hidePlayerActions",Mi),GameData.fetch(H)},showCreatureInfo:function(){e.showCreatureInfo=!e.showCreatureInfo,v("showCreatureInfo",e.showCreatureInfo)},showHuntingBuffs:function(){e.showBuffs=!e.showBuffs,v("showHuntingBuffs",e.showBuffs),GameData.fetch(h)},showMonsterLog:function(){e.showMonsterLog=!e.showMonsterLog,v("showMonsterLog",e.showMonsterLog)},showTitanInfo:function(){e.showTitanInfo=!e.showTitanInfo,v("showTitanInfo",e.showTitanInfo),So(GameData.realm().dynamic)},showBuffInfo:function(){e.showBuffInfo=!e.showBuffInfo,v("showBuffInfo",e.showBuffInfo),Wt()}}
function Ui(e){const t=zi[e.target.name]
M(t)&&(e.target.blur(),t(e))}function Wi(){const e=a({className:"fshCenter fshFten"}),t=a({id:"fshWorldPrefs",innerHTML:`${Pe("showCreatureInfo")}&nbsp;&nbsp;${Pe("showMonsterLog")}&nbsp;&nbsp;${Pe("showTitanInfo")}&nbsp;&nbsp;${Pe("showBuffInfo")}<br>${Pe("hideSubLvlCreature")}&nbsp;&nbsp;${Pe("hidePlayerActions")}&nbsp;&nbsp;${at()}`})
f(t,Ui),T(t,"change",qi),s(e,t)
const r=a()
s(e,r)
const o=n("worldContainerBelow").children[0]
return x(e,o),r}function Qi(e,t){return e[t.name]=!0,e}function Ji(e,t,a){return e[a.trim()]||t.push(a),t}function Xi(e){I("",e)}function Zi(e,t){const a=t.b.reduce(Qi,{}),n=Li.reduce(l(Ji,a),[])
n.length>0?function(e,t){I(`You are missing some ${Di} hunting buffs<br>(${t.join(", ")})`,e)}(e,n):Xi(e)}function es(t,a,n){Li&&function(t,a,n){e.showBuffs?Zi(t,n):Xi(t)}(t,0,n)}const ts=[{generalVariable:1.1053,hpVariable:1.1},{generalVariable:1.1,hpVariable:1.053},{generalVariable:1.053,hpVariable:1},{generalVariable:1.1053,hpVariable:1}]
function as(){var t
e.combatEvaluatorBias=y("combatEvaluatorBias"),e.generalVariable=(t=e.combatEvaluatorBias,ts[t]?ts[t].generalVariable:1.1053),e.hpVariable=function(e){return ts[e]?ts[e].hpVariable:1.1}(e.combatEvaluatorBias)}function ns(e,t){return 6!==t.type||(0!==t.data.creature_type||t.data.level>=e)}function rs(e){const t=Le(e)
return function(e){return!e||!e.actions||0===e.actions.length}(t)?e:(t.actions=t.actions.filter(l(ns,function(e){return e.realm&&e.realm.minlevel||GameData.realm().minlevel}(t))),JSON.stringify(t))}function os(t,a){e.hideSubLvlCreature&&function(e){return e.data&&e.data.d&&Qe(e.data.d,H)}(a)&&(t.dataFilter=rs)}function is(t){e[t[0]]=De(t[1])}function ss(t){e[t]=De(t)}function us(){[["buffs","huntingBuffs"],["buffs2","huntingBuffs2"],["buffs3","huntingBuffs3"]].forEach(is),["doNotKillList"].forEach(ss)}function ls(t){e[t[0]]=y(t[1])}function cs(t){e[t]=y(t)}function fs(){[["buffsName","huntingBuffsName"],["buffs2Name","huntingBuffs2Name"],["buffs3Name","huntingBuffs3Name"],["showBuffs","showHuntingBuffs"]].forEach(ls),["enabledHuntingMode","hideSubLvlCreature","showTitanInfo","showBuffInfo","showMonsterLog","showCreatureInfo"].forEach(cs)}function ds(){as(),us(),fs()
const t=Wi()
$.ajaxPrefilter("JSON",os),e.hideSubLvlCreature&&GameData.fetch(H),function(t){ji()
const a=l(es,t)
$.subscribe(p,a),e.showBuffs&&window.initialGameData&&a(null,{b:window.initialGameData.player.buffs})}(t),Mi=y("hidePlayerActions"),$.subscribe(A,Ki),Ki()}function hs(e){$(`#actionList li.creature-${e.toString()} a.create-group`).hide()}const ms=["hideChampionsGroup","hideElitesGroup","hideSEGroup","hideTitanGroup","hideLegendaryGroup"]
function ps(e,t){var a
y(e)&&(a=t+1,$.subscribe(A,l(hs,a)),hs(t+1))}function bs(){ms.forEach(ps)}function gs(){y("enableCreatureColoring")&&s(document.body,Oe("#actionList .creature-1 {color: green;}\n#actionList .creature-2 {color: yellow;}\n#actionList .creature-3 {color: red;}"))}function vs(e,t){"ACT_REPAIR"===t&&GameData.fetch($e+h+B+H)}function ys(){$.subscribe(Ae,vs)}function ws(){$("#messageCenter").worldMessageCenter({offset:"0 60"})}function ks(){E("#mapTooltip")}function Cs(e){E(e.target)}function Ls(){f(n("buffList"),Cs)}function Ds(){Me([ds,Ve,_i,bs,gs,ha,Xo,ys,ia,No,Fo,fr,ws,ks,Pa,Jt,Ls,Gr]),$.subscribe(k,pa)}export default function(){Se()&&n("worldPage")&&window.GameData&&Ds()}
//# sourceMappingURL=injectWorld-245a72e7.js.map
